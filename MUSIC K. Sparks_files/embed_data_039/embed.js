!function(){var e,t={5004:function(e){!function(){var t="0123456789abcdef",n="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",r=[];r.length=256;for(var i=0;i<256;i++)r[i]=t[i>>4]+t[15&i];var s=[];s.length=128;for(i=0;i<n.length;++i)s[n.charCodeAt(i)]=i;var o=[];for(i=0;i<16;i++)o[t.charCodeAt(i)]=i;for(i=0;i<6;i++)o["ABCDEF".charCodeAt(i)]=10+i;var a={toHex:function(e){if(22!==e.length)return null;var t,n,i,o,a,c=2.3283064365386963e-10,l=4294967296,u=238328;return t=56800235584*s[e.charCodeAt(0)]+916132832*s[e.charCodeAt(1)]+14776336*s[e.charCodeAt(2)]+238328*s[e.charCodeAt(3)]+3844*s[e.charCodeAt(4)]+62*s[e.charCodeAt(5)]+s[e.charCodeAt(6)],t=(t-=(n=t*c|0)*l)*u+(a=3844*s[e.charCodeAt(7)]+62*s[e.charCodeAt(8)]+s[e.charCodeAt(9)]),t-=(a=t*c|0)*l,n=n*u+a,t=t*u+(a=3844*s[e.charCodeAt(10)]+62*s[e.charCodeAt(11)]+s[e.charCodeAt(12)]),t-=(a=t*c|0)*l,n=n*u+a,n-=(a=n*c|0)*l,i=a,t=t*u+(a=3844*s[e.charCodeAt(13)]+62*s[e.charCodeAt(14)]+s[e.charCodeAt(15)]),t-=(a=t*c|0)*l,n=n*u+a,n-=(a=n*c|0)*l,i=i*u+a,t=t*u+(a=3844*s[e.charCodeAt(16)]+62*s[e.charCodeAt(17)]+s[e.charCodeAt(18)]),t-=(a=t*c|0)*l,n=n*u+a,n-=(a=n*c|0)*l,i=i*u+a,i-=(a=i*c|0)*l,o=a,t=t*u+(a=3844*s[e.charCodeAt(19)]+62*s[e.charCodeAt(20)]+s[e.charCodeAt(21)]),t-=(a=t*c|0)*l,n=n*u+a,n-=(a=n*c|0)*l,i=i*u+a,i-=(a=i*c|0)*l,o=o*u+a,o-=(a=o*c|0)*l,a?null:r[o>>>24]+r[o>>>16&255]+r[o>>>8&255]+r[255&o]+r[i>>>24]+r[i>>>16&255]+r[i>>>8&255]+r[255&i]+r[n>>>24]+r[n>>>16&255]+r[n>>>8&255]+r[255&n]+r[t>>>24]+r[t>>>16&255]+r[t>>>8&255]+r[255&t]},fromHex:function(e){var t,r=0,i=0,s=0;for(t=0;t<10;t++)s=16*s+o[e.charCodeAt(t)];for(t=0;t<11;t++)i=16*i+o[e.charCodeAt(t+10)];for(t=0;t<11;t++)r=16*r+o[e.charCodeAt(t+21)];if(isNaN(r+i+s))return null;var a,c=17592186044416,l=1/62,u="";for(t=0;t<7;++t)a=((a=((a=s)-62*(s=Math.floor(a*l)))*c+i)-62*(i=Math.floor(a*l)))*c+r,r=Math.floor(a*l),u=n[a-62*r]+u;for(i+=s*c;t<15;++t)a=((a=i)-62*(i=Math.floor(a*l)))*c+r,r=Math.floor(a*l),u=n[a-62*r]+u;for(r+=i*c;t<21;++t)a=r,r=Math.floor(a*l),u=n[a-62*r]+u;return n[r]+u},HEX256:r,ID16:o,ID62:s};void 0!==e.exports?e.exports=a:window.Base62=a}()},1573:function(e,t,n){"use strict";var r=n(5004),i="spotify:",s="http://play.spotify.com/",o="https://play.spotify.com/",a="http://open.spotify.com/",c="https://open.spotify.com/",l=new TypeError("Invalid Spotify URI!"),u=(new TypeError("Not implemented!"),0),d=1,p=function(e,t){return e=encodeURIComponent(e),t===u&&(e=e.replace(/%20/g,"+")),e=(e=e.replace(/[!'()]/g,escape)).replace(/\*/g,"%2A")},h=function(e,t){var n=t==u?e.replace(/\+/g,"%20"):e;return decodeURIComponent(n)},_=function(e,t){var n,r,i,s;switch(e.id&&(n=e._base62Id),e.type){case y.Type.ALBUM:return r=[y.Type.ALBUM,n],e.disc&&r.push(e.disc),r;case y.Type.AD:return[y.Type.AD,e._base62Id];case y.Type.ARTIST:return[y.Type.ARTIST,n];case y.Type.ARTIST_TOPLIST:return[y.Type.ARTIST,n,y.Type.TOP,e.toplist];case y.Type.DAILY_MIX:return[y.Type.DAILY_MIX,n];case y.Type.SEARCH:return[y.Type.SEARCH,p(e.query,t)];case y.Type.TRACK:return(e.context||e.play)&&(n+=f({context:e.context,play:e.play})),e.anchor&&(n+="#"+e.anchor),[y.Type.TRACK,n];case y.Type.TRACKSET:var o=[];for(i=0,s=e.tracks.length;i<s;i++)o.push(e.tracks[i]._base62Id);return o=[o.join(",")],null!==e.index&&o.push("#",e.index),[y.Type.TRACKSET,p(e.name)].concat(o);case y.Type.FACEBOOK:return[y.Type.USER,y.Type.FACEBOOK,e.uid];case y.Type.AUDIO_FILE:return[y.Type.AUDIO_FILE,e.extension,e._base62Id];case y.Type.FOLDER:return[y.Type.USER,p(e.username,t),y.Type.FOLDER,e._base62Id];case y.Type.FOLLOWERS:return[y.Type.USER,p(e.username,t),y.Type.FOLLOWERS];case y.Type.FOLLOWING:return[y.Type.USER,p(e.username,t),y.Type.FOLLOWING];case y.Type.PLAYLIST:return[y.Type.USER,p(e.username,t),y.Type.PLAYLIST,n];case y.Type.PLAYLIST_V2:return[y.Type.PLAYLIST,n];case y.Type.STARRED:return[y.Type.USER,p(e.username,t),y.Type.STARRED];case y.Type.TEMP_PLAYLIST:return[y.Type.TEMP_PLAYLIST,e.origin,e.data];case y.Type.CONTEXT_GROUP:return[y.Type.CONTEXT_GROUP,e.origin,e.name];case y.Type.USER_TOPLIST:return[y.Type.USER,p(e.username,t),y.Type.TOP,e.toplist];case y.Type.USER_TOP_TRACKS:return[y.Type.USER,p(e.username,t),y.Type.TOPLIST];case y.Type.TOPLIST:return[y.Type.TOP,e.toplist].concat(e.global?[y.Type.GLOBAL]:["country",e.country]);case y.Type.INBOX:return[y.Type.USER,p(e.username,t),y.Type.INBOX];case y.Type.ROOTLIST:return[y.Type.USER,p(e.username,t),y.Type.ROOTLIST];case y.Type.PUBLISHED_ROOTLIST:return[y.Type.USER,p(e.username,t),y.Type.PUBLISHED_ROOTLIST];case y.Type.COLLECTION_TRACK_LIST:return[y.Type.USER,p(e.username,t),y.Type.COLLECTION_TRACK_LIST,n];case y.Type.PROFILE:return e.args&&e.args.length>0?[y.Type.USER,p(e.username,t)].concat(e.args):[y.Type.USER,p(e.username,t)];case y.Type.LOCAL_ARTIST:return[y.Type.LOCAL,p(e.artist,t)];case y.Type.LOCAL_ALBUM:return[y.Type.LOCAL,p(e.artist,t),p(e.album,t)];case y.Type.LOCAL:return[y.Type.LOCAL,p(e.artist,t),p(e.album,t),p(e.track,t),e.duration];case y.Type.LIBRARY:return[y.Type.USER,p(e.username,t),y.Type.LIBRARY].concat(e.category?[e.category]:[]);case y.Type.IMAGE:return[y.Type.IMAGE,e._base62Id];case y.Type.MOSAIC:return(r=e.ids.slice(0)).unshift(y.Type.MOSAIC),r;case y.Type.RADIO:return[y.Type.RADIO,e.args];case y.Type.SPECIAL:for(r=[y.Type.SPECIAL],i=0,s=(a=e.args||[]).length;i<s;++i)r.push(p(a[i],t));return r;case y.Type.STATION:for(r=[y.Type.STATION],i=0,s=(a=e.args||[]).length;i<s;i++)r.push(p(a[i],t));return r;case y.Type.APPLICATION:var a;for(r=[y.Type.APP,e._base62Id],i=0,s=(a=e.args||[]).length;i<s;++i)r.push(p(a[i],t));return r;case y.Type.COLLECTION_ALBUM:return[y.Type.USER,p(e.username,t),y.Type.COLLECTION,y.Type.ALBUM,n];case y.Type.COLLECTION_MISSING_ALBUM:return[y.Type.USER,p(e.username,t),y.Type.COLLECTION,y.Type.ALBUM,n,"missing"];case y.Type.COLLECTION_ARTIST:return[y.Type.USER,p(e.username,t),y.Type.COLLECTION,y.Type.ARTIST,n];case y.Type.COLLECTION:return[y.Type.USER,p(e.username,t),y.Type.COLLECTION].concat(e.category?[e.category]:[]);case y.Type.EPISODE:return(e.context||e.play)&&(n+=f({context:e.context,play:e.play})),[y.Type.EPISODE,n];case y.Type.SHOW:return[y.Type.SHOW,n];case y.Type.LIVE:return[y.Type.LIVE,n];case y.Type.CONCERT:return[y.Type.CONCERT,n];case y.Type.SOCIAL_SESSION:return[y.Type.SOCIAL_SESSION,n];case y.Type.INTERRUPTION:return[y.Type.INTERRUPTION,e.id];default:throw l}},f=function(e){var t="?";for(var n in e)e.hasOwnProperty(n)&&void 0!==e[n]&&(t.length>1&&(t+="&"),t+=n+"="+encodeURIComponent(e[n]));return t},g=function(e){return e.split("&").reduce((function(e,t){return e[(t=t.split("="))[0]]=decodeURIComponent(t[1]),e}),{})},m=function(e,t,n){var r=0;n=n||{};var i,s,o,a=function(){return e[r++]},c=function(){var e=a();if(!e||e.length>22)throw l;return e},d=function(){var e=a();if(!e||22!==e.length)throw l;return e},_=function(){return e.slice(r)},f=function(){var n=t==u?":":"/";return e.slice(r).join(n)},g=a();switch(g){case y.Type.ALBUM:return y.albumURI(d(),parseInt(a(),10));case y.Type.AD:return y.adURI(a());case y.Type.ARTIST:return i=d(),a()==y.Type.TOP?y.artistToplistURI(i,a()):y.artistURI(i);case y.Type.AUDIO_FILE:return y.audioFileURI(a(),a());case y.Type.DAILY_MIX:return y.dailyMixURI(c());case y.Type.TEMP_PLAYLIST:return y.temporaryPlaylistURI(a(),f());case y.Type.PLAYLIST:return y.playlistV2URI(d());case y.Type.SEARCH:return y.searchURI(h(f(),t));case y.Type.TRACK:return y.trackURI(d(),a(),n.context,n.play);case y.Type.TRACKSET:var m=h(a()),v=a(),E=a(),S=parseInt(a(),10);("%23"!==E||isNaN(S))&&(S=null);var b=[];if(v)for(s=0,o=(v=h(v).split(",")).length;s<o;s++){var T=v[s];b.push(y.trackURI(T))}return y.tracksetURI(b,m,S);case y.Type.CONTEXT_GROUP:return y.contextGroupURI(a(),a());case y.Type.TOP:var C=a();return a()==y.Type.GLOBAL?y.toplistURI(C,null,!0):y.toplistURI(C,a(),!1);case y.Type.USER:var I=h(a(),t),R=a();if(I===y.Type.FACEBOOK&&R)return y.facebookURI(parseInt(R,10));if(R)switch(R){case y.Type.PLAYLIST:return y.playlistURI(I,d());case y.Type.FOLDER:return y.folderURI(I,c());case y.Type.COLLECTION_TRACK_LIST:return y.collectionTrackList(I,c());case y.Type.COLLECTION:var P=a();switch(P){case y.Type.ALBUM:return i=c(),"missing"===a()?y.collectionMissingAlbumURI(I,i):y.collectionAlbumURI(I,i);case y.Type.ARTIST:return y.collectionArtistURI(I,c());default:return y.collectionURI(I,P)}case y.Type.STARRED:return y.starredURI(I);case y.Type.FOLLOWERS:return y.followersURI(I);case y.Type.FOLLOWING:return y.followingURI(I);case y.Type.TOP:return y.userToplistURI(I,a());case y.Type.INBOX:return y.inboxURI(I);case y.Type.ROOTLIST:return y.rootlistURI(I);case y.Type.PUBLISHED_ROOTLIST:return y.publishedRootlistURI(I);case y.Type.TOPLIST:return y.userTopTracksURI(I);case y.Type.LIBRARY:return y.libraryURI(I,a())}var A=_();if(R&&A.length>0)return y.profileURI(I,[R].concat(A));if(R)return y.profileURI(I,[R]);if(I)return y.profileURI(I);throw l;case y.Type.LOCAL:var O=a(),k=O&&h(O,t),L=a(),w=L&&h(L,t),D=a(),N=D&&h(D,t),U=a(),M=parseInt(U,10);return void 0!==D?y.localURI(k,w,N,M):void 0!==L?y.localAlbumURI(k,w):y.localArtistURI(k);case y.Type.IMAGE:return y.imageURI(c());case y.Type.MOSAIC:return y.mosaicURI(e.slice(r));case y.Type.RADIO:return y.radioURI(f());case y.Type.SPECIAL:for(s=0,o=(B=_()).length;s<o;++s)B[s]=h(B[s],t);return y.specialURI(B);case y.Type.STATION:return y.stationURI(_());case y.Type.EPISODE:return y.episodeURI(d(),n.context,n.play);case y.Type.SHOW:return y.showURI(d());case y.Type.LIVE:return y.liveURI(c());case y.Type.CONCERT:return y.concertURI(c());case"":break;case y.Type.SOCIAL_SESSION:return y.socialSessionURI(a());case y.Type.INTERRUPTION:return y.interruptionURI(a());default:i=g===y.Type.APP?a():g;var B,x=h(i,t);if(p(x,t)!==i)break;for(s=0,o=(B=_()).length;s<o;++s)B[s]=h(B[s],t);return y.applicationURI(x,B)}throw l};function y(e,t){for(var n in this.type=e,t)"function"!=typeof t[n]&&(this[n]=t[n])}Object.defineProperty(y.prototype,"id",{get:function(){return this._hexId||(this._hexId=this._base62Id?y.idToHex(this._base62Id):void 0),this._hexId},set:function(e){this._base62Id=e?y.hexToId(e):void 0,this._hexId=void 0},enumerable:!0,configurable:!0}),y.prototype.toAppType=function(){if(this.type==y.Type.APPLICATION)return y.applicationURI(this.id,this.args);var e=_(this,d),t=e.shift(),n=e.length;if(n)for(;n--;)e[n]=h(e[n],d);return this.type==y.Type.RADIO&&(e=e.shift().split(":")),y.applicationURI(t,e)},y.prototype.toRealType=function(){return this.type==y.Type.APPLICATION?m([this.id].concat(this.args),u):new y(null,this)},y.prototype.toURI=function(){return i+_(this,u).join(":")},y.prototype.toString=function(){return this.toURI()},y.prototype.toURLPath=function(e){var t=_(this,d);t[0]===y.Type.APP&&t.shift();var n=t[0]===y.Type.TRACKSET,r=t[0]===y.Type.LOCAL;if(!n&&!r){for(var i=[],s=0,o=t.length;s<o;s++){var a=t[s];a&&i.push(a)}t=i}var c=t.join("/");return e?"/"+c:c},y.prototype.toPlayURL=function(){return o+this.toURLPath()},y.prototype.toURL=function(){return this.toPlayURL()},y.prototype.toOpenURL=function(){return c+this.toURLPath()},y.prototype.toSecurePlayURL=function(){return this.toPlayURL()},y.prototype.toSecureURL=function(){return this.toPlayURL()},y.prototype.toSecureOpenURL=function(){return this.toOpenURL()},y.prototype.idToByteString=function(){var e=r.toHex(this._base62Id);if(!e){for(var t="",n=0;n<16;n++)t+=String.fromCharCode(0);return t}var i="";for(n=0;n<32;n+=2){var s=(r.ID16[e.charCodeAt(n)]<<4)+r.ID16[e.charCodeAt(n+1)];i+=String.fromCharCode(s)}return i},y.prototype.getPath=function(){return this.toString().replace(/[#?].*/,"")},y.prototype.getBase62Id=function(){return this._base62Id},y.prototype.isSameIdentity=function(e){var t=y.from(e);if(!t)return!1;if(this.toString()===e.toString())return!0;if(this.type!==y.Type.PLAYLIST&&this.type!==y.Type.PLAYLIST_V2||t.type!==y.Type.PLAYLIST&&t.type!==y.Type.PLAYLIST_V2){if(this.type===y.Type.STATION&&t.type===y.Type.STATION){var n=m(this.args,u);return!!n&&n.isSameIdentity(m(t.args,u))}return!1}return this.id===t.id},y.Type={EMPTY:"empty",ALBUM:"album",AD:"ad",APP:"app",APPLICATION:"application",ARTIST:"artist",ARTIST_TOPLIST:"artist-toplist",AUDIO_FILE:"audiofile",COLLECTION:"collection",COLLECTION_ALBUM:"collection-album",COLLECTION_MISSING_ALBUM:"collection-missing-album",COLLECTION_ARTIST:"collection-artist",CONTEXT_GROUP:"context-group",DAILY_MIX:"dailymix",EPISODE:"episode",FACEBOOK:"facebook",FOLDER:"folder",FOLLOWERS:"followers",FOLLOWING:"following",GLOBAL:"global",IMAGE:"image",INBOX:"inbox",INTERRUPTION:"interruption",LOCAL_ARTIST:"local-artist",LOCAL_ALBUM:"local-album",LOCAL:"local",LIBRARY:"library",LIVE:"live",MOSAIC:"mosaic",PLAYLIST:"playlist",PLAYLIST_V2:"playlist-v2",PROFILE:"profile",PUBLISHED_ROOTLIST:"published-rootlist",RADIO:"radio",ROOTLIST:"rootlist",COLLECTION_TRACK_LIST:"collectiontracklist",SEARCH:"search",SHOW:"show",SOCIAL_SESSION:"socialsession",CONCERT:"concert",SPECIAL:"special",STARRED:"starred",STATION:"station",TEMP_PLAYLIST:"temp-playlist",TOP:"top",TOPLIST:"toplist",TRACK:"track",TRACKSET:"trackset",USER:"user",USER_TOPLIST:"user-toplist",USER_TOP_TRACKS:"user-top-tracks",USET_TOP_TRACKS:"user-top-tracks"},y.fromString=function(e){var t=function(e){var t,n,r,p,h=e.split("?");if(h.length>1){e=h.shift();var _=(r=h.pop()).split("#");_.length>1&&(r=_.shift(),p=_.pop()),r=g(r)}var f=e.split("#");if(f.length>1&&(e=f.shift(),p=f.pop()),0===e.indexOf(i))t=e.slice(i.length).split(":"),n=u;else{if(0===(e=e.split("?")[0]).indexOf(s))t=e.slice(s.length).split("/");else if(0===e.indexOf(o))t=e.slice(o.length).split("/");else if(0===e.indexOf(a))t=e.slice(a.length).split("/");else if(0===e.indexOf(c))t=e.slice(c.length).split("/");else{if(0!==e.indexOf("/"))throw l;t=e.slice("/".length).split("/")}n=d}return p&&t.push(p),{format:n,components:t,query:r}}(e);return m(t.components,t.format,t.query)},y.from=function(e){try{return e instanceof y?e:"object"==typeof e&&e.type?new y(null,e):y.fromString(e.toString())}catch(t){return null}},y.fromByteString=function(e,t,n){for(;16!=t.length;)t=String.fromCharCode(0)+t;for(var i="",s=0;s<t.length;s++){var o=t.charCodeAt(s);i+=r.HEX256[o]}var a=r.fromHex(i),c=n||{};return c.id=a,new y(e,c)},y.clone=function(e){return e instanceof y?new y(null,e):null},y.getCanonical=function(e){return this.getCanonical(e)},y.getCanonicalUsername=function(e){return p(e,u)},y.getDisplayUsername=function(e){return h(e,u)},y.idToHex=function(e){return 22==e.length?r.toHex(e):e},y.hexToId=function(e){return 32==e.length?r.fromHex(e):e},y.emptyURI=function(){return new y(y.Type.EMPTY,{})},y.albumURI=function(e,t){return new y(y.Type.ALBUM,{id:e,disc:t})},y.adURI=function(e){return new y(y.Type.AD,{id:e})},y.audioFileURI=function(e,t){return new y(y.Type.AUDIO_FILE,{id:t,extension:e})},y.artistURI=function(e){return new y(y.Type.ARTIST,{id:e})},y.artistToplistURI=function(e,t){return new y(y.Type.ARTIST_TOPLIST,{id:e,toplist:t})},y.dailyMixURI=function(e){return new y(y.Type.DAILY_MIX,{id:e})},y.searchURI=function(e){return new y(y.Type.SEARCH,{query:e})},y.trackURI=function(e,t,n,r){return new y(y.Type.TRACK,{id:e,anchor:t,context:n?y.fromString(n):n,play:r})},y.tracksetURI=function(e,t,n){return new y(y.Type.TRACKSET,{tracks:e,name:t||"",index:isNaN(n)?null:n})},y.facebookURI=function(e){return new y(y.Type.FACEBOOK,{uid:e})},y.followersURI=function(e){return new y(y.Type.FOLLOWERS,{username:e})},y.followingURI=function(e){return new y(y.Type.FOLLOWING,{username:e})},y.playlistURI=function(e,t){return new y(y.Type.PLAYLIST,{username:e,id:t})},y.playlistV2URI=function(e){return new y(y.Type.PLAYLIST_V2,{id:e})},y.folderURI=function(e,t){return new y(y.Type.FOLDER,{username:e,id:t})},y.collectionTrackList=function(e,t){return new y(y.Type.COLLECTION_TRACK_LIST,{username:e,id:t})},y.starredURI=function(e){return new y(y.Type.STARRED,{username:e})},y.userToplistURI=function(e,t){return new y(y.Type.USER_TOPLIST,{username:e,toplist:t})},y.userTopTracksURI=function(e){return new y(y.Type.USER_TOP_TRACKS,{username:e})},y.toplistURI=function(e,t,n){return new y(y.Type.TOPLIST,{toplist:e,country:t,global:!!n})},y.inboxURI=function(e){return new y(y.Type.INBOX,{username:e})},y.rootlistURI=function(e){return new y(y.Type.ROOTLIST,{username:e})},y.publishedRootlistURI=function(e){return new y(y.Type.PUBLISHED_ROOTLIST,{username:e})},y.localArtistURI=function(e){return new y(y.Type.LOCAL_ARTIST,{artist:e})},y.localAlbumURI=function(e,t){return new y(y.Type.LOCAL_ALBUM,{artist:e,album:t})},y.localURI=function(e,t,n,r){return new y(y.Type.LOCAL,{artist:e,album:t,track:n,duration:r})},y.libraryURI=function(e,t){return new y(y.Type.LIBRARY,{username:e,category:t})},y.collectionURI=function(e,t){return new y(y.Type.COLLECTION,{username:e,category:t})},y.temporaryPlaylistURI=function(e,t){return new y(y.Type.TEMP_PLAYLIST,{origin:e,data:t})},y.contextGroupURI=function(e,t){return new y(y.Type.CONTEXT_GROUP,{origin:e,name:t})},y.profileURI=function(e,t){return new y(y.Type.PROFILE,{username:e,args:t})},y.imageURI=function(e){return new y(y.Type.IMAGE,{id:e})},y.mosaicURI=function(e){return new y(y.Type.MOSAIC,{ids:e})},y.radioURI=function(e){return e=void 0===e?"":e,new y(y.Type.RADIO,{args:e})},y.specialURI=function(e){return e=void 0===e?[]:e,new y(y.Type.SPECIAL,{args:e})},y.stationURI=function(e){return e=void 0===e?[]:e,new y(y.Type.STATION,{args:e})},y.applicationURI=function(e,t){return t=void 0===t?[]:t,new y(y.Type.APPLICATION,{id:e,args:t})},y.collectionAlbumURI=function(e,t){return new y(y.Type.COLLECTION_ALBUM,{username:e,id:t})},y.collectionMissingAlbumURI=function(e,t){return new y(y.Type.COLLECTION_MISSING_ALBUM,{username:e,id:t})},y.collectionArtistURI=function(e,t){return new y(y.Type.COLLECTION_ARTIST,{username:e,id:t})},y.episodeURI=function(e,t,n){return new y(y.Type.EPISODE,{id:e,context:t?y.fromString(t):t,play:n})},y.showURI=function(e){return new y(y.Type.SHOW,{id:e})},y.liveURI=function(e){return new y(y.Type.LIVE,{id:e})},y.concertURI=function(e){return new y(y.Type.CONCERT,{id:e})},y.socialSessionURI=function(e){return new y(y.Type.SOCIAL_SESSION,{id:e})},y.interruptionURI=function(e){return new y(y.Type.INTERRUPTION,{id:e})},y.isAlbum=function(e){return(y.from(e)||{}).type===y.Type.ALBUM},y.isAd=function(e){return(y.from(e)||{}).type===y.Type.AD},y.isApplication=function(e){return(y.from(e)||{}).type===y.Type.APPLICATION},y.isArtist=function(e){return(y.from(e)||{}).type===y.Type.ARTIST},y.isCollection=function(e){return(y.from(e)||{}).type===y.Type.COLLECTION},y.isCollectionAlbum=function(e){return(y.from(e)||{}).type===y.Type.COLLECTION_ALBUM},y.isCollectionArtist=function(e){return(y.from(e)||{}).type===y.Type.COLLECTION_ARTIST},y.isDailyMix=function(e){return(y.from(e)||{}).type===y.Type.DAILY_MIX},y.isEpisode=function(e){return(y.from(e)||{}).type===y.Type.EPISODE},y.isFacebook=function(e){return(y.from(e)||{}).type===y.Type.FACEBOOK},y.isFolder=function(e){return(y.from(e)||{}).type===y.Type.FOLDER},y.isLocalArtist=function(e){return(y.from(e)||{}).type===y.Type.LOCAL_ARTIST},y.isLocalAlbum=function(e){return(y.from(e)||{}).type===y.Type.LOCAL_ALBUM},y.isLocalTrack=function(e){return(y.from(e)||{}).type===y.Type.LOCAL},y.isMosaic=function(e){return(y.from(e)||{}).type===y.Type.MOSAIC},y.isPlaylistV1=function(e){return(y.from(e)||{}).type===y.Type.PLAYLIST},y.isPlaylistV2=function(e){return(y.from(e)||{}).type===y.Type.PLAYLIST_V2},y.isRadio=function(e){return(y.from(e)||{}).type===y.Type.RADIO},y.isRootlist=function(e){return(y.from(e)||{}).type===y.Type.ROOTLIST},y.isSearch=function(e){return(y.from(e)||{}).type===y.Type.SEARCH},y.isShow=function(e){return(y.from(e)||{}).type===y.Type.SHOW},y.isLive=function(e){return(y.from(e)||{}).type===y.Type.LIVE},y.isConcert=function(e){return(y.from(e)||{}).type===y.Type.CONCERT},y.isStation=function(e){return(y.from(e)||{}).type===y.Type.STATION},y.isTrack=function(e){return(y.from(e)||{}).type===y.Type.TRACK},y.isProfile=function(e){return(y.from(e)||{}).type===y.Type.PROFILE},y.isPlaylistV1OrV2=function(e){var t=y.from(e);return!!t&&(t.type===y.Type.PLAYLIST||t.type===y.Type.PLAYLIST_V2)},y.isSocialSession=function(e){return(y.from(e)||{}).type===y.Type.SOCIAL_SESSION},y.isInterruption=function(e){return(y.from(e)||{}).type===y.Type.INTERRUPTION},e.exports=y},8419:function(e,t,n){"use strict";n(2571),n(5901),n(8010),n(252),n(5374),n(5849),n(4009);var r=n(5526),i=n.n(r),s=n(7378),o=n.n(s),a=n(1542),c=n.n(a),l=n(9308),u=n(992),d=n(8896),p=(n(3214),n(9372)),h=n.n(p),_=n(5816),f=n.n(_),g=n(4647),m=n.n(g),y=n(4422),v=n.n(y),E=n(7066),S=n.n(E),b=n(8620),T=n.n(b),C=(n(3938),n(3615),n(4298)),I=999999,R="@media (max-width: ".concat(999998,"px)"),P="@media (min-width: ".concat(I,"px)"),A=.6,O="drop-shadow(0 0 2px rgba(0, 0, 0, 0.4))",k="spotify-circular, spotify-circular-cyrillic, spotify-circular-arabic, spotify-circular-hebrew, sans-serif",L="600",w=(n(7471),n(3902),n(1013),n(5613),n(2410),n(2077),n(2482),n(3526),"embed_v2"),D=function(e,t){return e.entities[t]},N=function(e){return"https://open.spotify.com/".concat(e.split(":").slice(1).join("/"))},U=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=[window.location.search||"?","utm_source=embed_v2","go=1","play=1",t].filter(Boolean).join("&");return"".concat(D(e,e.resource).external_urls.spotify).concat(n)},M=n(406);function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var F=function(e){return D(e,e.resource)},j=function(e){return F(e).type},Y=(0,M.P1)([function(e){return F(e)},function(e){return e}],(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};switch(e.type){case"album":var t=x({},e);return delete t.tracks,e.tracks.items.map((function(e){return x(x({},e),{},{album:t})}));case"artist":return e.tracks.map((function(e){return e}));case"playlist":var n=e.tracks.items.filter((function(e){return!!e.track}));return n.map((function(e,t){return x(x({},e.track),{},{track_number:t+1})}));case"track":case"episode":return[x({preview_url:e.audio_preview_url,is_playable:!!e.audio_preview_url},e)];case"show":return e.episodes.items.map((function(e){return x(x({},e),{},{preview_url:e.audio_preview_url,is_playable:!!e.audio_preview_url})}));default:return[]}})),K=function(e){var t=F(e)||{};switch(t.type){case"album":case"artist":case"playlist":case"show":return t.images[0]&&t.images[0].url;case"track":return t.album.images[0].url;case"episode":return t.show.images[0].url;default:return}};var H,V=function(e){return e.viewport.width<I},G=function(e){return function(e){return-1===["track","episode"].indexOf(F(e).type)}(e)?e.viewport.height>150:e.viewport.height>230},W=function(e){return"".concat(V(e)?"legacy":"modern","-").concat(G(e)?"extended":"basic")},q=function(e){return"legacy-extended"===W(e)&&-1!==["track","episode"].indexOf(F(e).type)},z=n(2398),$=n.n(z);n(8217),n(8410);!function(e){e.CAPPING_USER_IS_CAPPED="CAPPING_USER_IS_CAPPED",e.EME_API_NOT_SUPPORTED="EME_API_NOT_SUPPORTED",e.EME_MEDIA_KEYS_NOT_SUPPORTED="EME_MEDIA_KEYS_NOT_SUPPORTED",e.EME_MEDIA_KEY_SESSION_NOT_SUPPORTED="EME_MEDIA_KEY_SESSION_NOT_SUPPORTED",e.EME_NO_SUPPORTED_KEYSYSTEM="EME_NO_SUPPORTED_KEYSYSTEM",e.EME_PLAYER_MEDIA_KEYS_SETTING_FAILED="EME_PLAYER_MEDIA_KEYS_SETTING_FAILED",e.EME_ERROR_UNKNOWN="EME_ERROR_UNKNOWN",e.EME_LICENSE_REQUEST_EMPTY_RESPONSE="EME_LICENSE_REQUEST_EMPTY_RESPONSE",e.EME_LICENSE_REQUEST_FAILED_WITH_STATUS="EME_LICENSE_REQUEST_FAILED_WITH_STATUS",e.EME_LICENSE_REQUEST_WIDEVINE_ERROR="EME_LICENSE_REQUEST_WIDEVINE_ERROR",e.EME_LICENSE_UPDATE_FAILED="EME_LICENSE_UPDATE_FAILED",e.EME_HEADER_KEY_VALUE_MISMATCH="EME_HEADER_KEY_VALUE_MISMATCH",e.EME_HEADER_MISSING_CHALLENGE="EME_HEADER_MISSING_CHALLENGE",e.EME_INIT_DATA_MALFORMED="EME_INIT_DATA_MALFORMED",e.EME_CANNOT_SET_CERTIFICATE_FOR_PLATFORM="EME_CANNOT_SET_CERTIFICATE_FOR_PLATFORM",e.EME_MEDIA_KEY_SESSION_V0_1B_ERROR="EME_MEDIA_KEY_SESSION_V0_1B_ERROR",e.EME_MEDIA_KEY_SESSION_SAFARI_ERROR="EME_MEDIA_KEY_SESSION_SAFARI_ERROR",e.EME_NO_SUPPORTED_CONFIGURATION="EME_NO_SUPPORTED_CONFIGURATION",e.EME_NOT_SUPPORTED_ERROR="EME_NOT_SUPPORTED_ERROR",e.EME_INVALID_STATE_ERROR="EME_INVALID_STATE_ERROR",e.EME_UNKNOWN_ERROR="EME_UNKNOWN_ERROR",e.DISALLOW_PROTECTED_TRACK_ERROR="DISALLOW_PROTECTED_TRACK_ERROR",e.FILE_FORMAT_NOT_SUPPORTED="FILE_FORMAT_NOT_SUPPORTED",e.FILE_MALFORMED_SEEKTABLE="FILE_MALFORMED_SEEKTABLE",e.FILE_MALFORMED_PSSH="FILE_MALFORMED_PSSH",e.FILE_NOT_RESOLVED="FILE_NOT_RESOLVED",e.FRAGMENT_ONLINE_REQUEST_FAILED_WITH_ZERO="FRAGMENT_ONLINE_REQUEST_FAILED_WITH_ZERO",e.FRAGMENT_OFFLINE_REQUEST_FAILED_WITH_ZERO="FRAGMENT_OFFLINE_REQUEST_FAILED_WITH_ZERO",e.FRAGMENT_REQUEST_FAILED_WITH_ZERO="FRAGMENT_REQUEST_FAILED_WITH_ZERO",e.FRAGMENT_REQUEST_FAILED_WITH_STATUS="FRAGMENT_REQUEST_FAILED_WITH_STATUS",e.FRAGMENT_REQUEST_EMPTY_RESPONSE="FRAGMENT_REQUEST_EMPTY_RESPONSE",e.FRAGMENT_REQUEST_UNEXPECTED_LENGTH="FRAGMENT_REQUEST_UNEXPECTED_LENGTH",e.PLAYER_ATTEMPTED_VOLUME_OUT_OF_RANGE="PLAYER_ATTEMPTED_VOLUME_OUT_OF_RANGE",e.PLAYER_BUFFER_QUOTA_EXCEEDED="PLAYER_BUFFER_QUOTA_EXCEEDED",e.PLAYER_CANNOT_FIND_PLAYABLE_URI="PLAYER_CANNOT_FIND_PLAYABLE_URI",e.PLAYER_INVALID_INTERNAL_STATE="PLAYER_INVALID_INTERNAL_STATE",e.PLAYER_MEDIA_ERROR="PLAYER_MEDIA_ERROR",e.PLAYER_PLAYBACK_ERROR="PLAYER_PLAYBACK_ERROR",e.MEDIA_ABORTED="MEDIA_ABORTED",e.MEDIA_DECODING_ERROR="MEDIA_DECODING_ERROR",e.MEDIA_NETWORK_ERROR="MEDIA_NETWORK_ERROR",e.MEDIA_NOT_SUPPORTED="MEDIA_NOT_SUPPORTED",e.LICENSE_RESOLVE_INVALID_RESPONSE="LICENSE_RESOLVE_INVALID_RESPONSE",e.LICENSE_RESOLVER_CANT_RESOLVE_URL="LICENSE_RESOLVER_CANT_RESOLVE_URL",e.LICENSE_RESOLVER_DEPRECATED_VERSION="LICENSE_RESOLVER_DEPRECATED_VERSION",e.LIST_PLAYER_NO_TRACK_PLAYER="LIST_PLAYER_NO_TRACK_PLAYER",e.LIST_PLAYER_NO_LIST="LIST_PLAYER_NO_LIST",e.LIST_PLAYER_INVALID_ARGUMENT="LIST_PLAYER_INVALID_ARGUMENT",e.LIST_PLAYER_FORBIDDEN="LIST_PLAYER_FORBIDDEN",e.STORAGE_ERROR="STORAGE_ERROR",e.STORAGE_FAILED_WITH_STATUS="STORAGE_FAILED_WITH_STATUS",e.STORAGE_RETURNED_NO_TRACKS="STORAGE_RETURNED_NO_TRACKS",e.STORAGE_TRACK_MANIFEST_FAILED="STORAGE_TRACK_MANIFEST_FAILED",e.STORAGE_TRACK_MANIFEST_EMPTY="STORAGE_TRACK_MANIFEST_EMPTY",e.STORAGE_VIDEO_MANIFEST_FAILED="STORAGE_VIDEO_MANIFEST_FAILED",e.TRACK_DATA_ALREADY_FINALIZED="TRACK_DATA_ALREADY_FINALIZED",e.TSV_SENDING_FAILED="TSV_SENDING_FAILED",e.PLAYBACK_STATS_SENDING_FAILED="PLAYBACK_STATS_SENDING_FAILED",e.PLAYBACK_START_SENDING_FAILED="PLAYBACK_START_SENDING_FAILED",e.UNKNOWN="UNKNOWN"}(H||(H={}));var Q,X=n(6171);!function(e){e.USER_INFO_REQUEST_EMPTY_RESPONSE="USER_INFO_REQUEST_EMPTY_RESPONSE",e.USER_INFO_REQUEST_FAILED_WITH_STATUS="USER_INFO_REQUEST_FAILED_WITH_STATUS",e.HARMONY_NO_TRACKS_LOADED="HARMONY_NO_TRACKS_LOADED",e.HARMONY_OPERATION_FORBIDDEN="HARMONY_OPERATION_FORBIDDEN",e.HARMONY_LOCAL_PLAYER_DISABLED="HARMONY_LOCAL_PLAYER_DISABLED",e.HARMONY_INVALID_DESCRIPTOR_ID="HARMONY_INVALID_DESCRIPTOR_ID",e.CONNECTAPI_CLIENT_INVALID_ARGUMENTS="CONNECTAPI_CLIENT_INVALID_ARGUMENTS",e.CONNECTAPI_CLIENT_MISSING_DEVICE_ID="CONNECTAPI_CLIENT_MISSING_DEVICE_ID",e.CONNECTAPI_CLIENT_NO_CONNECTION_ID="CONNECT_API_CLIENT_NO_CONNECTION_ID",e.CONNECTAPI_CLIENT_NO_DEVICE="CONNECTAPI_CLIENT_NO_DEVICE",e.CONNECTAPI_CLIENT_NO_SESSION_ID="CONNECTAPI_CLIENT_NO_SESSION_ID",e.CONNECTAPI_CLIENT_NO_STATE="CONNECTAPI_CLIENT_NO_STATE",e.CONNECTAPI_CLIENT_INVALID_POSITION="CONNECT_API_CLIENT_INVALID_POSITION",e.CONNECTAPI_CLIENT_INVALID_VOLUME="CONNECT_API_CLIENT_INVALID_VOLUME",e.CONNECTAPI_MAX_SUBSCRIPTIONS_REACHED="CONNECTAPI_MAX_SUBSCRIPTIONS_REACHED",e.CONNECTAPI_REGISTRATION_FAILED_WITH_STATUS="CONNECTAPI_REGISTRATION_FAILED_WITH_STATUS",e.CP_NO_DEVICE_DESCRIPTOR="CP_NO_DEVICE_DESCRIPTOR",e.CP_NO_CONNECTION_ID="CP_NO_CONNECTION_ID",e.CP_REGISTRATION_FAILED_WITH_STATUS="CP_REGISTRATION_FAILED_WITH_STATUS",e.CP_REQUEST_FAILED_WITH_STATUS="CP_REQUEST_FAILED_WITH_STATUS",e.CP_NO_DEVICE_ID="CP_NO_DEVICE_ID",e.CP_NO_RESPONSE_BODY="CP_NO_RESPONSE_BODY",e.CP_NO_TRACKING_DATA="CP_NO_TRACKING_DATA",e.CP_INVALID_STATE="CP_INVALID_STATE",e.QUEUE_MANAGER_NO_STATE="QUEUE_MANAGER_NO_STATE",e.QUEUE_OPERATION_STALE_REVISION="QUEUE_OPERATION_STALE_REVISION",e.TP_NO_RESPONSE_BODY="TP_NO_RESPONSE_BODY",e.TP_REGISTRATION_FAILED_NON_PREMIUM="TP_REGISTRATION_FAILED_NON_PREMIUM",e.TP_REGISTRATION_FAILED_WITH_STATUS="TP_REGISTRATION_FAILED_WITH_STATUS",e.TP_MAX_SUBSCRIPTIONS_REACHED="TP_MAX_SUBSCRIPTIONS_REACHED",e.TP_UPDATE_REQUEST_EMPTY_RESPONSE="TP_UPDATE_REQUEST_EMPTY_RESPONSE",e.TP_PARSE_STATE_UPDATE_FAILED_WITH_STATUS="TP_PARSE_STATE_UPDATE_FAILED_WITH_STATUS",e.TP_UNKNOWN_COMMAND="TP_UNKNOWN_COMMAND",e.TP_CANNOT_CREATE_STATE_REF="TP_CANNOT_CREATE_STATE_REF",e.TP_MISSING_INITIAL_STATE="TP_MISSING_INITIAL_STATE",e.TP_INVALID_STATE_REFERENCE="TP_INVALID_STATE_REFERENCE",e.TP_CONFLICT_REQUEST_FAILED_WITH_STATUS="TP_CONFLICT_REQUEST_FAILED_WITH_STATUS"}(Q||(Q={}));n(3238),n(1418),n(9273);var J=n(912);var Z,ee=n(7613),te=n.n(ee),ne=(n(5769),n(7460),n(4078),n(3352),n(2279));!function(e){e.APPLOAD="appload",e.BACK_BUTTON="backbtn",e.CLICK_ROW="clickrow",e.CLICK_SIDE="clickside",e.END_PLAY="endplay",e.FORWARD_BUTTON="fwdbtn",e.LOGOUT="logout",e.PLAY_BUTTON="playbtn",e.POPUP="popup",e.REMOTE="remote",e.TRACK_DONE="trackdone",e.TRACK_ERROR="trackerror",e.UNKNOWN="unknown",e.URI_OPEN="uriopen",e.CAPPED="capped"}(Z||(Z={}));var re,ie,se,oe="@local",ae=65535;!function(e){e.AUTHENTICATED="authenticated",e.AUTHENTICATION_ERROR="authentication_error",e.AUTOPLAY_FAILED="autoplay_failed",e.BEFORE_DISCONNECT="before_disconnect",e.BEFORE_VOLUME_CHANGE="before_volume_change",e.BUFFER_STALLED="stalled",e.BUFFERING_END="buffering_end",e.BUFFERING_START="buffering_start",e.CONNECTED="connected",e.CONNECTION_ERROR="connection_error",e.DEVICES_CHANGED="devices_changed",e.DEVICE_DEACTIVATED="device_deactivated",e.DEVICE_DESCRIPTOR_CHANGED="descriptor_changed",e.DISCONNECTED="disconnected",e.DURATION_CHANGED="duration_changed",e.ERROR="error",e.LAST_ACTIVE_DEVICE_INFO_CHANGED="last_active_device_info_changed",e.LOCAL_CONTEXT_ENDED="local_context_ended",e.LOCAL_PLAYER_DISABLED="local_player_disabled",e.LOCAL_PLAYER_ENABLED="local_player_enabled",e.LOCAL_PLAYER_LOGGED_OUT="local_player_logged_out",e.LOGGED_OUT="logged_out",e.MAX_LIST_ERRORS_REACHED="max_list_errors_reached",e.MAX_SUBSCRIPTIONS_REACHED="max_subscriptions_reached",e.PLAYBACK_CAPPED="playback_capped",e.PLAYER_INITIALIZATION_DONE="player_initialization_done",e.PLAYER_INITIALIZATION_FAILED="player_initialization_failed",e.PRODUCT_STATE_CHANGED="product_state_changed",e.PROGRESS="progress",e.PLAYER_QUEUE_CHANGED="player_queue_changed",e.RECONNECTED="reconnected",e.RECONNECTING="reconnecting",e.REMOTE_OBSERVER_DISABLED="remote_observer_disabled",e.REMOTE_OBSERVER_ENABLED="remote_observer_enabled",e.SERVICE_REGISTRATION_ERROR="service_registration_error",e.STATE_CHANGED="state_changed",e.STOPPED_ON_BACKGROUND="stopped_on_background",e.TRACK_ENDED="track_ended",e.UNRECOVERABLE_FAILURE="unrecoverable_failure",e.VIDEO_ELEMENT_APPENDED="video_element_appended",e.VIDEO_ELEMENT_REMOVED="video_element_removed",e.VOLUME_CHANGED="volume_changed"}(re||(re={})),function(e){e.CONNECT_API="connect-api",e.HARMONY="harmony",e.PLAYBACK="playback",e.TRACK_PLAYBACK="track-playback",e.TRANSPORT="transport"}(ie||(ie={})),function(e){e[e.OFF=0]="OFF",e[e.CONTEXT=1]="CONTEXT",e[e.TRACK=2]="TRACK"}(se||(se={}));var ce=n(4885),le=n.n(ce);function ue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var de=function(e){v()(n,e);var t=ue(n);function n(e,r){var i;return h()(this,n),(i=t.call(this,r)).status=-1,i.unrecoverable=!1,i.debug={},i.code=e,i.name="HarmonyError",i}return f()(n,null,[{key:"fatal",value:function(e,t){var r=new n(e,t);return r.unrecoverable=!0,r}}]),n}(le()(Error));function pe(){var e,t;return{promise:new Promise((function(n,r){e=n,t=r})),resolve:e,reject:t}}function he(e,t){return!e&&!t||!(!e||!t)&&(e.id===t.id&&e.is_active===t.is_active&&e.is_controllable===t.is_controllable&&e.is_observable===t.is_observable&&e.local===t.local&&e.name===t.name&&e.type===t.type&&e.version===t.version&&e.volume===t.volume)}n(2189),n(1047);var _e=n(6292),fe=n.n(_e);n(5610);function ge(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var me=function(e){v()(n,e);var t=ge(n);function n(e,r){var i;return h()(this,n),(i=t.call(this,r)).unrecoverable=!1,i.code=e,i.name="PlayerQueueError",i}return n}(le()(Error));function ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}function ve(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ee(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ee(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){a=!0,s=e},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw s}}}}function Ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Se=":::";function be(e){var t,n,r,i,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ignoreMetaForTrack:!1},o=[],a=[],c=!1,l=!1;if(!(null==e?void 0:e.length))return{items:o,tracks:a,hasQueuedTracks:c};var u,d=ve(e);try{for(d.s();!(u=d.n()).done;){var p=u.value,h="spotify:delimiter"===p.uri||/^spotify:meta:/.test(p.uri)?"meta":"track",_="".concat(p.uid).concat(Se).concat(null===(t=p.metadata)||void 0===t?void 0:t.iteration),f={type:h,uri:p.uri,uid:p.uid,qid:_,metadata:p.metadata||{},hidden:"true"===(null===(n=p.metadata)||void 0===n?void 0:n.hidden),queued:"true"===(null===(r=p.metadata)||void 0===r?void 0:r.is_queued),provider:p.provider,removed_reasons:p.removed,$blck_rs:p.blocked};f.queued&&(c=!0),o.push(f),"meta"===f.type?l=!0:!s.ignoreMetaForTrack&&l||"track"!==f.type||f.hidden||(null===(i=f.removed_reasons)||void 0===i?void 0:i.length)||a.push(f)}}catch(g){d.e(g)}finally{d.f()}return{items:o,tracks:a,hasQueuedTracks:c}}function Te(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Array.isArray(e))throw new TypeError("Items is not an array.");if(!e.length)return[];var n,r=[],i=ve(e);try{for(i.s();!(n=i.n()).done;){var s=n.value;if(s){"string"==typeof s&&(s={type:"track",uri:s});var o={uri:s.uri,uid:s.uid,metadata:s.metadata||{},removed:s.removed_reasons,blocked:s.$blck_rs,provider:s.provider};(s.queued||t.queued)&&(o.metadata.is_queued="true",o.provider="queue"),(s.hidden||"meta"===s.type)&&(o.metadata.hidden="true"),r.push(o)}}}catch(a){i.e(a)}finally{i.f()}return r}function Ce(e){var t=e.split(Se),n=te()(t,2),r=n[0],i=n[1],s={type:"track",uid:r};return i&&(s.metadata={iteration:i}),s}var Ie=function(e){v()(n,e);var t=ye(n);function n(e){var r;return h()(this,n),(r=t.call(this))._hasInitialState=!1,r._reportInactiveQueues=!1,r._onlyLocalQueue=!1,r._currentPlayerState=null,r._currentInternalQueue=null,r._currentQueue=null,r._hasQueuedTracks=!1,r._connectClient=e.connectClient,r._runner=e.runner||function(e){return e()},r._parsePlayerState=r._parsePlayerState.bind(m()(r)),r._onlyLocalQueue=!!e.onlyLocalQueue,r._reportInactiveQueues=!!e.reportInactiveQueues,r._connectClient.on("player_state_changed",r._onPlayerStateChanged.bind(m()(r))),e.initialContextPlayerState&&r._parsePlayerState(e.initialContextPlayerState),r}return f()(n,[{key:"_onPlayerStateChanged",value:function(e){var t=e.data,n=t.playerState,r=t.orphaned,i=t.isLocal;this._parsePlayerState(n,r,i)}},{key:"_parsePlayerState",value:function(e,t,n){var r,i,s;if(this._hasInitialState=!0,this._onlyLocalQueue&&!n||!this._reportInactiveQueues&&t)this._currentPlayerState=null,this._currentInternalQueue=null,this._currentQueue=null;else if(this._currentPlayerState=null!=e?e:null,e){if(e.queue_revision===(null===(r=this._currentInternalQueue)||void 0===r?void 0:r.revision))return null;this._hasQueuedTracks=!1;var o={ignoreMetaForTrack:null===(i=e.options)||void 0===i?void 0:i.repeating_context},a=e.queue_revision,c=be([e.track]).items[0],l=be(e.next_tracks,o),u=be(e.prev_tracks,o);this._hasQueuedTracks=l.hasQueuedTracks;var d={uri:e.context_uri,metadata:null!==(s=e.context_metadata)&&void 0!==s?s:void 0};this._currentInternalQueue={revision:a,context:d,current_track:c,next_items:l.items,previous_items:u.items},this._currentQueue={revision:a,context:d,current_track:c,next_tracks:l.tracks,previous_tracks:u.tracks}}else this._hasQueuedTracks=!1,this._currentInternalQueue=null,this._currentQueue=null;return this.emit(re.PLAYER_QUEUE_CHANGED,{internalPlayerQueue:this._currentInternalQueue,playerQueue:this._currentQueue}),this._currentInternalQueue}},{key:"_setQueueNext",value:function(e,t){var n=this,r=this._currentPlayerState;if(!r)return Promise.reject(new me(Q.QUEUE_MANAGER_NO_STATE,"Cannot perform operation; no current state."));var i={next_tracks:e,prev_tracks:r.prev_tracks,queue_revision:r.queue_revision};return this._runner((function(){return n._connectClient.setQueue(i,t)}),t)}},{key:"_appendQueued",value:function(e,t){var n,r,i=this._currentPlayerState;if(!i)return Promise.reject(new me(Q.QUEUE_MANAGER_NO_STATE,"Cannot perform operation; no current state."));var s=Array.from(null!==(n=i.next_tracks)&&void 0!==n?n:[]);if(this._hasQueuedTracks){for(var o=!1,a=0,c=s.length;a<c;a++){if("true"!==(null===(r=s[a].metadata)||void 0===r?void 0:r.is_queued)){s.splice.apply(s,[a,0].concat(fe()(e))),o=!0;break}}o||s.push.apply(s,fe()(e))}else s.unshift.apply(s,fe()(e));return this._setQueueNext(s,t)}},{key:"getInternalPlayerQueue",value:function(){var e=this;return this._hasInitialState?Promise.resolve(this._currentInternalQueue):new Promise((function(t){e.on(re.PLAYER_QUEUE_CHANGED,(function(e){t(e.data.internalPlayerQueue)}))}))}},{key:"getPlayerQueue",value:function(){var e=this;return this._hasInitialState?Promise.resolve(this._currentQueue):new Promise((function(t){e.on(re.PLAYER_QUEUE_CHANGED,(function(e){t(e.data.playerQueue)}))}))}},{key:"setInternalPlayerQueue",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{ignoreRevision:!1};if(!this._currentPlayerState)return Promise.reject(new me(Q.QUEUE_MANAGER_NO_STATE,"Cannot perform operation; no current state."));if(e.revision!==this._currentPlayerState.queue_revision&&!r.ignoreRevision)return Promise.reject(new me(Q.QUEUE_OPERATION_STALE_REVISION,"Cannot perform operation; revision is stale."));var i={next_tracks:Te(e.next_items),prev_tracks:Te(e.previous_items),queue_revision:r.ignoreRevision?void 0:this._currentPlayerState.queue_revision};return this._runner((function(){return n._connectClient.setQueue(i,t)}),t)}},{key:"addToQueue",value:function(e,t){var n=this;if(!Array.isArray(e))return Promise.reject(new TypeError("Argument `items` must be an array."));var r=Te(e,{queued:!0});return r.length?1===r.length?this._runner((function(){return n._connectClient.addToQueue(r[0],t)}),t):this._appendQueued(r,t):Promise.resolve(!1)}},{key:"removeNext",value:function(e,t){var n,r,i,s,o=this._currentPlayerState;if(!o)return Promise.reject(new me(Q.QUEUE_MANAGER_NO_STATE,"Cannot perform operation; no current state."));s="string"==typeof e?Ce(e):e;for(var a=Array.from(null!==(n=o.next_tracks)&&void 0!==n?n:[]),c=a.length,l=0;l<c;l++){var u=a[l];if(u.uid===s.uid&&(null===(r=u.metadata)||void 0===r?void 0:r.iteration)===(null===(i=s.metadata)||void 0===i?void 0:i.iteration)){a.splice(l,1);break}}return a.length===c?Promise.resolve(!1):this._setQueueNext(a,t)}}],[{key:"create",value:function(e){return new n(e)}}]),n}(ne.vp);function Re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var Pe,Ae=15e3,Oe=function(e){v()(n,e);var t=Re(n);function n(e){var r;return h()(this,n),(r=t.call(this))._hasFakeState=!1,r._localPlayerEnabled=!1,r._localPlayback=!1,r._lastDeviceList=[],r._deferredStreamer=pe(),r._client=e.client,r._streamer=e.streamer,r._controller=e.controller,r._hidden=!!e.hidden,r._onlyLocalState=!!e.onlyLocalState,r._preferController=!r._onlyLocalState&&!!e.preferControllerState,r._claimInactivePlayerStates=!!e.claimInactivePlayerStates,r._enableControllerWithoutStreamer=!!e.enableControllerWithoutStreamer,r._autoActivateElement=!!e.autoActivateElement,r._deactivateOnStop=!!e.experimentalDeactivateOnStop,r._init(),r}return f()(n,[{key:"_init",value:function(){var e,t=this;this._createStreamerDeferred();var n=this._client;n.on("error",this._onError.bind(this)),this.proxyEmit(n,"authenticated",re.AUTHENTICATED),this.proxyEmit(n,"authentication_error",re.AUTHENTICATION_ERROR),this.proxyEmit(n,"before_disconnect",re.BEFORE_DISCONNECT),this.proxyEmit(n,"connected",re.CONNECTED),this.proxyEmit(n,"connection_error",re.CONNECTION_ERROR),this.proxyEmit(n,"descriptor_changed",re.DEVICE_DESCRIPTOR_CHANGED),this.proxyEmit(n,"product_state_changed",re.PRODUCT_STATE_CHANGED),this.proxyEmit(n,"reconnected",re.RECONNECTED),this.proxyEmit(n,"reconnecting",re.RECONNECTING),this.proxyEmit(n,"unrecoverable_failure",re.UNRECOVERABLE_FAILURE),this.proxyEmit(n,"logged_out",re.LOGGED_OUT);var r=this._controller;r.on("device_info_changed",(function(e){t._onDeviceStateChanged(e.data)})),r.on("devices_changed",this._onDevicesChanged.bind(this)),r.on("state_changed",this._onPlayerStateChanged.bind(this)),r.on("progress",this._onControllerProgress.bind(this)),this.proxyEmitAll(r,(e={},i()(e,"max_subscriptions_reached",re.MAX_SUBSCRIPTIONS_REACHED),i()(e,"device_deactivated",re.DEVICE_DEACTIVATED),e)),r.on("registered",this.emit.bind(this,re.REMOTE_OBSERVER_ENABLED,null)),r.on("deregistered",this.emit.bind(this,re.REMOTE_OBSERVER_DISABLED,null));var s=this._streamer;s?(s.on("deregistered",this._onStreamerDeregistered.bind(this)),s.on("registered",this._onStreamerRegistered.bind(this)),s.on("registration_aborted",this._onStreamerRegistrationAborted.bind(this)),s.on("state_changed",this._onStreamerStateChanged.bind(this)),s.on("stopped_on_background",this._onStreamerStoppedOnBackground.bind(this)),this.proxyEmitSync(s,"before_volume_change",re.BEFORE_VOLUME_CHANGE),this.proxyEmit(s,"autoplay_failed",re.AUTOPLAY_FAILED),this.proxyEmit(s,"stalled",re.BUFFER_STALLED),this.proxyEmit(s,"buffering_end",re.BUFFERING_END),this.proxyEmit(s,"buffering_start",re.BUFFERING_START),this.proxyEmit(s,"duration_changed",re.DURATION_CHANGED),this.proxyEmit(s,"max_list_errors_reached",re.MAX_LIST_ERRORS_REACHED),this.proxyEmit(s,"max_subscriptions_reached",re.MAX_SUBSCRIPTIONS_REACHED),this.proxyEmit(s,"playback_capped",re.PLAYBACK_CAPPED),this.proxyEmit(s,"player_initialization_done",re.PLAYER_INITIALIZATION_DONE),this.proxyEmit(s,"player_initialization_failed",re.PLAYER_INITIALIZATION_FAILED),this.proxyEmit(s,"progress",re.PROGRESS),this.proxyEmit(s,"registration_error",re.SERVICE_REGISTRATION_ERROR),this.proxyEmit(s,"track_ended",re.TRACK_ENDED),this.proxyEmit(s,"video_element_appended",re.VIDEO_ELEMENT_APPENDED),this.proxyEmit(s,"video_element_removed",re.VIDEO_ELEMENT_REMOVED),this.proxyEmit(s,"volume_changed",re.VOLUME_CHANGED),this.proxyEmitSync(s,"internal_endcontent","internal_endcontent"),s.on("context_ended",this.emit.bind(this,re.LOCAL_CONTEXT_ENDED,null)),s.on("logged_out",this.emit.bind(this,re.LOCAL_PLAYER_LOGGED_OUT,null))):(this._disableLocalTarget(),this.on(re.AUTHENTICATED,(function(){t.emit(re.LOCAL_PLAYER_DISABLED,null)})))}},{key:"_createStreamerDeferred",value:function(){this._deferredStreamer=pe(),this._deferredStreamer.promise.catch((function(){}))}},{key:"_isTargetIdLocal",value:function(e){return e?e===oe?Promise.resolve(!0):this._client.getDeviceDescriptor().then((function(t){return e===t.getId()})):Promise.resolve(!!this._localPlayback)}},{key:"_onStreamerRegistered",value:function(e){this._deferredStreamer.resolve(e.data),this._createStreamerDeferred(),this._deferredStreamer.resolve(e.data),this._localPlayerEnabled=!0,this._controller.register(),this.emit(re.LOCAL_PLAYER_ENABLED,null)}},{key:"_onStreamerDeregistered",value:function(){this._disableLocalTarget(),this.emit(re.LOCAL_PLAYER_DISABLED,null)}},{key:"_onStreamerRegistrationAborted",value:function(){this._disableLocalTarget(),this._enableControllerWithoutStreamer&&this._controller.register(),this.emit(re.LOCAL_PLAYER_DISABLED,null)}},{key:"_disableLocalTarget",value:function(){this._localPlayerEnabled=!1;var e=new de(Q.HARMONY_LOCAL_PLAYER_DISABLED,"Cannot perform command; local player is disabled.");this._deferredStreamer.reject(e),this._createStreamerDeferred(),this._deferredStreamer.reject(e)}},{key:"_onStreamerConnect",value:function(){return this._deferredStreamer.promise}},{key:"_onDeviceStateChanged",value:function(e){var t=this,n=!!this._localPlayback,r=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t._generateLocalDeviceInfo(e).then((function(e){t.emit(re.LAST_ACTIVE_DEVICE_INFO_CHANGED,{deviceInfo:e,hasOrphanedState:!1})}))};if(this._localPlayerEnabled&&e.hasOrphanedState&&this._claimInactivePlayerStates)return this._hasFakeState=!0,void r(!0);if(this._hasFakeState=!1,this._localPlayback=!(!e.deviceInfo||!e.deviceInfo.local),this._localPlayback){if(!this._streamer)throw new de(Q.HARMONY_OPERATION_FORBIDDEN,"No streamer provided.");this._streamer.getVolume().then((function(n){e.deviceInfo&&(e.deviceInfo.volume=n),t.emit(re.LAST_ACTIVE_DEVICE_INFO_CHANGED,e)})).catch((function(){}))}else this._onlyLocalState?(this._localPlayback||n)&&r():this.emit(re.LAST_ACTIVE_DEVICE_INFO_CHANGED,e)}},{key:"_onDevicesChanged",value:function(e){var t=this,n=this._lastDeviceList;this._parseDeviceList(e.data).then((function(e){(function(e,t){if(!Array.isArray(e)||!Array.isArray(t))throw new TypeError("Invalid devices list.");if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(!he(e[n],t[n]))return!1;return!0})(n,e)||t.emit(re.DEVICES_CHANGED,{devices:e,localDevice:null})}))}},{key:"_onError",value:function(e){var t=e.data.error;e.data.source===ie.PLAYBACK&&t&&t.unrecoverable&&(this._disableLocalTarget(),this._streamer&&this._streamer.deregister()),this.emit(re.ERROR,e.data)}},{key:"_onPlayerStateChanged",value:function(e){var t;this._onlyLocalState||(!this._preferController&&this._localPlayback||(t=this._localPlayerEnabled&&this._claimInactivePlayerStates?e.data.state:e.data.orphaned?null:e.data.state,this.emit(re.STATE_CHANGED,{state:t})))}},{key:"_onControllerProgress",value:function(e){this._onlyLocalState||this._localPlayback||this.emit(re.PROGRESS,e.data)}},{key:"_onStreamerStateChanged",value:function(e){this._preferController||(this._onlyLocalState?this._triggerLocalStateChanges(e.data):this._hidden?this._handleHidden(e.data):this._localPlayback&&this.emit(re.STATE_CHANGED,e.data))}},{key:"_onStreamerStoppedOnBackground",value:function(){this._deactivateOnStop&&(this._localPlayback=!1),this.emit(re.STOPPED_ON_BACKGROUND,null)}},{key:"_handleHidden",value:function(e){e.state?(this._controller.suppressEvents(),this._triggerLocalStateChanges(e)):this._controller.unsuppressEvents()}},{key:"_parseDeviceList",value:function(e){var t=this,n=e.devices.slice(0).map((function(e){return Promise.resolve(e)}));return n.length&&e.localDevice?this._hasFakeState&&e.localDevice&&(e.localDevice.is_active=!0):n.push(this._generateLocalDeviceInfo(this._hasFakeState)),Promise.all(n).then((function(e){return t._lastDeviceList=e,e}))}},{key:"_triggerLocalStateChanges",value:function(e){var t=this;this._generateLocalDeviceInfo().then((function(e){t._onDeviceStateChanged({deviceInfo:e,hasOrphanedState:!1})})),this.emit(re.STATE_CHANGED,e)}},{key:"_canStartNewContext",value:function(e){var t=this;return this._runOnDevice(e,(function(){return t._streamer?Promise.resolve(!0):Promise.reject(new de(Q.HARMONY_OPERATION_FORBIDDEN,"No streamer provided."))}),(function(){return Promise.resolve(!0)}),!0)}},{key:"_activateElement",value:function(){this._autoActivateElement=!1,this._streamer&&this._streamer.activateElement().catch((function(){}))}},{key:"_runOnDevice",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;return this._hasFakeState&&!i?(this._autoActivateElement&&this._activateElement(),this._claimStateAndRun(r)):this._isTargetIdLocal(t).then((function(t){return t?e._onStreamerConnect().then(n):r()}))}},{key:"_claimStateAndRun",value:function(e){var t=this;return this._onStreamerConnect().then((function(){return t._hasFakeState=!1,Promise.all([t._controller.transfer(oe,{paused:!0}),new Promise((function(e,n){t._streamer?t._streamer.once("track_loaded",e):n(new de(Q.HARMONY_OPERATION_FORBIDDEN,"No streamer provided."))}))])})).then((function(){return e()}))}},{key:"_generateLocalDeviceInfo",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this._client,r=this._streamer,i=Promise.resolve(!1),s=Promise.resolve(-1);return this._localPlayerEnabled&&(t?i=Promise.resolve(!0):r&&(i=r.getCurrentState().then((function(e){return!!e}))),r&&(s=r.getVolume())),Promise.all([n.getClientDescriptor(),n.getSDKId(),i,s]).then((function(t){var n,r=te()(t,4),i=r[0],s=r[1],o=r[2],a=r[3],c={hifi_status:{fully_supported:void 0,user_eligible:void 0,device_supported:null===(n=i.capabilities)||void 0===n?void 0:n.lossless_playback}};return{hidden:e._hidden,id:i.id,is_active:o,is_controllable:e._localPlayerEnabled,is_observable:!!e._localPlayerEnabled&&!e._hidden,local:!0,metadata:i.metadata||{},name:i.name,type:i.type,version:s,volume:a,capabilities:{supports_lossless_audio:!1},playback_features:c,has_inactive_player_state:e._hasFakeState}}))}},{key:"_movePosition",value:function(e,t){var n=this;return this.getCurrentState().then((function(r){if(!r||isNaN(r.position))return Promise.reject(new de(Q.HARMONY_OPERATION_FORBIDDEN,"Seeking not allowed with invalid track."));var i=e,s=Math.min(r.duration,Math.max(0,r.position+i));return n.seek(s,t)}))}},{key:"_prepareSkipTrack",value:function(e){return"string"==typeof e?Ce(e):e}},{key:"_cycleRepeatMode",value:function(e){var t=this;return this.getCurrentState().then((function(n){if(!n)return Promise.reject(new de(Q.CONNECTAPI_CLIENT_NO_STATE,"Nothing playing"));var r=null,i=n.disallows;switch(n.repeat_mode){case se.OFF:if(i.toggling_repeat_context){if(i.toggling_repeat_track)return Promise.resolve(!1);r=se.TRACK}else r=se.CONTEXT;break;case se.CONTEXT:r=i.toggling_repeat_track?se.OFF:se.TRACK;break;case se.TRACK:r=se.OFF;break;default:r=se.OFF}return t.setRepeatMode(r,e)}))}},{key:"getClientDescriptor",value:function(){return this._client.getClientDescriptor()}},{key:"getProductState",value:function(){return this._client.getProductState()}},{key:"getPublicTransport",value:function(){return this._client.getPublicTransport()}},{key:"getUserInfo",value:function(){return this._client.getUserInfo()}},{key:"getVersionDescriptor",value:function(){return this._client.getVersionDescriptor()}},{key:"logAppMetrics",value:function(e,t){return this._client.logAppMetrics(e,t)}},{key:"setName",value:function(e){return this._client.setName(e)}},{key:"setNameTemplate",value:function(e){return this._client.setNameTemplate(e)}},{key:"getContextPlayerState",value:function(){return this._controller.getContextPlayerState()}},{key:"updateCurrentContext",value:function(e,t){return this._controller.updateCurrentContext(e,t)}},{key:"getLastActiveDevice",value:function(){var e=this;return this._onlyLocalState||this._hasFakeState?this._generateLocalDeviceInfo(this._hasFakeState):this._controller.getActiveDevice().then((function(t){return(null==t?void 0:t.local)&&e._streamer?(t.hidden=e._hidden,e._streamer.getVolume().then((function(e){return t.volume=e,t}))):t}))}},{key:"getCurrentState",value:function(){var e=this;if(!this._onlyLocalState&&(this._preferController||!this._localPlayback)){var t=!this._localPlayerEnabled||!this._claimInactivePlayerStates;return this._controller.getCurrentState(t).then((function(t){return!e._preferController&&e._localPlayback?e.getCurrentState():t}))}return this._onStreamerConnect().then(this._streamer.getCurrentState.bind(this._streamer))}},{key:"togglePlay",value:function(e){var t=this;return this._runOnDevice(e,(function(){return t._streamer.togglePlay()}),this._controller.togglePlay.bind(this._controller,e))}},{key:"pause",value:function(e){var t=this;return this._runOnDevice(e,(function(){return t._streamer.pause()}),this._controller.pause.bind(this._controller,e))}},{key:"resume",value:function(e){var t=this;return this._runOnDevice(e,(function(){return t._streamer.resume()}),this._controller.resume.bind(this._controller,e))}},{key:"playURI",value:function(e,t,n){var r=this;return this._canStartNewContext(t).then((function(){return r._autoActivateElement&&r._activateElement(),r._controller.playURI(e,t,n)}))}},{key:"playPages",value:function(e,t,n){var r=this;return this._canStartNewContext(t).then((function(){return r._autoActivateElement&&r._activateElement(),r._controller.playPages(e,t,n)}))}},{key:"playTracks",value:function(e,t,n){var r=this;return this._canStartNewContext(t).then((function(){return r._autoActivateElement&&r._activateElement(),r._controller.playTracks(e,t,n)}))}},{key:"nextTrack",value:function(e,t){var n=this,r={},i=function(){return n._streamer.nextTrack(Z.FORWARD_BUTTON)},s=this._controller.nextTrack.bind(this._controller,e,r);return(null==t?void 0:t.track)&&(i=s,r.track=this._prepareSkipTrack(t.track)),this._runOnDevice(e,i,s)}},{key:"smartPreviousTrack",value:function(e){var t=this;return this.getCurrentState().then((function(n){return n?(n.disallows||{}).seeking||n.position<3e3&&n.track_window&&n.track_window.previous_tracks&&n.track_window.previous_tracks.length>0?t.previousTrack(e):t.seek(0,e):Promise.reject(new de(Q.HARMONY_NO_TRACKS_LOADED,"No current state."))}))}},{key:"previousTrack",value:function(e,t){var n=this,r={},i=function(){return n._streamer.previousTrack(Z.FORWARD_BUTTON)},s=this._controller.previousTrack.bind(this._controller,e,r);return(null==t?void 0:t.track)&&(i=s,r.track=this._prepareSkipTrack(t.track)),this._runOnDevice(e,i,s)}},{key:"seek",value:function(e,t){var n=this;return this._runOnDevice(t,(function(){return n._streamer.seek(e)}),this._controller.seek.bind(this._controller,e,t))}},{key:"seekForward",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ae,t=arguments.length>1?arguments[1]:void 0;return this._movePosition(e,t)}},{key:"seekBackward",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ae,t=arguments.length>1?arguments[1]:void 0;return this._movePosition(-1*e,t)}},{key:"getVolume",value:function(){return this._streamer?this._streamer.getVolume():Promise.resolve(-1)}},{key:"setVolume",value:function(e,t){var n=this;return this._runOnDevice(t,(function(){return n._streamer.setVolume(e)}),this._controller.setVolume.bind(this._controller,e),!0)}},{key:"getVideoProfiles",value:function(){if(!this._streamer)throw new de(Q.HARMONY_OPERATION_FORBIDDEN,"No streamer provided.");return this._streamer.getVideoVariants()}},{key:"setPreferredBitrate",value:function(e){if(!this._streamer)throw new de(Q.HARMONY_OPERATION_FORBIDDEN,"No streamer provided.");return this._streamer.setPreferredBitrate(e)}},{key:"getDevices",value:function(){return this._controller.getDevices().then(this._parseDeviceList.bind(this))}},{key:"setQueue",value:function(e,t,n){var r=this._controller.setQueue.bind(this._controller,e,t,n);return this._runOnDevice(n,r,r)}},{key:"addToQueue",value:function(e,t){var n=e.map((function(e){return"string"==typeof e?e:e.uri}));return this._controller.getQueueManager().addToQueue(n,t)}},{key:"setShuffle",value:function(e,t){var n=this._controller.setShuffle.bind(this._controller,e,t);return this._runOnDevice(t,n,n)}},{key:"toggleShuffle",value:function(e){var t=this._controller.toggleShuffle.bind(this._controller,e);return this._runOnDevice(e,t,t)}},{key:"setRepeatMode",value:function(e,t){var n=this._controller.setRepeatMode.bind(this._controller,e,t);return this._runOnDevice(t,n,n)}},{key:"cycleRepeatMode",value:function(e){var t=this._cycleRepeatMode.bind(this,e);return this._runOnDevice(e,t,t)}},{key:"transfer",value:function(e,t){var n=e||oe,r=this._controller.transfer.bind(this._controller,n,t);return this._autoActivateElement&&this._activateElement(),this._runOnDevice(n,r,r,!0)}},{key:"logout",value:function(e){return this._controller.logout(e||oe)}},{key:"activateElement",value:function(){return this._streamer?this._streamer.activateElement():Promise.reject(new de(Q.HARMONY_LOCAL_PLAYER_DISABLED,"Cannot activate element; local player is disabled."))}},{key:"getQueueManager",value:function(){var e=this;return this._controller.getQueueManager((function(t,n){return e._runOnDevice(n,t,t)}),{reportInactiveQueues:this._claimInactivePlayerStates,onlyLocalQueue:this._onlyLocalState,reportInitial:this._hasFakeState||this._localPlayback})}},{key:"hideSubtitles",value:function(){return this._localPlayback?this._streamer?this._streamer.hideSubtitles():Promise.reject(new de(Q.HARMONY_OPERATION_FORBIDDEN,"No streamer provided.")):Promise.reject(new de(Q.HARMONY_OPERATION_FORBIDDEN,"Cannot hide subtitles on remote player."))}},{key:"showSubtitles",value:function(){return this._localPlayback?this._streamer?this._streamer.showSubtitles():Promise.reject(new de(Q.HARMONY_OPERATION_FORBIDDEN,"No streamer provided.")):Promise.reject(new de(Q.HARMONY_OPERATION_FORBIDDEN,"Cannot show subtitles on remote player."))}},{key:"areSubtitlesShown",value:function(){return this._localPlayback?this._streamer?this._streamer.areSubtitlesShown():Promise.reject(new de(Q.HARMONY_OPERATION_FORBIDDEN,"No streamer provided.")):Promise.reject(new de(Q.HARMONY_OPERATION_FORBIDDEN,"Cannot show subtitles on remote player."))}},{key:"getSubtitleLanguages",value:function(){return this._localPlayback?this._streamer?this._streamer.getSubtitleLanguages():Promise.reject(new de(Q.HARMONY_OPERATION_FORBIDDEN,"No streamer provided.")):Promise.reject(new de(Q.HARMONY_OPERATION_FORBIDDEN,"Cannot get subtitle languages on remote player."))}},{key:"getActiveSubtitleLanguage",value:function(){return this._localPlayback?this._streamer?this._streamer.getActiveSubtitleLanguage():Promise.reject(new de(Q.HARMONY_OPERATION_FORBIDDEN,"No streamer provided.")):Promise.reject(new de(Q.HARMONY_OPERATION_FORBIDDEN,"Cannot get subtitle language on remote player."))}},{key:"setSubtitleLanguage",value:function(e){return this._localPlayback?this._streamer?this._streamer.setSubtitleLanguage(e):Promise.reject(new de(Q.HARMONY_OPERATION_FORBIDDEN,"No streamer provided.")):Promise.reject(new de(Q.HARMONY_OPERATION_FORBIDDEN,"Cannot set subtitle languages on remote player."))}},{key:"setBackgrounded",value:function(e){return this._localPlayback?this._streamer?this._streamer.setBackgrounded(e):Promise.reject(new de(Q.HARMONY_OPERATION_FORBIDDEN,"No streamer provided.")):Promise.reject(new de(Q.HARMONY_OPERATION_FORBIDDEN,"Cannot set background mode on remote player."))}},{key:"setVideoResolution",value:function(e){return this._localPlayback?this._streamer?this._streamer.setVideoResolution(e):Promise.reject(new de(Q.HARMONY_OPERATION_FORBIDDEN,"No streamer provided.")):Promise.reject(new de(Q.HARMONY_OPERATION_FORBIDDEN,"Cannot set preferred video resolution on remote player."))}},{key:"getMediaConfig",value:function(){return this._streamer?this._streamer.getMediaConfig():Promise.reject(new de(Q.HARMONY_LOCAL_PLAYER_DISABLED,"Cannot activate element; local player is disabled."))}}],[{key:"create",value:function(e){return new n(e)}}]),n}(ne.vp),ke=(n(1438),n(4170),n(9849)),Le=n(8592);!function(e){e.LOGGING_REQUEST_FAILED="LOGGING_REQUEST_FAILED"}(Pe||(Pe={}));const we="unknown",De="",Ne="0.0.0";class Ue extends Error{constructor(e,t,n){super(t),this.name="LoggingError",this.code=e,this.status=n||0}}class Me{constructor(e){this._transport=e.transport,this._endpoint=e.endpoint||"@webgate/melody",this._identData=Promise.all([e.sdkId,e.platform,e.clientVersion]).then((([e,t,n])=>({sdk_id:e||De,platform:t||De,client_version:n||Ne})))}_sendLog(e,t){return this._identData.then((n=>this._transport.request(this._endpoint+e,{method:"POST",payload:JSON.stringify(Object.assign(Object.assign({},t),n)),retry:{maxRetries:5,condition:e=>202!==e.status}}))).then((({status:e})=>202===e||Promise.reject(new Ue(Pe.LOGGING_REQUEST_FAILED,`Logging service responded with status ${e}`,e))))}}const Be=/(edge)[\s\/:]([\w\d\.]+)/,xe=new RegExp("(opera|ie|firefox|chrome|trident|crios|version)[\\s/:]([\\w\\d\\.]+)?.*?(safari|(?:rv[\\s\\/:]|version[\\s\\/:])([\\w\\d\\.]+)|$)"),Fe={};function je(e){if(!e)return e;const t=function(e,t){const n=e.toLowerCase();let r=t?t.toLowerCase():"";const i=`${n}:${r}`;if(i in Fe)return Fe[i];const s=n.match(Be),o=n.match(xe)||[null,"unknown",0],a=s||o;"trident"===a[1]?(a[1]="ie",a[4]&&(a[2]=a[4])):"crios"===a[1]&&(a[1]="chrome"),r=n.match(/ip(?:ad|od|hone)/)?"ios":(n.match(/(?:webos|android)/)||n.match(/mac|win|linux|cros/)||["other"])[0],"win"===r&&(r="windows");const c="version"===a[1]?a[3]:a[1],l="opera"===a[1]&&a[4]?a[4]:a[2],u={name:c?c.toString():"unknown",version:null===l?"unknown":l.toString(),platform:r};return Fe[i]=u,u}(navigator.userAgent,navigator.platform);return e.replace(/\{\{([^}]+?)\}\}/g,(function(e,n){return r=n,(i=t)&&i.hasOwnProperty(r)?t[n]:"";var r,i}))}var Ye,Ke;!function(e){e.FILE_URLS_MP3="file_urls_mp3",e.FILE_URLS_EXTERNAL="file_urls_external",e.FILE_IDS_MP4="file_ids_mp4",e.FILE_IDS_MP4_DUAL="file_ids_mp4_dual",e.FILE_IDS_CBCS="file_ids_mp4_cbcs",e.FILE_IDS_MP4FLAC="file_ids_mp4flac",e.MANIFEST_IDS_VIDEO="manifest_ids_video"}(Ye||(Ye={})),function(e){e.UNKNOWN="unknown",e.COMPUTER="computer",e.TABLET="tablet",e.SMARTPHONE="smartphone",e.SPEAKER="speaker",e.TV="tv",e.AVR="avr",e.STB="stb",e.AUDIO_DONGLE="audio_dongle",e.GAME_CONSOLE="game_console",e.CAST_VIDEO="cast_video",e.CAST_AUDIO="cast_audio",e.AUTOMOBILE="automobile",e.SMARTWATCH="smartwatch",e.CHROMEBOOK="chromebook"}(Ke||(Ke={}));n(1572),n(9876),n(3712),n(2979),n(6160),n(1849),n(5540),n(896),n(936),n(40),n(5923),n(5246),n(7635),n(8774),n(8373),n(9706),n(6964),n(4630),n(5389),n(1244),n(9981),n(3807),n(2627),n(4950),n(1964);var He=n(1165);function Ve(){var e=new Uint8Array(16);return crypto.getRandomValues(e),He.Base62.toHex(e.join(""),40).slice(0,40)}function Ge(){for(var e=new Array(27),t=e.length;t--;)e[t]=Math.floor(8*Math.random());return He.Base62.toHex(e.join(""),40)}var We="undefined"!=typeof crypto&&"function"==typeof crypto.getRandomValues?Ve:Ge,qe="_spharmony_device_id";var ze={get:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e&&"string"==typeof e)return e;if(t)return We();var n=localStorage.getItem(qe);return n||(n=We(),localStorage.setItem(qe,n)),n},generate:We,generateWithCrypto:Ve,generateWithRandom:Ge};n(911);function $e(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var Qe=function(e){v()(n,e);var t=$e(n);function n(e){var r,i;if(h()(this,n),(r=t.call(this))._platformVersion="",r._metadata={},r._manifestPrependOffset=0,!e)throw new TypeError("Invalid argument `options`.");if(!e.id)throw new TypeError("Argument `options.id` is required.");if(!e.name||!e.model||!e.type)throw new TypeError("Incomplete `options` value.");return r._id=e.id,r._type=e.type,r._brand=e.brand,r._model=e.model,r._name=e.name,r._platformIdentifier=e.platform_identifier,r._platformVersion=e.platform_version||"",r._metadata=e.metadata||{},r._capabilities=e.capabilities||{manifest_formats:[]},r._manifestPrependOffset=(null===(i=r._capabilities.manifest_formats)||void 0===i?void 0:i.length)||0,r}return f()(n,[{key:"getId",value:function(){return this._id}},{key:"setCapability",value:function(e,t){switch(e){case"manifest_formats":throw new TypeError('Cannot change capability "manifest_formats"');default:return this._capabilities[e]=t,this.emit("descriptor_changed",{descriptor:this.toJSON()}),!0}}},{key:"getCapability",value:function(e){switch(e){case"manifest_formats":throw new TypeError("Use `descriptor.getManifestFormats()`.");default:return this._capabilities[e]}}},{key:"setName",value:function(e){return this._name=e,this.emit("descriptor_changed",{descriptor:this.toJSON()}),!0}},{key:"getName",value:function(){return this._name}},{key:"getPlatformIdentifier",value:function(){return this._platformIdentifier||"Partner ".concat(this._brand," ").concat(this._model)}},{key:"getPlatformVersion",value:function(){return this._platformVersion}},{key:"getManifestFormats",value:function(){return this._capabilities.manifest_formats||[]}},{key:"appendManifestFormat",value:function(){var e=this._capabilities.manifest_formats;Array.isArray(e)&&e.push.apply(e,arguments)}},{key:"prependManifestFormat",value:function(){var e=this._capabilities.manifest_formats;if(Array.isArray(e)){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e.splice.apply(e,[this._manifestPrependOffset,0].concat(n))}}},{key:"toJSON",value:function(){return{brand:this._brand,capabilities:Object.assign({},this._capabilities),id:this._id,metadata:Object.assign({},this._metadata),model:this._model,name:this._name,platform_identifier:this._platformIdentifier,platform_version:this._platformVersion,type:this._type}}},{key:"toTrackPlaybackDeviceInfo",value:function(){return{brand:this._brand,capabilities:Object.assign({},this._capabilities),device_id:this._id,device_type:this._type,metadata:Object.assign({},this._metadata),model:this._model,name:this._name,platform_identifier:this._platformIdentifier}}}],[{key:"create",value:function(e){return new n({id:ze.get(e.id,e.randomizeId),model:e.model||je("harmony-{{name}}.{{version}}-{{platform}}").toLowerCase(),name:e.nameTemplate?je(e.nameTemplate):e.name||(t=je("Spotify ({{name}}/{{platform}})"),t.replace(/\b[a-z]/g,(function(e){return e.toUpperCase()}))),type:e.type||Ke.COMPUTER,brand:e.brand||"SpotifyHarmonyGeneric",platform_identifier:e.platform_identifier,platform_version:e.platform_version,metadata:e.metadata||{},capabilities:e.capabilities||{}});var t}}]),n}(ne.vp),Xe={tagged:"4.16.1-2d8f288",version:"4.16.1",revision:"2d8f288"};function Je(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ze(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ze(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){a=!0,s=e},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw s}}}}function Ze(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function et(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var tt=function(e){v()(n,e);var t=et(n);function n(){return h()(this,n),t.apply(this,arguments)}return f()(n,[{key:"logClientEvent",value:function(e,t){return e?this._sendLog("/v1/logging/client_event",{sdk_id:void 0,platform:void 0,client_version:void 0,source:e.source||we,context:e.context||we,event:e.event||we,event_version:e.event_version||De,test_version:e.test_version||De,source_version:e.source_version||we,source_vendor:e.source_vendor||we,json_data:"json"===t?e.json_data||"{}":JSON.stringify(e.json_data||{})}):Promise.reject(new TypeError("Logger.logClientEvent `data` cannot be null."))}},{key:"logMetrics",value:function(e,t){if(!e&&!t)return Promise.resolve(!0);var n=e||[],r=t||[];if(!n.length&&!r.length)return Promise.resolve(!0);if(!Array.isArray(n)||!Array.isArray(r))return Promise.reject(new TypeError("Logger.logMetrics `meters` and `timers` must be null or an array."));var i,s=Je(n);try{for(s.s();!(i=s.n()).done;){var o=i.value;if(!("what"in o)||!("result"in o)||!("reason"in o))return Promise.reject(new TypeError("Logger.logMetrics: Invalid meter format in `meters` array."))}}catch(u){s.e(u)}finally{s.f()}var a,c=Je(r);try{for(c.s();!(a=c.n()).done;){var l=a.value;if(!("what"in l)||!("duration"in l))return Promise.reject(new TypeError("Logger.logMetrics: Invalid timer format in `timers` array."))}}catch(u){c.e(u)}finally{c.f()}return this._sendLog("/v1/metric",{sdk_id:void 0,platform:void 0,client_version:void 0,meters:n,timers:r})}},{key:"logJSSDKError",value:function(e,t){return this._sendLog("/v1/logging/jssdk_error",{sdk_id:void 0,platform:void 0,client_version:void 0,source:e.source||we,source_version:e.source_version||we,type:e.type||we,message:e.message||De,stack:JSON.stringify(e.stack||De),json_data:"json"===t?e.json_data||"{}":JSON.stringify(e.json_data||{}),json_data_version:e.json_data_version||Ne})}}]),n}(Me);function nt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var rt=ke.P.forTag("harmonyclient"),it=/^[a-zA-Z0-9_%:-]{1,40}$/,st=function(e){v()(n,e);var t=nt(n);function n(e){var r;if(h()(this,n),(r=t.call(this))._platformIdentifier=pe(),r._platformVersion=pe(),!e)throw new TypeError("Argument `options` is not defined.");if(!e.transport)throw new TypeError("No Transport instance provided");if(!e.transport.hasPlugin("dealer"))throw new TypeError("Transport has no Dealer plugin.");return r._transport=e.transport,r._deviceDescriptor=r._initDeviceDescriptor(e),r._logger=new tt({transport:r._transport.toPublic(),sdkId:r.getSDKId(),platform:r._platformIdentifier.promise,clientVersion:r._platformVersion.promise}),r._productStateObserver=Le.A.create({transport:r._transport}),r._onConnected=r._onConnected.bind(m()(r)),r._onAuthenticated=r._onAuthenticated.bind(m()(r)),r._onConnectionError=r._onConnectionError.bind(m()(r)),r._onAuthenticationError=r._onAuthenticationError.bind(m()(r)),r._onShortSessionDisconnect=r._onShortSessionDisconnect.bind(m()(r)),r._attachListeners(),r}return f()(n,[{key:"_createDeviceDescriptor",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((null==r?void 0:r.id)&&!it.test(r.id))throw de.fatal(Q.HARMONY_INVALID_DESCRIPTOR_ID,"Invalid device id.");var i=r.capabilities||{},s={change_volume:null===(t=i.change_volume)||void 0===t||t,endsong_snooping:i.endsong_snooping,enable_play_token:!0,supports_file_media_type:!0,play_token_lost_behavior:e.playTokenLostBehavior||"pause",disable_connect:!!e.hidden,audio_podcasts:null===(n=i.audio_podcasts)||void 0===n||n,video_playback:i.video_playback,lossless_playback:i.lossless_playback,volume_steps:void 0!==i.volume_steps&&i.volume_steps>=0&&i.volume_steps<ae?i.volume_steps:void 0,manifest_formats:[Ye.FILE_URLS_MP3]},o=Qe.create(Object.assign(Object.assign({},r),{capabilities:s}));return this._platformIdentifier.resolve(o.getPlatformIdentifier()),this._platformVersion.resolve(o.getPlatformVersion()),this.proxyEmit(o,"descriptor_changed","descriptor_changed"),o}},{key:"_initDeviceDescriptor",value:function(e){var t=this;return Promise.resolve(e.descriptor).then(this._createDeviceDescriptor.bind(this,e)).catch((function(e){return t._onError(ie.HARMONY,{error:e}),Promise.reject(e)}))}},{key:"_attachListeners",value:function(){var e=this,t=this._transport;t.on(J.TransportEvent.CONNECTED,this._onConnected),t.on(J.TransportEvent.AUTHENTICATED,this._onAuthenticated),t.on(J.TransportEvent.CONNECTION_FAILED,this._onConnectionError),t.on(J.TransportEvent.AUTHENTICATION_FAILED,this._onAuthenticationError),this.proxyEmit(t,J.TransportEvent.RECONNECTING,"reconnecting"),this.proxyEmit(t,J.TransportEvent.RECONNECTED,"reconnected"),this.proxyEmit(t,J.TransportEvent.LOGGED_OUT,"logged_out"),this.proxyEmitSync(t,J.TransportEvent.BEFORE_OFFLINE_DISCONNECT,"before_offline_disconnect"),this.proxyEmitSync(t,J.TransportEvent.BEFORE_ONLINE_DISCONNECT,"before_disconnect"),t.on(J.TransportEvent.SHORT_SESSION_DISCONNECTED,this._onShortSessionDisconnect.bind(this)),this.proxyEmit(this._productStateObserver,J.TransportEvent.PRODUCT_STATE_CHANGED,"product_state_changed"),this.on("before_disconnect",(function(t){var n=e._productStateObserver.deregister().catch((function(){}));t.data.awaitPromise(n)}))}},{key:"_onError",value:function(e,t){this.emit("error",{source:e,error:t.error}),t.error&&t.error.unrecoverable&&this.emit("unrecoverable_failure",{source:e,error:t.error})}},{key:"_onConnected",value:function(){this.emit("connected",null)}},{key:"_onAuthenticated",value:function(){this.emit("authenticated",null)}},{key:"_onConnectionError",value:function(e){this._onError(ie.TRANSPORT,{error:e.data.error}),this.emit("connection_error",e.data)}},{key:"_onAuthenticationError",value:function(e){this._onError(ie.TRANSPORT,{error:e.data.error}),this.emit("authentication_error",e.data)}},{key:"_onShortSessionDisconnect",value:function(e){this._logger.logClientEvent({source:"transport",source_version:Xe.tagged,source_vendor:"spotify",event:e.type,event_version:"1.0.0",json_data:{disconnectCount:e.data.disconnectCount,sessionLength:e.data.sessionLength}},"object").catch((function(t){return rt.warn("".concat(e.type," Logging Error:"),t)}))}},{key:"getVersionDescriptor",value:function(){return Object.assign({},Xe)}},{key:"getSDKId",value:function(){return"harmony:".concat(Xe.tagged)}},{key:"getUntaggedSDKId",value:function(){return"harmony:".concat(Xe.version)}},{key:"getPlatformIdentifier",value:function(){return this._platformIdentifier.promise}},{key:"getPlatformVersion",value:function(){return this._platformVersion.promise}},{key:"getLogger",value:function(){return this._logger}},{key:"logAppMetrics",value:function(e,t){if(!this._logger)throw new TypeError("Invalid logger instance");return this._logger.logMetrics(e,t)}},{key:"request",value:function(e,t){return this._transport.request(e,t)}},{key:"getPublicTransport",value:function(){return this._transport.toPublic()}},{key:"getClientDescriptor",value:function(){return this._deviceDescriptor.then((function(e){return e.toJSON()}))}},{key:"getDeviceDescriptor",value:function(){return this._deviceDescriptor}},{key:"getUserInfo",value:function(){return this._transport.request("@webapi/v1/me",{responseType:"json"}).then((function(e){var t=e.body;if(200!==e.status){var n=new de(Q.USER_INFO_REQUEST_FAILED_WITH_STATUS,"User info request failed with status ".concat(e.status));return n.status=e.status,Promise.reject(n)}return t?{display_name:t.display_name,followers:t.followers,id:t.id,images:t.images,uri:t.uri}:Promise.reject(new de(Q.USER_INFO_REQUEST_EMPTY_RESPONSE,"Unexpected empty response."))}))}},{key:"getProductState",value:function(){return this._productStateObserver.getCurrentState()}},{key:"setName",value:function(e){return this._deviceDescriptor.then((function(t){return t.setName(e)}))}},{key:"setNameTemplate",value:function(e){return this.setName(je(e))}},{key:"setCapability",value:function(e,t){return this._deviceDescriptor.then((function(n){return n.setCapability(e,t)}))}},{key:"notifyError",value:function(e,t){this._onError(e,{error:t})}}],[{key:"create",value:function(e){return new n(e)}},{key:"of",value:function(e){return e._client}}]),n}(ne.vp);var ot,at=n(9368);n(7061);!function(e){e[e.NONE=0]="NONE",e[e.LOG=1]="LOG",e[e.DEBUG=2]="DEBUG",e[e.INFO=4]="INFO",e[e.WARN=8]="WARN",e[e.ERROR=16]="ERROR"}(ot||(ot={}));var ct,lt=n(7061);const ut="true"===(null===(ct=null==lt?void 0:{NODE_ENV:"production",DEBUG_EVENT_SENDER:!1,DEBUG_SEMANTIC_METRICS:void 0,CDN_FILE_URLS:'{"fonts/CircularSpUIAraOnly-Black.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Black.6d6a4c25.otf","fonts/CircularSpUIAraOnly-Black.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Black.05b31ded.woff","fonts/CircularSpUIAraOnly-Black.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Black.c32951f4.woff2","fonts/CircularSpUIAraOnly-Bold.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Bold.f97cb921.otf","fonts/CircularSpUIAraOnly-Bold.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Bold.9ddc7126.woff","fonts/CircularSpUIAraOnly-Bold.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Bold.317e96e5.woff2","fonts/CircularSpUIAraOnly-Book.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Book.f0effcd1.otf","fonts/CircularSpUIAraOnly-Book.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Book.3ad862e2.woff","fonts/CircularSpUIAraOnly-Book.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Book.aaab109b.woff2","fonts/CircularSpUIAraOnly-Light.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Light.f0833f3b.otf","fonts/CircularSpUIAraOnly-Light.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Light.5c7ed8d8.woff","fonts/CircularSpUIAraOnly-Light.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Light.dde45e52.woff2","fonts/CircularSpUICyrOnly-Black.otf":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Black.50cd1ca9.otf","fonts/CircularSpUICyrOnly-Black.woff":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Black.7536a73f.woff","fonts/CircularSpUICyrOnly-Black.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Black.f5526fc4.woff2","fonts/CircularSpUICyrOnly-Bold.otf":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Bold.67641b90.otf","fonts/CircularSpUICyrOnly-Bold.woff":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Bold.909126fc.woff","fonts/CircularSpUICyrOnly-Bold.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Bold.30dc9fb2.woff2","fonts/CircularSpUICyrOnly-Book.otf":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Book.15af6ebe.otf","fonts/CircularSpUICyrOnly-Book.woff":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Book.918c53b8.woff","fonts/CircularSpUICyrOnly-Book.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Book.6a858994.woff2","fonts/CircularSpUICyrOnly-Light.otf":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Light.b10eb959.otf","fonts/CircularSpUICyrOnly-Light.woff":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Light.034997d0.woff","fonts/CircularSpUICyrOnly-Light.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Light.55fa9f4a.woff2","fonts/CircularSpUIHbrOnly-Black.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Black.11abebe4.otf","fonts/CircularSpUIHbrOnly-Black.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Black.0a11e734.woff","fonts/CircularSpUIHbrOnly-Black.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Black.217fb21f.woff2","fonts/CircularSpUIHbrOnly-Bold.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Bold.57b36278.otf","fonts/CircularSpUIHbrOnly-Bold.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Bold.9f406804.woff","fonts/CircularSpUIHbrOnly-Bold.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Bold.ef043f44.woff2","fonts/CircularSpUIHbrOnly-Book.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Book.fae4aece.otf","fonts/CircularSpUIHbrOnly-Book.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Book.ad2b13cd.woff","fonts/CircularSpUIHbrOnly-Book.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Book.cb36b6ec.woff2","fonts/CircularSpUIHbrOnly-Light.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Light.2e1df62a.otf","fonts/CircularSpUIHbrOnly-Light.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Light.2128eeac.woff","fonts/CircularSpUIHbrOnly-Light.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Light.4884da16.woff2","fonts/CircularSpUIv3T-Black.ttf":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Black.ce8ef887.ttf","fonts/CircularSpUIv3T-Black.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Black.effa986f.woff","fonts/CircularSpUIv3T-Black.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Black.c21e63c5.woff2","fonts/CircularSpUIv3T-Bold.ttf":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Bold.7eb7d0f7.ttf","fonts/CircularSpUIv3T-Bold.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Bold.10e93738.woff","fonts/CircularSpUIv3T-Bold.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Bold.8d0a45cc.woff2","fonts/CircularSpUIv3T-Book.ttf":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Book.a357677a.ttf","fonts/CircularSpUIv3T-Book.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Book.ea8d19db.woff","fonts/CircularSpUIv3T-Book.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Book.3466e0ec.woff2","fonts/CircularSpUIv3T-Light.ttf":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Light.89e4be2e.ttf","fonts/CircularSpUIv3T-Light.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Light.2a78c017.woff","fonts/CircularSpUIv3T-Light.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Light.afd9ab26.woff2","fonts/spoticon_regular_2.ttf":"https://open.scdn.co/cdn/fonts/spoticon_regular_2.127670b5.ttf","fonts/spoticon_regular_2.woff":"https://open.scdn.co/cdn/fonts/spoticon_regular_2.ff4c6091.woff","fonts/spoticon_regular_2.woff2":"https://open.scdn.co/cdn/fonts/spoticon_regular_2.d319d911.woff2","generated/manifest-mobile-web-player.json":"https://open.scdn.co/cdn/generated/manifest-mobile-web-player.2aef628f.json","generated/manifest-web-player.json":"https://open.scdn.co/cdn/generated/manifest-web-player.038c3337.json","generated/opensearch.xml":"https://open.scdn.co/cdn/generated/opensearch.abfbfc66.xml","images/checkmark.png":"https://open.scdn.co/cdn/images/checkmark.389faa13.png","images/concert-hub-fb-card.png":"https://open.scdn.co/cdn/images/concert-hub-fb-card.5072379c.png","images/concert-hub-header.png":"https://open.scdn.co/cdn/images/concert-hub-header.56bcad9b.png","images/concert-hub-iphone-de.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-de.b6f99e33.png","images/concert-hub-iphone-el.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-el.5672149c.png","images/concert-hub-iphone-en.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-en.6eda306a.png","images/concert-hub-iphone-es_419.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-es_419.cefd672a.png","images/concert-hub-iphone-es.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-es.cefd672a.png","images/concert-hub-iphone-fi.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-fi.52e8d625.png","images/concert-hub-iphone-fr_CA.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-fr_CA.93b897cb.png","images/concert-hub-iphone-fr.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-fr.336e7db1.png","images/concert-hub-iphone-hu.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-hu.5eba9191.png","images/concert-hub-iphone-id.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-id.87ecf560.png","images/concert-hub-iphone-it.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-it.18450a29.png","images/concert-hub-iphone-ja.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-ja.6eda306a.png","images/concert-hub-iphone-ms.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-ms.83140310.png","images/concert-hub-iphone-nl.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-nl.cb3a5038.png","images/concert-hub-iphone-pl.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-pl.45abd89b.png","images/concert-hub-iphone-pt_BR.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-pt_BR.e932ef02.png","images/concert-hub-iphone-sv.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-sv.5e512289.png","images/concert-hub-iphone-tr.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-tr.a017f03c.png","images/concert-hub-iphone-zh_TW.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-zh_TW.6eda306a.png","images/concert-hub-twitter-card.png":"https://open.scdn.co/cdn/images/concert-hub-twitter-card.71f6a06d.png","images/connect_header@1x.png":"https://open.scdn.co/cdn/images/connect_header@1x.ecc6912d.png","images/connect-to-devices-white.svg":"https://open.scdn.co/cdn/images/connect-to-devices-white.69d4229a.svg","images/desktop-auth-check.svg":"https://open.scdn.co/cdn/images/desktop-auth-check.65be3bbc.svg","images/desktop-auth-error.svg":"https://open.scdn.co/cdn/images/desktop-auth-error.b82f823b.svg","images/devices/android.png":"https://open.scdn.co/cdn/images/devices/android.460a5815.png","images/devices/ios.png":"https://open.scdn.co/cdn/images/devices/ios.535e1468.png","images/devices/mac-web.png":"https://open.scdn.co/cdn/images/devices/mac-web.71c1af1f.png","images/devices/mac.png":"https://open.scdn.co/cdn/images/devices/mac.80dcea83.png","images/devices/windowsphone.png":"https://open.scdn.co/cdn/images/devices/windowsphone.350c5a17.png","images/embed-podcast/upsell-background.png":"https://open.scdn.co/cdn/images/embed-podcast/upsell-background.00c81565.png","images/embed/copy-32_circle_grey_outline_bg.svg":"https://open.scdn.co/cdn/images/embed/copy-32_circle_grey_outline_bg.0c6130eb.svg","images/embed/embed-code-32_circle_grey_outline_bg.svg":"https://open.scdn.co/cdn/images/embed/embed-code-32_circle_grey_outline_bg.b40a255f.svg","images/embed/fb_colour.svg":"https://open.scdn.co/cdn/images/embed/fb_colour.13fa515f.svg","images/embed/messenger_colour.svg":"https://open.scdn.co/cdn/images/embed/messenger_colour.8f4836ec.svg","images/embed/twitter_colour.svg":"https://open.scdn.co/cdn/images/embed/twitter_colour.456d46db.svg","images/embed/whatsapp.svg":"https://open.scdn.co/cdn/images/embed/whatsapp.e33bfab4.svg","images/emi.png":"https://open.scdn.co/cdn/images/emi.c7e51c1a.png","images/employee-podcasts-modal-art.png":"https://open.scdn.co/cdn/images/employee-podcasts-modal-art.956e5f5e.png","images/equaliser-animated-green.gif":"https://open.scdn.co/cdn/images/equaliser-animated-green.73b73928.gif","images/equaliser-green.svg":"https://open.scdn.co/cdn/images/equaliser-green.1184ed87.svg","images/favicon.ico":"https://open.scdn.co/cdn/images/favicon.5cb2bd30.ico","images/favicon.png":"https://open.scdn.co/cdn/images/favicon.0c211e2e.png","images/favicon16.png":"https://open.scdn.co/cdn/images/favicon16.19fc3918.png","images/favicon32.png":"https://open.scdn.co/cdn/images/favicon32.a19b4f5b.png","images/focused_stroy_play.png":"https://open.scdn.co/cdn/images/focused_stroy_play.c908b733.png","images/follow/avatar-placeholder.png":"https://open.scdn.co/cdn/images/follow/avatar-placeholder.2f817d4a.png","images/follow/sprite.gif":"https://open.scdn.co/cdn/images/follow/sprite.e282a709.gif","images/follow/sprite@1.png":"https://open.scdn.co/cdn/images/follow/sprite@1.b994540b.png","images/hifi-button-off.svg":"https://open.scdn.co/cdn/images/hifi-button-off.87461500.svg","images/hifi-button-on.svg":"https://open.scdn.co/cdn/images/hifi-button-on.48a2de90.svg","images/hifi.svg":"https://open.scdn.co/cdn/images/hifi.0526a5b1.svg","images/home-icon.svg":"https://open.scdn.co/cdn/images/home-icon.ba66757a.svg","images/icons/Spotify_1024.png":"https://open.scdn.co/cdn/images/icons/Spotify_1024.d6467a14.png","images/icons/Spotify_128.png":"https://open.scdn.co/cdn/images/icons/Spotify_128.c9ce2f2e.png","images/icons/Spotify_16.png":"https://open.scdn.co/cdn/images/icons/Spotify_16.aa3775a0.png","images/icons/Spotify_256.png":"https://open.scdn.co/cdn/images/icons/Spotify_256.c8416b60.png","images/icons/Spotify_32.png":"https://open.scdn.co/cdn/images/icons/Spotify_32.492cdebf.png","images/icons/Spotify_512.png":"https://open.scdn.co/cdn/images/icons/Spotify_512.49a0bf03.png","images/icons/Spotify_64.png":"https://open.scdn.co/cdn/images/icons/Spotify_64.47bcd979.png","images/icons/Spotify_MWP_192.png":"https://open.scdn.co/cdn/images/icons/Spotify_MWP_192.c70b9055.png","images/icons/Spotify_MWP_512.png":"https://open.scdn.co/cdn/images/icons/Spotify_MWP_512.591cfa88.png","images/improved-modal-bg.jpg":"https://open.scdn.co/cdn/images/improved-modal-bg.23e5dcb1.jpg","images/login-background.jpg":"https://open.scdn.co/cdn/images/login-background.078204fe.jpg","images/login-signup-burst.svg":"https://open.scdn.co/cdn/images/login-signup-burst.5f6a6521.svg","images/logo-complete-black.svg":"https://open.scdn.co/cdn/images/logo-complete-black.573d8227.svg","images/logo-white-2x.png":"https://open.scdn.co/cdn/images/logo-white-2x.ef36ed81.png","images/merlin.png":"https://open.scdn.co/cdn/images/merlin.cd7e72d1.png","images/mid-year.png":"https://open.scdn.co/cdn/images/mid-year.9e2ead8f.png","images/moviebuff.png":"https://open.scdn.co/cdn/images/moviebuff.65e80213.png","images/og-image.png":"https://open.scdn.co/cdn/images/og-image.64b84348.png","images/orchard.png":"https://open.scdn.co/cdn/images/orchard.677c5ae0.png","images/rovi.png":"https://open.scdn.co/cdn/images/rovi.7b503678.png","images/s2l-desktopui-ltr.png":"https://open.scdn.co/cdn/images/s2l-desktopui-ltr.3024b050.png","images/s2l-desktopui-rtl.png":"https://open.scdn.co/cdn/images/s2l-desktopui-rtl.a9690daf.png","images/s2l-mobileui.png":"https://open.scdn.co/cdn/images/s2l-mobileui.9fc9d151.png","images/sony.png":"https://open.scdn.co/cdn/images/sony.7e5692e6.png","images/spotifylogo.svg":"https://open.scdn.co/cdn/images/spotifylogo.a884cca3.svg","images/station-header-wave.svg":"https://open.scdn.co/cdn/images/station-header-wave.0f3784ea.svg","images/station-wave.svg":"https://open.scdn.co/cdn/images/station-wave.2b7b882c.svg","images/sw_saber_ahsoka1.png":"https://open.scdn.co/cdn/images/sw_saber_ahsoka1.5495e812.png","images/sw_saber_anakin.png":"https://open.scdn.co/cdn/images/sw_saber_anakin.a7ba22d2.png","images/sw_saber_leia.png":"https://open.scdn.co/cdn/images/sw_saber_leia.1146243b.png","images/sw_saber_luke.png":"https://open.scdn.co/cdn/images/sw_saber_luke.e4e10033.png","images/sw_saber_mace.png":"https://open.scdn.co/cdn/images/sw_saber_mace.1ba83c7d.png","images/sw_saber_rey.png":"https://open.scdn.co/cdn/images/sw_saber_rey.994789b5.png","images/sw_saber_vader.png":"https://open.scdn.co/cdn/images/sw_saber_vader.070f862b.png","images/touch-icon-114.png":"https://open.scdn.co/cdn/images/touch-icon-114.0d424df2.png","images/touch-icon-144.png":"https://open.scdn.co/cdn/images/touch-icon-144.36faaf96.png","images/touch-icon-57.png":"https://open.scdn.co/cdn/images/touch-icon-57.5460f415.png","images/touch-icon-72.png":"https://open.scdn.co/cdn/images/touch-icon-72.cffecbdb.png","images/tracklist-placeholder.png":"https://open.scdn.co/cdn/images/tracklist-placeholder.59aa68d8.png","images/tracklist-row-episode-fallback.svg":"https://open.scdn.co/cdn/images/tracklist-row-episode-fallback.e8ae3577.svg","images/tracklist-row-song-fallback.svg":"https://open.scdn.co/cdn/images/tracklist-row-song-fallback.4db3ccfe.svg","images/tracklist-row-video-fallback.svg":"https://open.scdn.co/cdn/images/tracklist-row-video-fallback.954459da.svg","images/universal.png":"https://open.scdn.co/cdn/images/universal.3ceb95fd.png","images/vinyl-bottom-layer.svg":"https://open.scdn.co/cdn/images/vinyl-bottom-layer.82d9f6ef.svg","images/vinyl-top-layer.svg":"https://open.scdn.co/cdn/images/vinyl-top-layer.b56c3ccf.svg","images/warner.png":"https://open.scdn.co/cdn/images/warner.a5039776.png","images/zara-larsson-singles.png":"https://open.scdn.co/cdn/images/zara-larsson-singles.59dbba9e.png","js/fb.js":"https://open.scdn.co/cdn/js/fb.83cf1e53.js","js/gtag.js":"https://open.scdn.co/cdn/js/gtag.343176db.js","js/gtm.js":"https://open.scdn.co/cdn/js/gtm.6d498f08.js","js/retargeting-pixels.js":"https://open.scdn.co/cdn/js/retargeting-pixels.1fa1ceda.js","js/urlRedirect.js":"https://open.scdn.co/cdn/js/urlRedirect.156df566.js","js/urlScheme.js":"https://open.scdn.co/cdn/js/urlScheme.f1e6e8b6.js"}'})||void 0===ct?void 0:ct.DEBUG)?class{constructor(e,t="",n=(()=>!1)){this._tagParts=[],this._tagText="",this._enabled=!0,this._level=ot.NONE,this.tag="",this.description="",this._predicate=function(){return!1},this.tag=e,this.description=t,this._predicate=n,this._tagParts=e.split("."),this._tagText=`[${e}]`}_print(e,t,n){if(!(this._enabled||this._level&t))return;const r={args:n,type:e,tag:this.tag};this._predicate(r)}matchesTag(e){const t=Array.isArray(e)?e:e.split("."),n=this._tagParts;if(t.length>n.length)return!1;for(let r=0,i=t.length;r<i;r++)if(("*"!==t[r]||!n[r])&&t[r]!==n[r])return!1;return!0}setLevel(e){let t=0;switch(e){case"error":t=ot.ERROR;break;case"warn":t=ot.WARN|ot.ERROR;break;case"info":t=ot.INFO|ot.WARN|ot.ERROR;break;case"debug":t=ot.DEBUG|ot.INFO|ot.WARN|ot.ERROR;break;case"log":default:t=ot.LOG|ot.DEBUG|ot.INFO|ot.WARN|ot.ERROR}this._level=t}enable(){this._enabled=!0}disable(){this._enabled=!1}log(...e){this._print("log",ot.LOG,e)}debug(...e){this._print("debug",ot.DEBUG,e)}info(...e){this._print("info",ot.INFO,e)}warn(...e){this._print("warn",ot.WARN,e)}error(...e){this._print("error",ot.ERROR,e)}}:class{constructor(){this.tag="",this.description=""}matchesTag(){return!1}setLevel(){}enable(){}disable(){}log(){}debug(){}info(){}warn(){}error(){}},dt="__dbgLoggerRegistry";let pt=n.g.__dbgLoggerRegistry;pt||(pt={map:{},list:[],loggingPredicate:function(){}},Object.defineProperty?Object.defineProperty(n.g,dt,{value:pt}):n.g.__dbgLoggerRegistry=pt);const ht=pt.map,_t=pt.list;function ft(e){return!(!pt.loggingPredicate||!pt.loggingPredicate(e))}let gt="log";function mt(e,t){let n,r;if("string"==typeof e?(n=e.toLowerCase(),r=t):(n=e.tag,r=e.description),ht.hasOwnProperty(n)&&ht[n])return ht[n];const i=new ut(n,r,ft);return i.setLevel(gt),ht[n]=i,_t.push(i),i}var yt,vt,Et,St,bt;!function(e){e.KEY_SESSION_MESSAGE="message",e.KEY_SESSION_STATUSES_CHANGE="keystatuseschange",e.MEDIA_SOURCE_OPEN="sourceopen",e.MEDIA_SOURCE_CLOSE="sourceclose",e.SOURCE_BUFFER_UPDATE_END="updateend",e.MS_KEY_ADDED="mskeyadded",e.MS_KEY_ERROR="mskeyerror",e.MS_KEY_MESSAGE="mskeymessage",e.MS_NEEDKEY="msneedkey",e.WEBKIT_KEY_ADDED="webkitkeyadded",e.WEBKIT_KEY_ERROR="webkitkeyerror",e.WEBKIT_KEY_MESSAGE="webkitkeymessage",e.WEBKIT_NEEDKEY="webkitneedkey",e.V0_1B_KEY_ADDED="keyadded",e.V0_1B_KEY_ERROR="keyerror",e.V0_1B_KEY_MESSAGE="keymessage",e.V0_1B_NEEDKEY="needkey",e.MEDIA_CANPLAY="canplay",e.MEDIA_CANPLAYTHROUGH="canplaythrough",e.MEDIA_DURATIONCHANGE="durationchange",e.MEDIA_ENCRYPTED="encrypted",e.MEDIA_ENDED="ended",e.MEDIA_ERROR="error",e.MEDIA_LOADEDMETADATA="loadedmetadata",e.MEDIA_PAUSE="pause",e.MEDIA_PLAYING="playing",e.MEDIA_SEEKING="seeking",e.MEDIA_TIMEUPDATE="timeupdate",e.MEDIA_WAITING="waiting",e.INTERNAL_ENCRYPTED="__encrypted",e.INTERNAL_PLAYER_CANPLAY="__canplay",e.INTERNAL_PLAYER_CANPLAYTHROUGH="__canplaythrough",e.INTERNAL_MEDIA_REQUIRES_DURATION="__requiresduration",e.INTERNAL_PLAYER_LOADED_METADATA="__loadedmetadata",e.BUFFER_APPEND_ERROR="append_error",e.BUFFER_QUOTA_EXCEEDED="quota_exceeded",e.BUFFER_STALLED="stalled",e.BUFFER_SOURCE_OPEN="source_open",e.BUFFER_SOURCE_CLOSE="source_close",e.BUFFERING_START="buffering_start",e.BUFFERING_END="buffering_end",e.EME_LICENSE_REQUEST_ERROR="license_request_error",e.EME_LICENSE_REQUEST_CAPPED="license_request_capped",e.LIST_PLAYER_AUTOPLAY_FAILED="player_autoplay_failed",e.LIST_PLAYER_BEFORE_LIST_CHANGE="before_list_change",e.LIST_PLAYER_BEFORE_NEXT="before_next",e.LIST_PLAYER_BEFORE_PLAYER_LOAD="before_player_load",e.LIST_PLAYER_BEFORE_PREVIOUS="before_previous",e.LIST_PLAYER_BEFORE_TRACK_LOAD="before_track_load",e.LIST_PLAYER_BEFORE_VOLUME_CHANGE="before_volume_change",e.LIST_PLAYER_BUFFER_STALLED="stalled",e.LIST_PLAYER_BUFFERING_START="buffering_start",e.LIST_PLAYER_BUFFERING_END="buffering_end",e.LIST_PLAYER_CAPPED="capped",e.LIST_PLAYER_CLEARED="cleared",e.LIST_PLAYER_DURATION_CHANGED="duration_changed",e.LIST_PLAYER_ERROR="error",e.LIST_PLAYER_ERROR_SYNC="error_sync",e.LIST_PLAYER_LIST_CHANGED="list_change",e.LIST_PLAYER_LIST_ENDED="list_ended",e.LIST_PLAYER_LOAD_VIDEO="load_video",e.LIST_PLAYER_MAX_LIST_ERRORS_REACHED="max_list_errors_reached",e.LIST_PLAYER_PAUSED="paused",e.LIST_PLAYER_PLAYED_THRESHOLD_REACHED="played_threshold_reached",e.LIST_PLAYER_PLAYER_LOAD="player_load",e.LIST_PLAYER_PLAYING="playing",e.LIST_PLAYER_POSITION_CHANGED="position_changed",e.LIST_PLAYER_PROGRESS="progress",e.LIST_PLAYER_REPEAT_MODE_CHANGED="repeat_mode_changed",e.LIST_PLAYER_SHUFFLE_CHANGED="shuffle_changed",e.LIST_PLAYER_STOPPED="stopped",e.LIST_PLAYER_STOPPED_VIDEO="stopped_video",e.LIST_PLAYER_TRACKING_DATA_CREATED="tracking_data_created",e.LIST_PLAYER_TRACKING_DATA_FINALIZED="tracking_data_finalized",e.LIST_PLAYER_TRACK_ENDED="track_ended",e.LIST_PLAYER_TRACK_LOADED="track_loaded",e.LIST_PLAYER_TRACK_TIMEOUT="track_timeout",e.LIST_PLAYER_TRACK_UNPLAYABLE="track_unplayable",e.LIST_PLAYER_DATA_CREATED="tracking_data_created",e.LIST_PLAYER_DATA_FINALIZED="tracking_data_finalized",e.LIST_PLAYER_VOLUME_CHANGED="volume_changed",e.LIST_PLAYER_VIDEO_ELEMENT_APPENDED="video_element_appended",e.LIST_PLAYER_VIDEO_ELEMENT_REMOVED="video_element_removed",e.LOGGER_ERROR="error",e.PLAYER_AUTOPLAY_FAILED="player_autoplay_failed",e.PLAYER_BEFORE_LOAD="before_load",e.PLAYER_BEFORE_STOP="before_stop",e.PLAYER_BEFORE_VOLUME_CHANGE="before_volume_change",e.PLAYER_BUFFER_STALLED="stalled",e.PLAYER_BUFFERING_START="buffering_start",e.PLAYER_BUFFERING_END="buffering_end",e.PLAYER_CAN_PRELOAD="can_preload",e.PLAYER_CAPPED="capped",e.PLAYER_DURATION_CHANGED="duration_changed",e.PLAYER_ENDED="ended",e.PLAYER_ENDED_VIDEO="ended_video",e.PLAYER_ERROR="error",e.PLAYER_WARNING="warning",e.PLAYER_FIRST_BYTES="first_bytes",e.PLAYER_KEY_RECEIVED="key",e.PLAYER_LOAD="load",e.PLAYER_LOAD_VIDEO="load_video",e.PLAYER_LOADING_FAILED="loading_failed",e.PLAYER_PAUSED="paused",e.PLAYER_PLAYING="playing",e.PLAYER_POSITION_CHANGED="position_changed",e.PLAYER_PRELOADING_ERROR="preloading_error",e.PLAYER_PROGRESS="progress",e.PLAYER_STALLED="stalled",e.PLAYER_STOPPED="stopped",e.PLAYER_STOPPED_VIDEO="stopped_video",e.PLAYER_PLAYED_THRESHOLD_REACHED="played_threshold_reached",e.PLAYER_TIMEOUT="timeout",e.PLAYER_PLAYBACK_START="playback_start",e.PLAYER_TRACKING_DATA_CREATED="tracking_data_created",e.PLAYER_TRACKING_DATA_FINALIZED="tracking_data_finalized",e.PLAYER_VIDEO_ELEMENT_APPENDED="video_element_appended",e.PLAYER_VIDEO_ELEMENT_REMOVED="video_element_removed",e.PLAYER_MANAGER_READY="ready",e.TRACKER_PLAYBACK_START="playback_start",e.TRACKER_PLAYED_THRESHOLD_REACHED="played_threshold_reached",e.TRACKER_TRACKING_DATA_CREATED="tracking_data_created",e.TRACKER_TRACKING_DATA_FINALIZED="tracking_data_finalized",e.ABR_MANAGER_BITRATE_CHANGE="bitrate_change"}(yt||(yt={})),function(e){e.WIDEVINE="com.widevine.alpha",e.PLAYREADY="com.microsoft.playready",e.PLAYREADY_HARDWARE="com.microsoft.playready.hardware",e.FAIRPLAY="com.apple.fps.1_0",e.INVALID_SPOTIFY_KEY="com.spotify.invalid"}(vt||(vt={})),function(e){e.SHOWING="showing",e.HIDDEN="hidden"}(Et||(Et={})),function(e){e.SUCCESS="RESULT_SUCCESS",e.INVALID="RESULT_INVALID",e.FORBIDDEN="RESULT_FORBIDDEN",e.OUT_OF_BOUNDS="RESULT_OUT_OF_BOUNDS",e.NO_LIST="RESULT_NO_LIST",e.NO_TRACK="RESULT_NO_TRACK",e.LIST_END="RESULT_LIST_END",e.INVALID_TRACK="RESULT_INVALID_TRACK",e.CANCELLED="CANCELLED",e.NO_TRACK_PLAYER="NO_TRACK_PLAYER"}(St||(St={})),function(e){e.MP3="MP3",e.MP4="MP4",e.MP4_DUAL="MP4_DUAL",e.MP4_CBCS="MP4_CBCS",e.MP4_FLAC="MP4_FLAC",e.MANIFEST_ID="MANIFEST_ID"}(bt||(bt={}));class Tt extends Error{constructor(e,t){super(t),this.unrecoverable=!1,this.listPlayerIgnore=!1,this.debug={},this.code=e,this.message=t,this.name="PlaybackError"}static fatal(e,t){const n=new Tt(e,t);return n.unrecoverable=!0,n}}class Ct extends Error{constructor(e=H.EME_ERROR_UNKNOWN,t){super(t),this.status=-1,this.licenseServer="",this.shouldRefreshEndpoint=!1,this.unrecoverable=!1,this.debug={},this.code=e,this.message=t,this.name="EMEError"}static fatal(e=H.EME_ERROR_UNKNOWN,t){const n=new Ct(e,t);return n.unrecoverable=!0,n}}class It extends Error{constructor(e,t){super(t),this.name="CappingError",this.message=t,this.code=e}}function Rt(){let e,t;return{promise:new Promise(((n,r)=>{e=n,t=r})),resolve:e,reject:t}}function Pt(e){const t=document.createEvent("Event");t.initEvent("encrypted",!1,!1),t.initDataType="cenc",t.initData=e.initData,t.fromPolyfill=!0,this.dispatchEvent(t)}class At extends ne.B{constructor(e){super(yt.KEY_SESSION_MESSAGE,null),this.messageType="license-request",this.message=e}}class Ot extends ne.vp{constructor(e){super(),this._nativeKeySession=null,this._lastUpdateDeferred=Rt(),this._lastGenerateDeferred=Rt(),this.addEventListener=this.addListener,this.removeEventListener=this.removeListener,this._nativeMediaKeys=e,this._onKeyMessage=this._onKeyMessage.bind(this),this._onKeyAdded=this._onKeyAdded.bind(this),this._onKeyError=this._onKeyError.bind(this)}_attach(){const e=this._nativeKeySession;e&&(e.addEventListener(yt.MS_KEY_ADDED,this._onKeyAdded),e.addEventListener(yt.MS_KEY_ERROR,this._onKeyError),e.addEventListener(yt.MS_KEY_MESSAGE,this._onKeyMessage))}_detach(){const e=this._nativeKeySession;e&&(e.removeEventListener(yt.MS_KEY_ADDED,this._onKeyAdded),e.removeEventListener(yt.MS_KEY_ERROR,this._onKeyError),e.removeEventListener(yt.MS_KEY_MESSAGE,this._onKeyMessage))}_onKeyMessage(e){e.message&&e.message.buffer&&(this.emitEvent(new At(e.message.buffer)),this._lastGenerateDeferred&&(this._lastGenerateDeferred.resolve(!0),this._lastGenerateDeferred=null))}_onKeyAdded(){this._lastUpdateDeferred&&(this._lastUpdateDeferred.resolve(!0),this._lastUpdateDeferred=null),this._lastGenerateDeferred&&(this._lastGenerateDeferred.resolve(!0),this._lastGenerateDeferred=null),this.emit(yt.KEY_SESSION_STATUSES_CHANGE,null)}_onKeyError(){const e=this._nativeKeySession&&this._nativeKeySession.error;this._lastGenerateDeferred&&(this._lastGenerateDeferred.reject(e),this._lastGenerateDeferred=null),this._lastUpdateDeferred&&(this._lastUpdateDeferred.reject(e),this._lastUpdateDeferred=null),this.emit(yt.KEY_SESSION_STATUSES_CHANGE,null)}generateRequest(e,t){return new Promise(((e,n)=>{this._lastGenerateDeferred&&(this._lastGenerateDeferred.resolve=e,this._lastGenerateDeferred.reject=n),this._nativeKeySession=this._nativeMediaKeys.createSession("audio/mp4",new Uint8Array(t),null),this._attach()}))}update(e){return new Promise(((t,n)=>{this._lastGenerateDeferred&&(this._lastGenerateDeferred.resolve=t,this._lastGenerateDeferred.reject=n),this._nativeKeySession&&this._nativeKeySession.update(new Uint8Array(e))}))}close(){return new Promise((e=>{this._nativeKeySession&&this._nativeKeySession.close(),this._detach(),e(!0)}))}}class kt{constructor(e){this._lastBoundSetter=null,this.shouldRefreshPerTrack=!0,this._nativeMediaKeys=new MSMediaKeys(e)}attach(e){return new Promise((t=>{if(e.readyState>=1)return e.msSetMediaKeys(this._nativeMediaKeys),void t();const n=()=>{e.removeEventListener(yt.MEDIA_LOADEDMETADATA,n),this._lastBoundSetter=null,e.msSetMediaKeys(this._nativeMediaKeys)};this._lastBoundSetter=n,e.addEventListener(yt.MEDIA_LOADEDMETADATA,n),e.addEventListener(yt.MS_NEEDKEY,Pt),t()}))}detach(e){this._lastBoundSetter&&(e.removeEventListener(yt.MS_NEEDKEY,Pt),e.removeEventListener(yt.MEDIA_LOADEDMETADATA,this._lastBoundSetter),this._lastBoundSetter=null)}setServerCertificate(){return Promise.reject(new Ct(H.EME_CANNOT_SET_CERTIFICATE_FOR_PLATFORM,"Cannot set server certificate on this platform."))}createSession(){return new Ot(this._nativeMediaKeys)}}function Lt(e){const t=this.mediaKeys;return t&&t!==e&&t.detach(this),delete this.mediaKeys,this.mediaKeys=e,e&&e.attach(this),Promise.resolve()}class wt{constructor(e,t){if(this._configuration=null,this.keySystem=e,!this._checkConfig(t))throw new Ct(H.EME_NO_SUPPORTED_CONFIGURATION,"No supported configurations")}_checkConfig(e){const t=this.keySystem;for(let n=0,r=e.length;n<r;n++){const r=e[n],i={initDataTypes:r.initDataTypes,audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",sessionTypes:["temporary"],label:r.label};let s,o,a,c,l;if(r.audioCapabilities&&r.audioCapabilities.length&&i.audioCapabilities)for(l=!1,s=0,o=r.audioCapabilities.length;s<o;s++)a=r.audioCapabilities[s],a.contentType&&(c=a.contentType.split(";")[0]),MSMediaKeys.isTypeSupported(t,c)&&(i.audioCapabilities.push(a),l=!0);if(r.videoCapabilities&&r.videoCapabilities.length&&i.videoCapabilities)for(l=!1,s=0,o=r.videoCapabilities.length;s<o;s++)a=r.videoCapabilities[s],a.contentType&&(c=a.contentType.split(";")[0]),MSMediaKeys.isTypeSupported(t,c)&&(i.videoCapabilities.push(a),l=!0);if(l)return this._configuration=i,!0}return!1}getConfiguration(){return this._configuration}createMediaKeys(){return new Promise((e=>{e(new kt(this.keySystem))}))}}const Dt=mt("eme_polyfill.v0_1b");class Nt extends ne.vp{constructor(e,t,n){super(),this._mediaElement=null,this._lastUpdateDeferred=null,this._lastGenerateResolver=null,this.sessionId=null,this._keySystem=e,this._mediaElement=t,this._prefix=n,this.addEventListener=this.addListener,this.removeEventListener=this.removeListener}_addPrefix(e){return this._prefix?this._prefix+e.replace(/\b[a-z]/,(function(e){return e.toUpperCase()})):e}generateComplete(e){this.emitEvent(new At(e)),this._lastGenerateResolver&&(this._lastGenerateResolver.resolve(!0),this._lastGenerateResolver=null)}updateComplete(){this._lastUpdateDeferred&&(this._lastUpdateDeferred.resolve(!0),this._lastUpdateDeferred=null),this.emit(yt.KEY_SESSION_STATUSES_CHANGE,null)}handleErrorEvent(e){const t=new Ct(H.EME_MEDIA_KEY_SESSION_V0_1B_ERROR,"MediaKeySession v0.1b Error");t.debug.errorCode=e.errorCode,t.debug.systemCode=e.systemCode,!e.sessionId&&this._lastGenerateResolver?(this._lastGenerateResolver.reject(t),this._lastGenerateResolver=null):e.sessionId&&this._lastUpdateDeferred?(this._lastUpdateDeferred.reject(t),this._lastUpdateDeferred=null):this.emit(yt.KEY_SESSION_STATUSES_CHANGE,null)}generateRequest(e,t){return this._mediaElement?new Promise(((e,n)=>{this._lastGenerateResolver={resolve:e,reject:n};try{this._mediaElement[this._addPrefix("generateKeyRequest")](this._keySystem,new Uint8Array(t))}catch(r){n(r),this._lastGenerateResolver=null}})):Promise.reject(new ReferenceError("InvalidState: Media keys are not attached."))}update(e){if(!this._mediaElement)return Promise.reject(new ReferenceError("InvalidState: Media keys are not attached."));if(this._lastUpdateDeferred){const t=this.update.bind(this,e);return this._lastUpdateDeferred.promise.then(t,t)}const t=Rt();this._lastUpdateDeferred=t;try{this._mediaElement[this._addPrefix("addKey")](this._keySystem,new Uint8Array(e),null,this.sessionId)}catch(n){t.reject(n),this._lastUpdateDeferred=null}return t.promise}close(){if(this.sessionId&&this._mediaElement)try{this._mediaElement[this._addPrefix("cancelKeyRequest")](this._keySystem,this.sessionId)}catch(e){Dt.warn("Could not close keysession",e)}return Promise.resolve(!0)}}class Ut{constructor(e,t=""){this._mediaElement=null,this._waitingForSessionIds=[],this._sessionMap={},this.shouldRefreshPerTrack=!0,this._keySystem=e,this._prefix=t,this._onKeyMessage=this._onKeyMessage.bind(this),this._onKeyAdded=this._onKeyAdded.bind(this),this._onKeyError=this._onKeyError.bind(this)}attach(e){this._mediaElement=e;const t=this._prefix;e.addEventListener(t+yt.V0_1B_NEEDKEY,Pt);const n=e.addEventListener.bind(e);n(t+yt.V0_1B_KEY_ADDED,this._onKeyAdded),n(t+yt.V0_1B_KEY_ERROR,this._onKeyError),n(t+yt.V0_1B_KEY_MESSAGE,this._onKeyMessage)}detach(e){this._mediaElement=null;const t=this._prefix;e.removeEventListener(t+yt.V0_1B_NEEDKEY,Pt);const n=e.removeEventListener.bind(e);n(t+yt.V0_1B_KEY_ADDED,this._onKeyAdded),n(t+yt.V0_1B_KEY_ERROR,this._onKeyError),n(t+yt.V0_1B_KEY_MESSAGE,this._onKeyMessage)}_getSession(e){const t=this._sessionMap[e];if(t)return t;const n=this._waitingForSessionIds.shift();return n?(n.sessionId=e,this._sessionMap[e]=n,n):null}_onKeyMessage(e){const t=this._getSession(e.sessionId);t?t.generateComplete(e.message):Dt.warn("Got keymessage without session.")}_onKeyAdded(e){const t=this._getSession(e.sessionId);t?t.updateComplete():Dt.warn("Got keyadded without session.")}_onKeyError(e){const t=this._getSession(e.sessionId);t?t.handleErrorEvent(e):Dt.warn("Got keyerror without session.")}setServerCertificate(){return Promise.reject(new Ct(H.EME_CANNOT_SET_CERTIFICATE_FOR_PLATFORM,"Cannot set server certificate on this platform."))}createSession(){const e=new Nt(this._keySystem,this._mediaElement,this._prefix);return this._waitingForSessionIds.push(e),e}}function Mt(e){const t=this.mediaKeys;return t&&t!==e&&t.detach(this),delete this.mediaKeys,this.mediaKeys=e,e&&e.attach(this),Promise.resolve()}class Bt{constructor(e,t,n){if(this._configuration=null,this.keySystem=e,this._prefix=n,!this._checkConfig(t))throw new Ct(H.EME_NO_SUPPORTED_CONFIGURATION,"No supported configurations")}_checkConfig(e){const t=this.keySystem,n=document.createElement("video");for(let r=0,i=e.length;r<i;r++){const i=e[r],s={initDataTypes:i.initDataTypes,audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",sessionTypes:["temporary"],label:i.label};let o,a,c,l,u=!1;if(i.audioCapabilities&&i.audioCapabilities.length&&s.audioCapabilities)for(u=!1,o=0,a=i.audioCapabilities.length;o<a;o++)c=i.audioCapabilities[o],c.contentType&&(l=c.contentType.split(";")[0]),l&&n.canPlayType(l,t)&&(s.audioCapabilities.push(c),u=!0);if(i.videoCapabilities&&i.videoCapabilities.length&&s.videoCapabilities)for(u=!1,o=0,a=i.videoCapabilities.length;o<a;o++)c=i.videoCapabilities[o],l=c.contentType,c.contentType&&(l=c.contentType.split(";")[0]),l&&n.canPlayType(l,t)&&(s.videoCapabilities.push(c),u=!0);if(u)return this._configuration=s,!0}return!1}getConfiguration(){return this._configuration}createMediaKeys(){return new Promise((e=>{e(new Ut(this.keySystem,this._prefix))}))}}function xt(e){navigator.requestMediaKeySystemAccess=function(t,n){return new Promise((r=>{r(new Bt(t,n,e))}))};const t=HTMLMediaElement.prototype;delete t.mediaKeys,t.setMediaKeys=Mt}const Ft=mt("eme_polyfill.safari");function jt(e){const t=this.mediaKeys;return t&&t!==e&&t.detach(this),delete this.mediaKeys,this.mediaKeys=e,e?e.attach(this):Promise.resolve()}class Yt extends ne.vp{constructor(e,t){super(),this._attached=!1,this._nativeKeySession=null,this._lastGenerateResolver=Rt(),this._lastUpdateResolver=Rt(),this.addEventListener=this.addListener,this.removeEventListener=this.removeListener,this._nativeMediaKeys=e,this._serverCertificate=t,this._onKeyMessage=this._onKeyMessage.bind(this),this._onKeyAdded=this._onKeyAdded.bind(this),this._onKeyError=this._onKeyError.bind(this)}_attach(){if(this._attached)return;const e=this._nativeKeySession;e?(e.addEventListener(yt.WEBKIT_KEY_MESSAGE,this._onKeyMessage),e.addEventListener(yt.WEBKIT_KEY_ADDED,this._onKeyAdded),e.addEventListener(yt.WEBKIT_KEY_ERROR,this._onKeyError)):Ft.warn("Tried to attach with no WebKitMediaKeySession")}_detach(){if(!this._attached)return;const e=this._nativeKeySession;e?(e.removeEventListener(yt.WEBKIT_KEY_MESSAGE,this._onKeyMessage),e.removeEventListener(yt.WEBKIT_KEY_ADDED,this._onKeyAdded),e.removeEventListener(yt.WEBKIT_KEY_ERROR,this._onKeyError)):Ft.warn("Tried to detach with no WebKitMediaKeySession")}_onKeyMessage(e){e.message&&e.message.buffer&&(this.emitEvent(new At(e.message.buffer)),this._lastGenerateResolver&&(this._lastGenerateResolver.resolve(!0),this._lastGenerateResolver=null))}_onKeyAdded(){this._lastUpdateResolver&&(this._lastUpdateResolver.resolve(!0),this._lastUpdateResolver=null),this.emit(yt.KEY_SESSION_STATUSES_CHANGE,null)}_onKeyError(){const e=this._nativeKeySession&&this._nativeKeySession.error,t=new Ct(H.EME_MEDIA_KEY_SESSION_SAFARI_ERROR,e&&e.message||"MediaKeySession Safari Error");e&&(t.debug.errorCode=e.code,t.debug.systemCode=e.systemCode),this._lastGenerateResolver?(this._lastGenerateResolver.reject(t),this._lastGenerateResolver=null):this._lastUpdateResolver&&(this._lastUpdateResolver.reject(t),this._lastUpdateResolver=null)}_rebuildInitData(e){const t=new Uint8Array(e);if(new DataView(t.buffer).getUint32(0,!0)+4!==t.byteLength)throw new Ct(H.EME_INIT_DATA_MALFORMED,"Malformed init data");const n=function(e){const t=Math.floor(e.byteLength/2),n=new Uint16Array(t),r=new DataView(e.buffer);for(let i=0;i<t;i++)n[i]=r.getUint16(2*i,!0);return String.fromCharCode.apply(null,n)}(t.slice(4)).match(/^skd:\/\/([0-9a-fA-F]+)/);if(!n)throw new Ct(H.EME_INIT_DATA_MALFORMED,"Invalid content ID");const r=n[1],i=new Uint8Array(function(e){const t=new Uint8Array(2*e.length),n=new DataView(t.buffer),r=e.split("");for(let i=0,s=r.length;i<s;i++){const e=r[i].charCodeAt(0);n.setUint16(2*i,e,!0)}return t.buffer}(r)),s=this._serverCertificate,o=new Uint8Array(t.byteLength+4+i.byteLength+4+s.byteLength);let a=0;o.set(t,a),a+=t.byteLength;const c=new DataView(o.buffer);return c.setUint32(a,i.byteLength,!0),a+=4,o.set(i,a),a+=i.byteLength,c.setUint32(a,s.byteLength,!0),a+=4,o.set(s,a),o}generateRequest(e,t){return new Promise(((e,n)=>{this._lastGenerateResolver={resolve:e,reject:n};try{const e=this._rebuildInitData(t);this._nativeKeySession=this._nativeMediaKeys.createSession("video/mp4",new Uint8Array(e),null),this._attach()}catch(r){this._lastGenerateResolver=null,n(r)}}))}update(e){return new Promise(((t,n)=>{if(this._lastUpdateResolver={resolve:t,reject:n},this._nativeKeySession)try{this._nativeKeySession.update(new Uint8Array(e))}catch(r){n(r)}else Ft.warn("Tried to update with no WebKitMediaKeySession")}))}close(){return new Promise((e=>{this._detach(),e(!0)}))}}class Kt{constructor(e){this._lastBoundSetter=null,this._serverCertificate=null,this.shouldRefreshPerTrack=!0,this._nativeMediaKeys=new WebKitMediaKeys(e)}attach(e){return new Promise((t=>{if(e.readyState>=1)return e.webkitSetMediaKeys(this._nativeMediaKeys),void t();const n=()=>{e.removeEventListener(yt.MEDIA_LOADEDMETADATA,n),this._lastBoundSetter=null,e.webkitSetMediaKeys(this._nativeMediaKeys)};this._lastBoundSetter=n,e.addEventListener(yt.MEDIA_LOADEDMETADATA,n),e.addEventListener(yt.WEBKIT_NEEDKEY,Pt),t()}))}detach(e){e.removeEventListener(yt.WEBKIT_NEEDKEY,Pt),this._lastBoundSetter&&(e.removeEventListener(yt.MEDIA_LOADEDMETADATA,this._lastBoundSetter),this._lastBoundSetter=null)}setServerCertificate(e){return this._serverCertificate=new Uint8Array(e),Promise.resolve(!0)}createSession(){if(!this._serverCertificate)throw new Ct(H.EME_INVALID_STATE_ERROR,"The server certificate is not available");return new Yt(this._nativeMediaKeys,this._serverCertificate)}}class Ht{constructor(e,t){this.keySystem=e;const n=this._checkConfig(t);if(!n)throw new Ct(H.EME_NO_SUPPORTED_CONFIGURATION,"No supported configurations");this._configuration=n}_checkConfig(e){const t=this.keySystem;let n=!1;for(const r of e){const e={initDataTypes:r.initDataTypes,audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",sessionTypes:["temporary"]};if(r.audioCapabilities)for(const i of r.audioCapabilities){if(!i.contentType)continue;const r=i.contentType.split(";")[0];WebKitMediaKeys.isTypeSupported(t,r)&&(e.audioCapabilities.push(i),n=!0)}if(r.videoCapabilities)for(const i of r.videoCapabilities){if(!i.contentType)continue;const r=i.contentType.split(";")[0];WebKitMediaKeys.isTypeSupported(t,r)&&(e.videoCapabilities.push(i),n=!0)}if(n)return e}return null}getConfiguration(){return this._configuration}createMediaKeys(){return new Promise((e=>{e(new Kt(this.keySystem))}))}}const Vt=mt("eme_polyfills.tester");function Gt(){return"undefined"!=typeof navigator&&(null===navigator||void 0===navigator?void 0:navigator.requestMediaKeySystemAccess)&&"undefined"==typeof WebKitMediaKeys&&"undefined"!=typeof MediaKeySystemAccess&&(null===MediaKeySystemAccess||void 0===MediaKeySystemAccess?void 0:MediaKeySystemAccess.prototype.getConfiguration)?(Vt.log("Using native EME implementation."),"native"):"undefined"!=typeof HTMLMediaElement&&(null===HTMLMediaElement||void 0===HTMLMediaElement?void 0:HTMLMediaElement.prototype.webkitGenerateKeyRequest)?(Vt.log('Detected "webkit" Prefixed EME v0.1b. Polyfilling.'),xt("webkit"),"v0.1b-webkit"):"undefined"!=typeof HTMLMediaElement&&(null===HTMLMediaElement||void 0===HTMLMediaElement?void 0:HTMLMediaElement.prototype.generateKeyRequest)?(Vt.log("Detected Unprefixed EME v0.1b. Polyfilling."),xt(),"v0.1b"):"undefined"!=typeof MSMediaKeys?(Vt.log("Detected MS IE EME. Polyfilling."),function(){navigator.requestMediaKeySystemAccess=function(e,t){return new Promise((n=>{n(new wt(e,t))}))};const e=HTMLMediaElement.prototype;delete e.mediaKeys,e.setMediaKeys=Lt}(),"ms-ie"):"function"==typeof WebKitMediaKeys?(Vt.log("Detected Safari EME. Polyfilling."),function(){navigator.requestMediaKeySystemAccess=function(e,t){return new Promise((n=>{n(new Ht(e,t))}))};const e=HTMLMediaElement.prototype;delete e.mediaKeys,e.setMediaKeys=jt}(),"safari"):(Vt.warn("Detected no EME APIs."),null)}const Wt={[vt.WIDEVINE]:{commonName:"widevine",licenseServer:"https://@webgate/widevine-license",withCertificate:!0,pssh_field:{audio:"pssh_widevine",video:"encryption_data"}},[vt.PLAYREADY]:{commonName:"playready",licenseServer:"https://@webgate/playready-license",withCertificate:!1,pssh_field:{audio:"pssh_playready",video:"encryption_data"}},[vt.PLAYREADY_HARDWARE]:{commonName:"playready",licenseServer:"https://@webgate/playready-license",withCertificate:!1,pssh_field:{audio:"pssh_playready",video:"encryption_data"}},[vt.FAIRPLAY]:{commonName:"fairplay",licenseServer:"https://@webgate/fairplay-license",withCertificate:!0,pssh_field:{audio:"pssh_fairplay",video:"asset_id"}},[vt.INVALID_SPOTIFY_KEY]:{commonName:"spotify-invalid",licenseServer:"https://@webgate",withCertificate:!1,pssh_field:{audio:"pssh_invalid",video:"encryption_data"}}},qt=[{label:"video-sw-decode",initDataTypes:["cenc"],audioCapabilities:[{contentType:'audio/webm; codecs="opus"',robustness:"SW_SECURE_CRYPTO"},{contentType:'audio/mp4; codecs="flac"',robustness:"SW_SECURE_CRYPTO"},{contentType:'audio/mp4; codecs="mp4a.40.2"',robustness:"SW_SECURE_CRYPTO"}],videoCapabilities:[{contentType:'video/webm; codecs="vp9"',robustness:"SW_SECURE_DECODE"},{contentType:'video/webm; codecs="vp8"',robustness:"SW_SECURE_DECODE"},{contentType:'video/mp4; codecs="avc1.4d401f"',robustness:"SW_SECURE_DECODE"},{contentType:'video/mp2t; codecs="avc1.4d401f"',robustness:"SW_SECURE_DECODE"}],distinctiveIdentifier:"optional",persistentState:"optional",sessionTypes:["temporary"]},{label:"video-sw-crypto",initDataTypes:["cenc"],audioCapabilities:[{contentType:'audio/webm; codecs="opus"',robustness:"SW_SECURE_CRYPTO"},{contentType:'audio/mp4; codecs="flac"',robustness:"SW_SECURE_CRYPTO"},{contentType:'audio/mp4; codecs="mp4a.40.2"',robustness:"SW_SECURE_CRYPTO"}],videoCapabilities:[{contentType:'video/webm; codecs="vp9"',robustness:"SW_SECURE_CRYPTO"},{contentType:'video/webm; codecs="vp8"',robustness:"SW_SECURE_CRYPTO"},{contentType:'video/mp4; codecs="avc1.4d401f"',robustness:"SW_SECURE_CRYPTO"},{contentType:'video/mp2t; codecs="avc1.4d401f"',robustness:"SW_SECURE_CRYPTO"}],distinctiveIdentifier:"optional",persistentState:"optional",sessionTypes:["temporary"]},{label:"video-no-robustness",initDataTypes:["cenc"],audioCapabilities:[{contentType:'audio/webm; codecs="opus"',robustness:""},{contentType:'audio/mp4; codecs="flac"',robustness:""},{contentType:'audio/mp4; codecs="mp4a.40.2"',robustness:""}],videoCapabilities:[{contentType:'video/webm; codecs="vp9"',robustness:""},{contentType:'video/webm; codecs="vp8"',robustness:""},{contentType:'video/mp4; codecs="avc1.4d401f"',robustness:""},{contentType:'video/mp2t; codecs="avc1.4d401f"',robustness:""}],distinctiveIdentifier:"optional",persistentState:"optional",sessionTypes:["temporary"]},{label:"audio-flac-sw-crypto",initDataTypes:["cenc"],audioCapabilities:[{contentType:'audio/mp4; codecs="flac"',robustness:"SW_SECURE_CRYPTO"},{contentType:'audio/mp4; codecs="mp4a.40.2"',robustness:"SW_SECURE_CRYPTO"}],videoCapabilities:[],distinctiveIdentifier:"optional",persistentState:"optional",sessionTypes:["temporary"]},{label:"audio-flac-no-robustness",initDataTypes:["cenc"],audioCapabilities:[{contentType:'audio/mp4; codecs="flac"',robustness:""},{contentType:'audio/mp4; codecs="mp4a.40.2"',robustness:""}],videoCapabilities:[],distinctiveIdentifier:"optional",persistentState:"optional",sessionTypes:["temporary"]},{label:"audio-sw-crypto",initDataTypes:["cenc"],audioCapabilities:[{contentType:'audio/mp4; codecs="mp4a.40.2"',robustness:"SW_SECURE_CRYPTO"}],videoCapabilities:[],distinctiveIdentifier:"optional",persistentState:"optional",sessionTypes:["temporary"]},{label:"audio-no-robustness",initDataTypes:["cenc"],audioCapabilities:[{contentType:'audio/mp4; codecs="mp4a.40.2"',robustness:""}],videoCapabilities:[],distinctiveIdentifier:"optional",persistentState:"optional",sessionTypes:["temporary"]}];function zt(e,t){var n,r;for(let i=0,s=e.length;i<s;i++){const s=e[i],o={audioCapabilities:[],videoCapabilities:[]};let a,c,l,u,d=!1;if(null===(n=s.audioCapabilities)||void 0===n?void 0:n.length)for(d=!1,a=0,c=s.audioCapabilities.length;a<c;a++)l=s.audioCapabilities[a],u=l.contentType,u&&t(u)&&(o.audioCapabilities.push(l),d=!0);if(null===(r=s.videoCapabilities)||void 0===r?void 0:r.length)for(d=!1,a=0,c=s.videoCapabilities.length;a<c;a++)l=s.videoCapabilities[a],u=l.contentType,u&&t(u)&&(o.videoCapabilities.push(l),d=!0);if(d)return o}return null}const $t=/([^;]+)(?:;\s?codecs="(.*)")?/,Qt=mt("playback.eme_manager"),Xt={EMPTY:"-no-robustness",SW_CRYPTO:"-sw-crypto",SW_DECODE:"-sw-decode",HW_CRYPTO:"-hw-crypto",HW_DECODE:"-hw-decode",HW_ALL:"-hw-all"};function Jt(e,t){var n;const r=[],i=new RegExp(`codecs="(${t.join("|")})"`);for(const s of e)i.test(null!==(n=s.contentType)&&void 0!==n?n:"")||r.push(s);return r.length?r:null}function Zt(e,{audio:t,video:n}){var r,i,s,o;if(!(null==t?void 0:t.length)&&!(null==n?void 0:n.length))return e;let{audioCapabilities:a,videoCapabilities:c}=e;return(null==t?void 0:t.length)&&(null===(r=e.audioCapabilities)||void 0===r?void 0:r.length)&&(a=null!==(i=Jt(e.audioCapabilities,t))&&void 0!==i?i:void 0,!a)||(null==n?void 0:n.length)&&(null===(s=e.videoCapabilities)||void 0===s?void 0:s.length)&&(c=null!==(o=Jt(e.videoCapabilities,n))&&void 0!==o?o:void 0,!c)?null:Object.assign(Object.assign({},e),{audioCapabilities:a,videoCapabilities:c})}class en extends ne.vp{constructor(e){var t;super(),this._unauthServerCertificateBase="",this._disallowCodecs={},this._keySystemDeferred=Rt(),this._configuration=Rt(),this._keySystemSettings=null,this._keySessions=[],this._configs=[],this._pendingCertificateRequest=null,this._certificate=null,this._transport=e.transport,this._emeImpl=e.emeImpl,this._noServerCertificate=!!e.noServerCertificate,this._precacheServerCertificate=null===(t=e.precacheServerCertificate)||void 0===t||t,this._unauthServerCertificateBase=e.unauthServerCertificateBase||"https://spclient.wg.spotify.com",this._configFilter=function(e){const t=["--ensure-no-match--"];if(e&&e.length){let n=e.length;for(;n--;)Xt.hasOwnProperty(e[n])&&t.push(Xt[e[n]])}return new RegExp(`(${t.join("|")})$`)}(e.disallowRobustnessValues||[]),this._disallowCodecs=e.disallowCodecs,this._preferredKeySystems=e.preferredKeySystems||[vt.WIDEVINE,vt.PLAYREADY,vt.PLAYREADY_HARDWARE,vt.FAIRPLAY]}static create(e){return new Promise((t=>{const n=Gt();if(!n)throw Ct.fatal(H.EME_API_NOT_SUPPORTED,"Platform does not support navigator.requestMediaKeySystemAccess");t(new en(Object.assign(Object.assign({},e),{emeImpl:n})).init())}))}_prepareConfiguration(e){const t=e.getConfiguration();Qt.info("KeySystem configured as ",t.label),t.audioCapabilities&&t.audioCapabilities.length||this._appendProbableMediaCapabilities(e.keySystem,t);const n={keySystem:e.keySystem,keySystemImpl:this._emeImpl,audioFormats:this._parseCapabilities(t.audioCapabilities),videoFormats:this._parseCapabilities(t.videoCapabilities)};return this._keySystemSettings=Wt[e.keySystem],this._configuration.resolve(n),n}_parseCapabilities(e){if(!e)return[];const t=[];for(let n=0,r=e.length;n<r;n++){const r=e[n];if(!r||!r.contentType)continue;const i=r.contentType.match($t);i&&t.push({contentType:r.contentType,mimeType:i[1],codec:i[2]})}return t}_appendProbableMediaCapabilities(e,t){const n=zt(this._configs,(t=>(-1===t.indexOf("webm")||e!==vt.PLAYREADY&&e!==vt.PLAYREADY_HARDWARE)&&!!MediaSource.isTypeSupported(t)));n&&(t.audioCapabilities=n.audioCapabilities,t.videoCapabilities=n.videoCapabilities)}_trySetServerCertificate(e,t){const n=this._certificate;return(n&&n.expiry>Date.now()?Promise.resolve(n):this._requestServerCertificate(e)).then((e=>t.setServerCertificate(e.contents))).then((()=>this)).catch((e=>(Qt.warn("Error from setting server certificate",e),this)))}_cacheServerCertificate(e){let t="";switch(e){case vt.FAIRPLAY:t="fairplay";break;case vt.WIDEVINE:t="widevine";break;default:return Promise.resolve(this)}return this._requestServerCertificate(`${this._unauthServerCertificateBase}/${t}-license`,!1).then((()=>this),(e=>(Qt.warn("Cannot precache server certificate",e),this)))}_requestServerCertificate(e,t=!0){if(this._pendingCertificateRequest)return this._pendingCertificateRequest;return this._transport.request(`${e}/v1/application-certificate`,{authorize:t,responseType:"arraybuffer",parseResponseHeaders:!0,retry:{condition:(e,t)=>e.getStatusFamily()===t.SERVER_ERROR}}).then((e=>{var t;if(!e.body)throw new TypeError("Response body is invalid");this._pendingCertificateRequest=null;let n=3600;const r=null===(t=e.headers)||void 0===t?void 0:t.get("cache-control");if(r){const e=r.match(/(?:^|,|\s)max-age=(\d+)(?:,|$)/);e&&e[1]&&(n=1e3*parseInt(e[1],10))}return this._certificate={expiry:Date.now()+(n-600),contents:e.body},this._certificate}))}_extractPlayReadyChallenge(e,t){let n=null;const r=new Uint16Array(e),i=String.fromCharCode.apply(null,r);if(-1===i.indexOf("PlayReadyKeyMessage"))return Qt.info("Using unextracted PlayReady message."),e;const s=(new DOMParser).parseFromString(i,"application/xml"),o=s.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue;if(o)try{n=atob(o);const e=s.getElementsByTagName("name"),t=s.getElementsByTagName("value");if(e.length!==t.length)throw new Ct(H.EME_HEADER_KEY_VALUE_MISMATCH,"Mismatched header <name>/<value> pair in key message")}catch(a){this.emit(yt.EME_LICENSE_REQUEST_ERROR,{playId:t,error:a}),n=null}else this.emit(yt.EME_LICENSE_REQUEST_ERROR,{playId:t,error:new Ct(H.EME_HEADER_KEY_VALUE_MISMATCH,"Mismatched header <name>/<value> pair in key message")});return n}_onMessage(e,t){e.timeMap.generate.end=Date.now();let n="message"in t?t.message:null;const r="messageType"in t?t.messageType:void 0;if(Qt.info("Got EME message event with type",r),n&&e.keySystem===vt.PLAYREADY&&(n=this._extractPlayReadyChallenge(n,e.playId)),!n)return void Qt.info("Ignoring message event: no valid request payload");if(!e.licenseServer)return void Qt.info("Ignoring message event: no licenseServer url");e.timeMap.request.start=Date.now();let i=e.licenseServer;e.keySystem===vt.FAIRPLAY&&(i=`${i}${-1!==i.indexOf("?")?"&":"?"}assetId=hex`),this._transport.request(i,{method:"POST",payload:n,responseType:"arraybuffer",retry:{condition:(e,t)=>400!==e.status&&402!==e.status&&403!==e.status&&(!e.body||e.getStatusFamily()!==t.SUCCESS)}}).then(this._handleLicenseResponse.bind(this,e))}_handleLicenseResponse(e,t){const n=t=>{t.playId=e.playId,e.licenseServer&&(t.licenseServer=e.licenseServer),this.emit(yt.EME_LICENSE_REQUEST_ERROR,{playId:e.playId,error:t})};let r,i;if(e.timeMap.request.end=Date.now(),200!==t.status){try{if(t.body){const e=new Uint8Array(t.body),n=String.fromCharCode.apply(String,e);i=JSON.parse(n).errorMsg}}catch(ct){}402===t.status?this.emit(yt.EME_LICENSE_REQUEST_CAPPED,{playId:e.playId,error:new It(H.CAPPING_USER_IS_CAPPED,"User is capped.")}):400===t.status&&"widevine error"===i?(r=Ct.fatal(H.EME_LICENSE_REQUEST_WIDEVINE_ERROR,"Widevine license server failed to parse request."),r.status=t.status,r.shouldRefreshEndpoint=!0,n(r)):(r=new Ct(H.EME_LICENSE_REQUEST_FAILED_WITH_STATUS,`License request failed (${i||"unknown"})`),r.status=t.status,r.shouldRefreshEndpoint=400===t.status||403===t.status,n(r))}else{if(!t.body)return r=new Ct(H.EME_LICENSE_REQUEST_EMPTY_RESPONSE,"Empty license response body"),r.status=t.status,void n(r);try{e.timeMap.update.start=Date.now(),e.keySession.update(t.body).catch((e=>{n(new Ct(H.EME_LICENSE_UPDATE_FAILED,e.message||"License update failed."))})),Qt.info("KeySession updated.")}catch(s){n(new Ct(H.EME_LICENSE_UPDATE_FAILED,s.message||"License update failed."))}}}_selectKeySystem(e){const t=this._preferredKeySystems;for(let n=0,r=t.length;n<r;n++){const r=t[n];if(r in e)return e[r]}return null}_testMediaKeys(e){return new Promise((t=>{t(e.createMediaKeys())})).then((t=>{if(!t)return Promise.reject(Ct.fatal(H.EME_MEDIA_KEYS_NOT_SUPPORTED,"Cannot create MediaKeys from KeySystemAccess"));e.keySystem===vt.FAIRPLAY&&t.setServerCertificate(new ArrayBuffer(0));try{if(!t.createSession())throw new Error("")}catch(n){return Promise.reject(Ct.fatal(H.EME_MEDIA_KEY_SESSION_NOT_SUPPORTED,n.message||"Cannot create MediaKeySession from KeySystemAccess"))}return Promise.resolve(e)}),(e=>(Qt.error(e.name),Promise.reject(Ct.fatal(H.EME_MEDIA_KEYS_NOT_SUPPORTED,e.message||"Unknown error")))))}_saveSession(e){this._keySessions.push(e)}destroySessions(){const e=[],t=this._keySessions;for(let r=0,i=t.length;r<i;r++)try{const n=t[r],i=n.keySession;if(!i)continue;n.onMessageListener&&i.removeEventListener(yt.KEY_SESSION_MESSAGE,n.onMessageListener),n.onKeyStatusChangeListener&&i.removeEventListener(yt.KEY_SESSION_STATUSES_CHANGE,n.onKeyStatusChangeListener);const s=Promise.resolve(i.close()).catch((e=>{Qt.warn("Failed to close KeySession",e)}));e.push(s),n.keySession=null,n.onMessageListener=null,n.onKeyStatusChangeListener=null,Qt.info("Closed KeySession")}catch(n){Qt.warn("Failed to close KeySession",n)}return this._keySessions=[],Promise.all(e)}init(){const e=this._keySystemDeferred,t={},n=[],r=[];for(let i=0,s=qt.length;i<s;i++){let e=qt[i];if(!e.label||!this._configFilter.test(e.label)){if(this._disallowCodecs){const t=Zt(e,this._disallowCodecs);if(!t)continue;e=t}r.push(e)}}this._configs=r;for(const i in vt){if(!Object.prototype.hasOwnProperty.call(vt,i))continue;const e=i;n.push(navigator.requestMediaKeySystemAccess(vt[e],r).then((e=>{t[e.keySystem]=e})).catch((()=>{})))}return Promise.all(n).then(this._selectKeySystem.bind(this,t)).then((e=>e?this._testMediaKeys(e):Promise.reject(new Ct(H.EME_NO_SUPPORTED_KEYSYSTEM,"No supported keysystem was found.")))).then((t=>(this._prepareConfiguration(t),e.resolve(t),this._precacheServerCertificate?this._cacheServerCertificate(t.keySystem):this))).catch((t=>{const n=t.code||H.EME_NO_SUPPORTED_KEYSYSTEM,r=t.message||"No supported keysystem";return e.reject(Ct.fatal(n,r)),e.promise.then((()=>this))}))}createMediaKeys(e){return this._keySystemDeferred.promise.then((e=>e.createMediaKeys())).then((t=>Promise.all([e.setMediaKeys(t),t]))).then((([t,n])=>{if(!e.mediaKeys)throw new Ct(H.EME_PLAYER_MEDIA_KEYS_SETTING_FAILED,"Failed to set MediaKeys on HTMLMediaElement");return this._configuration.promise.then((()=>{const e=this._keySystemSettings;return e&&!this._noServerCertificate&&e.withCertificate?this._trySetServerCertificate(e.licenseServer,n):this}))}))}removeMediaKeys(e){return Promise.resolve(e.setMediaKeys(null)).then((()=>this))}getKeySystemInfo(){return this._configuration.promise}getKeySystemImpl(){return this._emeImpl}createSessionWithParams(e){return new Promise(((t,n)=>{Qt.info("Creating KeySession",e.keySystem);const r=e.mediaKeys.createSession(),i={generate:{start:0,end:0},request:{start:0,end:0},update:{start:0,end:0}},s=this._keySystemSettings&&this._keySystemSettings.licenseServer||void 0,o=this._onMessage.bind(this,{keySystem:e.keySystem,keySession:r,licenseServer:e.licenseServer||s,playId:e.playId,timeMap:i});r.addEventListener(yt.KEY_SESSION_MESSAGE,o);const a=()=>{Qt.info("KeyStatus change"),i.update.end=Date.now(),t({elapsed:{generate:Math.max(i.generate.end-i.generate.start,0),request:Math.max(i.request.end-i.request.start,0),update:Math.max(i.update.end-i.update.start,0)}})};return r.addEventListener(yt.KEY_SESSION_STATUSES_CHANGE,a),this._saveSession({keySession:r,onMessageListener:o,onKeyStatusChangeListener:a}),Qt.info("Generating KeySession request",e.keySystem),i.generate.start=Date.now(),Promise.resolve(r.generateRequest(e.initDataType,e.initData.buffer)).catch((e=>{if(!e)return;let t;switch(e.name){case"NotSupportedError":t=H.EME_NOT_SUPPORTED_ERROR;break;case"InvalidStateError":t=H.EME_INVALID_STATE_ERROR;break;default:t=H.EME_UNKNOWN_ERROR}n(new Ct(t,e.message||"Unknown error message."))}))}))}}class tn extends Error{constructor(e=H.STORAGE_ERROR,t="File Error"){super(t),this.canPlayNext=!0,this.debug={},this.code=e,this.message=t,this.name="FileError"}}class nn extends Error{constructor(e,t,n,r={}){super(t),this.code=e,this.message=t,this.status=n,this.debug=r,this.name="FragmentError"}}function rn(e){return e/1e3}class sn{constructor(e){if(this._fallbackURLs=[],this._fragments=[],this._usableFragments=[],this._loaded=!1,this._mediaType="audio",this._resolvedURLs=[],this._segmentLength=0,this._duration=0,this._stopPosition=null,!e.fileId&&!e.resolvedURL)throw new TypeError("Missing: provide either fileId or resolvedURL");this._abrManager=e.abrManager,this._disableCache=e.disableCache,this._fileId=e.fileId,this._format=e.format,this._isAd=e.isAd||!1,this._keySystem=e.keySystem,this._keySystemSettings=Wt[this._keySystem],this._licenseEndpoint=e.licenseEndpoint,this._logData=e.logData||{displayTrack:"",playbackId:""},this._resolver=e.resolver,this._resolvedURL=e.resolvedURL,this._transport=e.transport,this._uri=e.uri}_parsePSSHBox(e){const t=He.Base64.decode(e),n=new Uint8Array(t.length);for(let r=0,i=t.length;r<i;r++)n[r]=t.charCodeAt(r);return n}_parseAssetID(e){const t=He.Base64.decode(e),n=new Array(t.length);for(let r=0,i=t.length;r<i;r++){const e=t.charCodeAt(r).toString(16);n[r]=1===e.length?`0${e}`:e}return n.join("")}_calculateUsableFragments(){if(!this._stopPosition)return void(this._usableFragments=this._fragments);const e=[],t=this._fragments,n=rn(this._stopPosition);for(const r of t){if(!(r.timeStart<=n))break;e.push(r)}this._usableFragments=e}getCalculatedDuration(){return this._stopPosition?Math.min(this._duration,rn(this._stopPosition)):this._duration}setStopPosition(e){this._stopPosition=e,this._stopPosition?this._fragments.length&&this._calculateUsableFragments():this._usableFragments=this._fragments}getFileId(){return this._fileId}getFormat(){return this._format||""}getFragmentLength(){return this._segmentLength}getInitFragment(){return this._initFragment}getInitParams(){const e={keySystem:this._keySystem,initDataType:this._protection,initData:this._psshBox,licenseServer:null};return Promise.resolve(e)}getKeySystem(){return this._keySystem}getLicenseEndpoint(){return this._licenseEndpoint}getLogData(){return this._logData||{}}getMediaType(){return this._mediaType}getResolvedURL(){return this._resolvedURL}getResolvedURLs(){return this._resolvedURLs}getHLSURL(){throw new tn(H.FILE_NOT_RESOLVED,"Cannot return HLS Manifest URL: File not resolved.")}getURI(){return this._uri}isAd(){return this._isAd}isProtected(){return!!this._protection&&!!this._psshBox}setLogData(e){return this._logData=e,this}toLogJSON(){return{uri:this._uri,fileId:this._fileId,format:this._format||"",resolved_url:this._resolvedURL}}}function on(e){return function(e){return`data:application/vnd.apple.mpegurl;base64,${He.Base64.encode(e)}`}(function(e){var t;const n=function(e){return e.map((e=>{if(e.byteEnd&&void 0!==e.byteStart){let t=""+(1+e.byteEnd-e.byteStart);return t+=`@${e.byteStart}`,`#EXTINF:${e.duration},\n#EXT-X-BYTERANGE:${t}\n${e.url}`}return`#EXTINF:${e.duration},\n${e.url}`})).join("\n")}(e.segments),r=e.assetID?`#EXT-X-KEY:METHOD=SAMPLE-AES,URI="skd://${e.assetID}",KEYFORMATVERSIONS="1",KEYFORMAT="com.apple.streamingkeydelivery"`:"";let i=e.map?`#EXT-X-MAP:URI="${e.map.url}"`:"";return(null===(t=e.map)||void 0===t?void 0:t.byteEnd)&&void 0!==e.map.byteStart&&(i+=`,BYTERANGE="${1+e.map.byteEnd}@${e.map.byteStart}"`),`#EXTM3U\n#EXT-X-VERSION:6\n#EXT-X-TARGETDURATION:${Math.floor(e.targetDuration)}\n#EXT-X-MEDIA-SEQUENCE:0\n#EXT-X-PLAYLIST-TYPE:VOD\n${i?`${r}\n${i}`:r}\n${n}\n#EXT-X-ENDLIST`}(e))}const an=mt("playback.video_content");function cn(e){if(!e)return"";const t="audio_codec"in e?e.audio_codec:e.video_codec;return`${e.mime_type};codecs="${t}"`}const ln={method:"GET",responseType:"arraybuffer",timing:!0,retry:{condition:(e,t)=>{if(0===e.status)return!0;const n=e.getStatusFamily();return n===t.CONNECTION_ERROR||n===t.SERVER_ERROR}}};class un extends sn{constructor(e){super(e),this._assetId="",this._endTime=0,this._videoFormats=[],this._audioFormats=[],this._subtitleLanguages=[],this._videoProfile=null,this._videoProfiles=[],this._audioProfile=null,this._audioProfiles=[],this._baseURL="",this._initTemplate="",this._segmentTemplate="",this._subtitleTemplate="",this._initSegments={},this._initTemplate="",this._isAd=e.isAd||!1,this._mediaType="video",this._resolver=e.resolver,this._videoFormats=e.videoFormats,this._audioFormats=e.audioFormats,this._disallowProfile=e.disallowProfile,this._videoResolution=e.videoResolution,this._keySystem===vt.FAIRPLAY&&this._audioFormats.unshift({mimeType:"audio/mp2t",codec:"mp4a.40.2"}),this._parseFragmentResponse=this._parseFragmentResponse.bind(this)}static create(e){return new un(e)}_isQualityMatched(e,t,n){var r,i,s,o;if(this._videoResolution){const t=null!==(r=this._videoResolution.max)&&void 0!==r?r:Number.MAX_SAFE_INTEGER,o=null!==(i=this._videoResolution.min)&&void 0!==i?i:0;if(n){const n=null!==(s=this._videoResolution.start)&&void 0!==s?s:t;return e.video_resolution<=n}return e.video_resolution>=o&&e.video_resolution<=t}const a=null!==(o=null==t?void 0:t.max_bitrate)&&void 0!==o?o:0,c=this._abrManager.getBandwidthEstimate();return e.max_bitrate+a<c-1e5}_updateVariants(e){const t=this._audioProfiles[0];this._audioProfile=null!=t?t:null;const n=this._videoProfiles;let r=n.length;for(;r--;){const i=n[r];if(this._isQualityMatched(i,t,!!e))return void(this._videoProfile=i)}this._videoProfile=n[0]}_selectPreferredProfile(e,t,n,r,i){for(const s of t){const t=[];let o="spotify/unknown-mimetype",a="unknown-codec";for(const c of n){if(!(e in c))continue;if(Array.isArray(c.encryption_indices)&&void 0!==r&&-1===c.encryption_indices.indexOf(r))continue;if(this._keySystem===vt.FAIRPLAY&&"ts"!==c.file_type)continue;const n="audio_codec"in c?c.audio_codec:c.video_codec,l=c.mime_type;(null==i?void 0:i({mimeType:l,codec:n,height:c.video_height,width:c.video_width}))||(n===a&&l===o?t.push(c):n===s.codec&&l===s.mimeType&&(o=l,a=n,t.push(c)))}if(t.length)return t.sort(((e,t)=>"video_bitrate"in e&&"video_bitrate"in t?this._videoResolution?e.video_resolution===t.video_resolution?e.video_bitrate-t.video_bitrate:e.video_resolution-t.video_resolution:e.video_bitrate-t.video_bitrate:e.max_bitrate-t.max_bitrate))}return[]}_constructFragmentURL(e,t,n){if(!t&&!n)throw new Error("Both audioProfile and videoProfile is null");return e.init?this._resolver.getInitSegmentURLs(this._baseURL,this._initTemplate,t,n):this._resolver.getSegmentURLs(this._baseURL,this._segmentTemplate,e.timeStart,t,n)}_fetchBufferData(e,t,n){return this._transport.request(e,Object.assign(Object.assign({},ln),{metadata:{timeStart:Date.now(),fragment:t,profile:n}})).then(this._parseFragmentResponse)}_fetchInitSegmentBuffers(e,t){const n=this._initFragment;if(!n)return Promise.reject(new tn(H.FILE_NOT_RESOLVED,"Cannot fetch Init Segment buffers: File not resolved."));let r;try{r=this._constructFragmentURL(n,e,t)}catch(a){return Promise.reject(a)}const i=this._initSegments;let s=Promise.resolve(null);if(e){const t=i[e.id];(null==t?void 0:t.buffer.byteLength)?s=Promise.resolve(t):(null==r?void 0:r.audio)&&(s=this._fetchBufferData(r.audio,n,e).then((t=>(i[e.id]=t,t))))}let o=Promise.resolve(null);if(t){const e=i[t.id];(null==e?void 0:e.buffer.byteLength)?o=Promise.resolve(e):(null==r?void 0:r.video)&&(o=this._fetchBufferData(r.video,n,t).then((e=>(i[t.id]=e,e))))}return Promise.all([s,o]).then((([e,t])=>({audio:e,video:t})))}_fetchBufferForFragment(e,t,n){let r;try{r=this._constructFragmentURL(e,t,n)}catch(i){return Promise.reject(i)}return Promise.all([this._fetchInitSegmentBuffers(t,n),!e.init&&r.audio?this._fetchBufferData(r.audio,e,t):null,!e.init&&r.video?this._fetchBufferData(r.video,e,n):null]).then((([t,n,r])=>{var i,s;let o;return e.init?o={audio:null!==(i=t.audio)&&void 0!==i?i:void 0,video:null!==(s=t.video)&&void 0!==s?s:void 0}:(o={audio:null!=n?n:void 0,video:null!=r?r:void 0},e.cacheBufferSet&&(e.bufferSet=o),o.audio&&(null==t?void 0:t.audio)&&(o.audio.initBuffer=t.audio.buffer),o.video&&(null==t?void 0:t.video)&&(o.video.initBuffer=t.video.buffer)),o})).catch((e=>Promise.reject(e)))}_parseFragmentResponse(e){const{fragment:t,profile:n,timeStart:r}=e.metadata,i=cn(n),s=function(e){return e?"audio_bitrate"in e?e.audio_bitrate:e.video_bitrate:0}(n),o="video_resolution"in n?n.video_resolution:void 0,a=`${t.timeStart}-${t.timeEnd}`;switch(e.status){case 0:return Promise.reject(new nn(H.FRAGMENT_REQUEST_FAILED_WITH_ZERO,"Request failed with status 0.",0,{time_range:a,mimetype:i,resolution:o,bitrate:s}));case 200:case 206:{const t=e.body;if(!(null==t?void 0:t.byteLength))return Promise.reject(new nn(H.FRAGMENT_REQUEST_EMPTY_RESPONSE,"Empty response for successful buffer.",e.status,{time_range:a,mimetype:i,resolution:o,bitrate:s}));const c=t.byteLength;return this._abrManager.sample(c,Date.now()-r),this._updateVariants(),Promise.resolve({profileId:`${this._fileId}-${n.id}`,bufferURL:e.url,buffer:t,byteStart:0,byteEnd:c-1,mimetype:i,resolution:o,bitrate:s,bandwidth:8e3*c/e.timing.completed})}}return Promise.reject(new nn(H.FRAGMENT_REQUEST_FAILED_WITH_STATUS,`Buffer request failed with status ${e.status}`,e.status,{time_range:a,mimetype:i,resolution:o,bitrate:s}))}_getHLSURLForProfile(e){const t=this._duration,n=this._segmentLength,r=this._segmentTemplate,i=[];for(let s=0;s<t;s+=n){const o=s+n>t?t-s:n,a=r.replace("{{profile_id}}",e.id.toString(10)).replace("{{segment_timestamp}}",s.toString(10)).replace("{{file_type}}",e.file_type);i.push({duration:o,url:`${this._baseURL}${a}`})}return on({assetID:this._assetId,targetDuration:n,segments:i})}_calculateFragments(e){this._duration=e.end_time_millis/1e3;const t=this._segmentLength;this._initFragment={init:!0,cacheBufferSet:!1,timeStart:-1,timeEnd:-1,byteRanges:{}};for(let n=0;n<this._duration;n+=t)this._fragments.push({cacheBufferSet:!n&&!this._disableCache,timeStart:n,timeEnd:n+t,byteRanges:{}});this._calculateUsableFragments()}setVideoResolution(e){this._videoResolution=Object.assign(Object.assign({},this._videoResolution),e),this._updateVariants()}getCurrentBitrate(){var e,t;return null!==(t=null===(e=this._videoProfile)||void 0===e?void 0:e.video_bitrate)&&void 0!==t?t:0}getBufferForFragment(e){var t;if(!e)return Promise.reject(new TypeError("No fragment provided"));const n=this._audioProfile,r=this._videoProfile;return e.bufferSet&&(!r||(null===(t=e.bufferSet.video)||void 0===t?void 0:t.resolution)&&e.bufferSet.video.resolution>=r.video_resolution)?Promise.resolve(e.bufferSet):this._fetchBufferForFragment(e,null!=n?n:void 0,null!=r?r:void 0)}clearCachedBuffers(){this._initFragment&&(this._initSegments={}),this._usableFragments.forEach((function(e){e.bufferSet=null}))}getDuration(){return this._endTime}getFragmentAfterTime(e){if(null===this._usableFragments)return null;if(0===e||.01===e)return this._usableFragments[1];for(const t of this._usableFragments)if(t.timeStart>e)return t;return null}getFragmentForTime(e){if(null===this._usableFragments)return null;if(0===e||.01===e)return this._usableFragments[0];for(const t of this._usableFragments)if(t.timeStart<=e&&t.timeEnd>=e)return t;return null}getSubtitleLanguages(){return this._subtitleLanguages}getSubtitles(){return this._subtitleLanguages.map((e=>({lang:e,url:this._subtitleTemplate.replace("{{language_code}}",e)})))}load(e={resolveLatency:0,manifestLatency:0}){if(this._loaded)return e.resolveLatency=0,e.manifestLatency=0,Promise.resolve(this);if(!this._fileId)throw new TypeError("Missing: provide either fileId or resolvedURL");const t=Date.now();return this._resolver.getManifest(this._fileId).then((n=>{var r,i;let s;e.resolveLatency=0,e.manifestLatency=Date.now()-t;const o=n.contents[0];if(!o)return s=new tn(H.FILE_MALFORMED_SEEKTABLE,"Malformed seektable: no contents."),s.track=this.toLogJSON(),Promise.reject(s);let a;if(this._resolvedURLs=n.base_urls.slice(),this._baseURL=n.base_urls.shift()||"",this._resolvedURL=this._baseURL,this._fallbackURLs=n.base_urls,this._initTemplate=n.initialization_template,this._segmentTemplate=n.segment_template,this._segmentLength=o.segment_length,null===(r=o.encryption_infos)||void 0===r?void 0:r.length){const e=o.encryption_infos,t=this._keySystemSettings.commonName;let n;for(let r=0,i=e.length;r<i;r++){const i=e[r];if(i&&i.key_system===t){a=r,n=i[this._keySystemSettings.pssh_field.video];break}}if(!n)return s=new tn(H.FILE_FORMAT_NOT_SUPPORTED,"KeySystem does not support the file format."),s.track=this.toLogJSON(),Promise.reject(s);switch(this._keySystemSettings.commonName){case"widevine":case"playready":this._protection="cenc";try{this._psshBox=this._parsePSSHBox(n)}catch(c){return s=new tn(H.FILE_MALFORMED_PSSH,"Invalid PSSH value."),s.track=this.toLogJSON(),Promise.reject(s)}break;case"fairplay":this._protection="hls",this._psshBox=new Uint8Array([]);try{this._assetId=this._parseAssetID(n)}catch(c){return s=new tn(H.FILE_MALFORMED_PSSH,"Invalid PSSH value."),s.track=this.toLogJSON(),Promise.reject(s)}break;default:return s=new tn(H.FILE_FORMAT_NOT_SUPPORTED,"KeySystem does not support the file format."),s.track=this.toLogJSON(),Promise.reject(s)}}return this._endTime=n.end_time_millis,this._videoProfiles=this._selectPreferredProfile("video_codec",this._videoFormats,o.profiles,a,this._disallowProfile),this._audioProfiles=this._selectPreferredProfile("audio_codec",this._audioFormats,o.profiles,a),this._updateVariants(!0),this._calculateFragments(n),this._subtitleLanguages=n.subtitle_language_codes||[],(null===(i=n.subtitle_base_urls)||void 0===i?void 0:i.length)&&n.subtitle_template?this._subtitleTemplate=`${n.subtitle_base_urls[0]}${n.subtitle_template}`:(an.info("No subtitles available"),this._subtitleTemplate=""),this}))}getResolveLatency(){}getPlayableCodecs(){var e,t;return[cn(null!==(e=this._audioProfile)&&void 0!==e?e:void 0),cn(null!==(t=this._videoProfile)&&void 0!==t?t:void 0)].filter((e=>!!e))}getAudioProfile(){return this._audioProfile}getVideoProfile(){return this._videoProfile}getVideoProfiles(){return this._videoProfiles}getHLSURL(){if(!this._resolvedURL)throw new tn(H.FILE_NOT_RESOLVED,"Cannot return HLS Manifest URL: File not resolved.");const e=[],t=this._audioProfiles[0];t&&e.push(`#EXT-X-MEDIA:TYPE=AUDIO,GROUP-ID="audio",LANGUAGE="eng",NAME="English",AUTOSELECT=YES,URI="${this._getHLSURLForProfile(t)}"`);for(const r of this._videoProfiles)e.push(`#EXT-X-STREAM-INF:BANDWIDTH=${r.max_bitrate},RESOLUTION=${r.video_width}x${r.video_height},CODECS="${(null==t?void 0:t.audio_codec)?`mp4a.40.2, ${r.video_codec}`:r.video_codec}"${(null==t?void 0:t.audio_codec)?',AUDIO="audio"':""}\n${this._getHLSURLForProfile(r)}`);const n=`#EXTM3U\n${e.join("\n")}`;return`data:application/vnd.apple.mpegurl;base64,${He.Base64.encode(n)}`}}var dn;!function(e){e[e.MP3_256=3]="MP3_256",e[e.MP3_320=4]="MP3_320",e[e.MP3_160=5]="MP3_160",e[e.MP3_96=6]="MP3_96",e[e.MP4_128=10]="MP4_128",e[e.MP4_256=11]="MP4_256",e[e.MP4_128_DUAL=12]="MP4_128_DUAL",e[e.MP4_256_DUAL=13]="MP4_256_DUAL",e[e.MP4_128_CBCS=14]="MP4_128_CBCS",e[e.MP4_256_CBCS=15]="MP4_256_CBCS",e[e.MP4_FLAC=17]="MP4_FLAC"}(dn||(dn={}));const pn={[dn.MP3_256]:"audio/mp3",[dn.MP3_320]:"audio/mp3",[dn.MP3_160]:"audio/mp3",[dn.MP3_96]:"audio/mp3",[dn.MP4_128]:'audio/mp4; codecs="mp4a.40.2"',[dn.MP4_256]:'audio/mp4; codecs="mp4a.40.2"',[dn.MP4_128_DUAL]:'audio/mp4; codecs="mp4a.40.2"',[dn.MP4_256_DUAL]:'audio/mp4; codecs="mp4a.40.2"',[dn.MP4_128_CBCS]:'audio/mp4; codecs="mp4a.40.2"',[dn.MP4_256_CBCS]:'audio/mp4; codecs="mp4a.40.2"',[dn.MP4_FLAC]:'audio/mp4; codecs="flac"'};class hn extends sn{constructor(e){if(super(e),this._lastResolveTimestamp=0,this._profileId=`${Date.now()}`,this._initBufferPromise=null,this._lastFetchedBuffer=null,this._bypassResolve=!!this._resolvedURL,this._emitWarning=e.emitWarning||function(){},this._mediaType="audio",this._noManifest=!!e.noManifest,this._preloadedManifest=e.preloadedManifest,this._resolver=e.resolver,this._segmentLength=0,this._fileFormat=e.fileFormat,this._fileFormat)this._audioCodec=pn[this._fileFormat];else switch(this._format){case bt.MP3:this._audioCodec=pn[dn.MP3_160];break;case bt.MP4:case bt.MP4_DUAL:case bt.MP4_CBCS:this._audioCodec=pn[dn.MP4_128];break;default:throw new TypeError(`Unknown audio format ${this._format}`)}this._fileId&&(this._profileId=this._fileId),this._parseFragmentResponse=this._parseFragmentResponse.bind(this)}static create(e){return new hn(e)}_parseFragmentResponse(e){const{requestURL:t,fragment:n,byteRangeHeader:r,expectedLength:i}=e.metadata,s=`${n.timeStart}-${n.timeEnd}`;switch(e.status){case 0:{if(e.offline)return Promise.reject(new nn(H.FRAGMENT_OFFLINE_REQUEST_FAILED_WITH_ZERO,"Request failed with status 0.",0,{time_range:s,byte_range:r}));const i=new nn(H.FRAGMENT_ONLINE_REQUEST_FAILED_WITH_ZERO,"Request failed with status 0.",0);let o=!1;return this._resolvedURL!==t?o=!0:this._fallbackURLs.length&&this._resolvedURL===t&&(o=!0,this._resolvedURL=this._fallbackURLs.shift()),i.debug.has_fallback=o,o?(this._emitWarning(i,this.toLogJSON()),this.getBufferForFragment(n)):Promise.reject(i)}case 200:case 206:{const o=e.body;if(!o)return Promise.reject(new nn(H.FRAGMENT_REQUEST_EMPTY_RESPONSE,"Empty response for successful buffer.",e.status,{time_range:s,byte_range:r}));if(o.byteLength!==i)return Promise.reject(new nn(H.FRAGMENT_REQUEST_UNEXPECTED_LENGTH,"Received buffer of unexpected length.",e.status,{time_range:s,byte_range:r,received_length:o.byteLength,expected_length:i}));const a={audio:{profileId:this._profileId,bufferURL:t,byteStart:n.byteRanges.audio.start,byteEnd:n.byteRanges.audio.end,buffer:o,mimetype:this._audioCodec,bandwidth:8e3*o.byteLength/e.timing.completed}};if(n.cacheBufferSet&&o&&o.byteLength){n.bufferSet=a;const e=n.sliceInto;if(null==e?void 0:e.length)for(const t of e){const e=t.fragment;(null==e?void 0:e.cacheBufferSet)&&(e.bufferSet={audio:Object.assign(Object.assign({},a.audio),{buffer:o.slice(t.start,t.end),byteStart:e.byteRanges.audio.start,byteEnd:e.byteRanges.audio.end})})}}return this._abrManager.sample(o.byteLength,e.timing.completed),Promise.resolve(a)}case 403:return this.resolve().then((()=>this.getBufferForFragment(n)));default:{let i=!1;return this._resolvedURL!==t?i=!0:this._fallbackURLs.length&&this._resolvedURL===t&&(i=!0,this._resolvedURL=this._fallbackURLs.shift()),i?this.getBufferForFragment(n):Promise.reject(new nn(H.FRAGMENT_REQUEST_FAILED_WITH_STATUS,`Buffer request failed with status ${e.status}`,e.status,{time_range:s,byte_range:r}))}}}_getInitBuffer(){var e,t;if(!this._initFragment)throw new tn(H.FILE_NOT_RESOLVED,"Cannot return HLS Manifest URL: File not resolved.");return(null===(t=null===(e=this._initFragment.bufferSet)||void 0===e?void 0:e.audio)||void 0===t?void 0:t.buffer.byteLength)?Promise.resolve(this._initFragment.bufferSet.audio.buffer):(this._initBufferPromise||(this._initBufferPromise=this.getBufferForFragment(this._initFragment).then((e=>{var t;if(!(null===(t=e.audio)||void 0===t?void 0:t.buffer.byteLength))throw new Error("Empty initialization segment buffer");return e.audio.buffer}))),this._initBufferPromise)}_calculateFragments(e){let t=e.offset;this._initFragment={init:!0,cacheBufferSet:!this._disableCache,timeStart:0,timeEnd:0,byteRanges:{audio:{start:0,end:t-1}}};const n=e.segments,r=e.timescale,i=n.length,s=new Array(i);let o=0,a=0;for(let c=0,l=i;c<l;c++){const e=n[c],i=e[0],l=e[1],u=l/r,d={init:!1,cacheBufferSet:!c&&!this._disableCache,timeStart:o,timeEnd:o+u,byteRanges:{audio:{start:t,end:t+(i-1)}}};s[c]=d,t+=i,a+=l,o+=u,Math.floor(u)>this._segmentLength&&(this._segmentLength=Math.floor(u))}s[s.length-1].isLastFragment=!0,this._fragments=s,this._duration=a/r,this._calculateUsableFragments()}_calculateFragmentsV1(e){let t=e.offset;this._initFragment={init:!0,cacheBufferSet:!this._disableCache,timeStart:0,timeEnd:0,byteRanges:{audio:{start:0,end:t-1}}};const n=e.references,r=e.timescale,i=n.length,s=new Array(i);let o=0,a=0;for(let c=0,l=i;c<l;c++){const e=n[c],i=e.duration/r,l={init:!1,cacheBufferSet:!c&&!this._disableCache,timeStart:a,timeEnd:a+i,byteRanges:{audio:{start:t,end:t+(e.size-1)}}};s[c]=l,t+=e.size,o+=e.duration,a+=i,Math.floor(i)>this._segmentLength&&(this._segmentLength=Math.floor(i))}s[s.length-1].isLastFragment=!0,this._fragments=s,this._duration=o/r,this._calculateUsableFragments()}_getManifest(e){if(this._noManifest)return e&&(e.manifestLatency=0),Promise.resolve(null);if(this._preloadedManifest)return e&&(e.manifestLatency=0),Promise.resolve(this._preloadedManifest);if(!this._fileId)throw new TypeError("Missing: fileId");const t=Date.now();return this._resolver.getManifest(this._fileId).then((function(n){return e&&(e.manifestLatency=Date.now()-t),n}))}getHLSURL(){var e,t;const n=this._resolvedURL,r=this._initFragment;if(!n||!r)throw new tn(H.FILE_NOT_RESOLVED,"Cannot return HLS Manifest URL: File not resolved.");const i={url:n,byteStart:null===(e=r.byteRanges.audio)||void 0===e?void 0:e.start,byteEnd:null===(t=r.byteRanges.audio)||void 0===t?void 0:t.end},s=this._usableFragments.map((e=>{var t,r;return{url:n,duration:e.timeEnd-e.timeStart,byteStart:null===(t=e.byteRanges.audio)||void 0===t?void 0:t.start,byteEnd:null===(r=e.byteRanges.audio)||void 0===r?void 0:r.end}}));return on({assetID:this._fileId,targetDuration:10,map:i,segments:s})}clearCachedBuffers(){this._headFragment&&delete this._headFragment,this._initFragment&&(this._initFragment.bufferSet=null),this._fragments[0]&&(this._fragments[0].bufferSet=null),this._lastFetchedBuffer=null}getPlayableCodecs(){return[this._audioCodec]}getFirstFragment(){return this._usableFragments[0]}getHeadFragment(){const e=this._initFragment,t=this._fragments[0];if(!(null==e?void 0:e.byteRanges.audio)||!(null==t?void 0:t.byteRanges.audio))throw new tn(H.FILE_NOT_RESOLVED,"Cannot return HLS Manifest URL: File not resolved.");return this._headFragment||(this._headFragment={init:!0,cacheBufferSet:!0,timeStart:0,timeEnd:0,byteRanges:{audio:{start:e.byteRanges.audio.start,end:t.byteRanges.audio.end}},sliceInto:[{fragment:e,start:0,end:t.byteRanges.audio.start},{fragment:t,start:t.byteRanges.audio.start,end:void 0}]}),this._headFragment}getFragmentAfterTime(e){if(null===this._usableFragments)return null;if(0===e||.01===e)return this._usableFragments[1];for(const t of this._usableFragments)if(t.timeStart>e)return t;return null}getFragmentForTime(e){if(null===this._usableFragments)return null;if(0===e||.01===e)return this._usableFragments[0];for(const t of this._usableFragments)if(t.timeStart<=e&&t.timeEnd>=e)return t;return null}getBufferForFragment(e){var t;if(!e)return Promise.reject(new Error("FIXME: error type?"));if((null===(t=this._lastFetchedBuffer)||void 0===t?void 0:t.fragment)===e)return Promise.resolve(this._lastFetchedBuffer.bufferSet);if(e.bufferSet)return Promise.resolve(e.bufferSet);if(!this._resolvedURL)return Promise.reject(new tn(H.FILE_NOT_RESOLVED,"Cannot fetch buffer: No resolved URL"));const n=e.byteRanges.audio,r=`${n.start}-${n.end}`,i=n.end+1-n.start,s=this._resolvedURL,o=e.init?Promise.resolve(null):this._getInitBuffer();return Promise.all([o,this._transport.request(s,{method:"GET",responseType:"arraybuffer",headers:{Range:`bytes=${r}`},timing:!0,metadata:{requestURL:s,fragment:e,byteRangeHeader:r,expectedLength:i},retry:{condition:(e,t)=>{if(0===e.status)return e.offline;const n=e.getStatusFamily();return n===t.CONNECTION_ERROR||n===t.SERVER_ERROR||!(n!==t.SUCCESS||!e.body)&&e.body.byteLength!==i}}}).then(this._parseFragmentResponse)]).then((([t,n])=>(t&&n.audio&&(n.audio.initBuffer=t),this._lastFetchedBuffer={fragment:e,bufferSet:n},n)))}resolve(e){const t=this._fileId;if(this._bypassResolve)return e&&(e.resolveLatency=0),Promise.resolve({uri:this._resolvedURL,uris:[],protection:this._preloadedManifest||!this._noManifest?"cenc":void 0});if(!t)throw new TypeError("Missing: fileId is required to resolve content URL");clearTimeout(this._lastResolveToken);const n=()=>(this._lastResolveTimestamp=Date.now(),this._resolver.getCDNURL(t,this._fileFormat).then((t=>(e&&(e.resolveLatency=Date.now()-this._lastResolveTimestamp),t)))),r=Date.now()-this._lastResolveTimestamp;let i;return i=r<1001?new Promise(((e,t)=>{this._lastResolveToken=setTimeout((()=>{n().then(e,t)}),1001-r)})):n(),i.then((e=>{this._resolvedURLs=[];for(let t=0,n=e.uris.length;t<n;t++){const n=e.uris[t].split("?")[0];this._resolvedURLs.push(n)}return this._fallbackURLs=e.uris,this._resolvedURL=this._fallbackURLs.shift(),e})).catch((e=>(e&&(e.track=this.toLogJSON()),Promise.reject(e))))}load(e={resolveLatency:0,manifestLatency:0}){return this._loaded?(e.resolveLatency=0,e.manifestLatency=0,Promise.resolve(this)):Promise.all([this.resolve(e),this._getManifest(e)]).then((([e,t])=>{var n;if(this._loaded=!0,!e.protection||!t)return this;if(this._keySystem===vt.INVALID_SPOTIFY_KEY)return this._protection=t.protection||"cenc",this._psshBox=new Uint8Array(0),this;let r;const i=this._keySystemSettings.pssh_field.audio;let s=function(e,t){return t.hasOwnProperty(e)}(i,t)?t[i]:null;if(!s&&"pssh_widevine"===i&&"pssh"in t&&(s=null!==(n=t.pssh)&&void 0!==n?n:null),!s)return r=new tn(H.FILE_FORMAT_NOT_SUPPORTED,"KeySystem does not support the file format."),r.track=this.toLogJSON(),Promise.reject(r);if(this._protection=t.protection||"cenc",this._psshBox=this._parsePSSHBox(s),"segments"in t&&t.segments)this._calculateFragments(t);else{if(!("references"in t)||!t.references)return r=new tn(H.FILE_MALFORMED_SEEKTABLE,"Malformed seektable."),r.track=this.toLogJSON(),Promise.reject(r);this._calculateFragmentsV1(t)}return this}))}}const _n=mt("playback.content_buffer");var fn;function gn(){}!function(e){e[e.AUDIO=10]="AUDIO",e[e.VIDEO=20]="VIDEO"}(fn||(fn={}));class mn extends ne.vp{constructor(e,t=[],n={}){super(),this._mediaSource=null,this._sourceBuffers={},this._appendingFragments=[],this._currentInitSegments={},this._updateQueue=[],this._codecs=[],this._playId=0,this._lastBufferClearTime=Date.now(),this._codecs=t,this._tracker=e,this._disableBufferAbort=!!n.disableBufferAbort,this._onSourceOpen=this._onSourceOpen.bind(this),this._onSourceClose=this._onSourceClose.bind(this),this.dequeueUpdates=this.dequeueUpdates.bind(this),n.noInit||this._init()}static create(e,t=[],n={}){return new mn(e,t,n)}_init(){this._mediaSource=new MediaSource,this._mediaSource.addEventListener(yt.MEDIA_SOURCE_OPEN,this._onSourceOpen),this._mediaSource.addEventListener(yt.MEDIA_SOURCE_CLOSE,this._onSourceClose),this._sourceBuffers={},this._currentInitSegments={}}_onSourceOpen(){_n.info("MediaSource opened.");const e=this._mediaSource;if(e&&0===e.sourceBuffers.length&&"open"===e.readyState){_n.info("Creating source buffers for codecs",this._codecs);for(let e=0,t=this._codecs.length;e<t;e++)this._addSourceBuffer(this._codecs[e])}this.dequeueUpdates(),this.emit(yt.BUFFER_SOURCE_OPEN,null)}_onSourceClose(){_n.info("MediaSource closed."),this._destroySourceBuffers(),this.emit(yt.BUFFER_SOURCE_CLOSE,null)}_removeAppendingFragment(e){if(!e)return;const t=this._appendingFragments,n=t.indexOf(e);-1!==n&&t.splice(n,1)}_addSourceBuffer(e){if(this._mediaSource){const t=this._mediaSource.addSourceBuffer(e);t.addEventListener(yt.SOURCE_BUFFER_UPDATE_END,this.dequeueUpdates),this._sourceBuffers[e]=t}}_trackBufferingProgress(e){e.audio&&e.audio.buffer&&this._tracker.trackBytesDownloaded(e.audio.buffer.byteLength),e.video&&e.video.buffer&&this._tracker.trackBytesDownloaded(e.video.buffer.byteLength)}_checkStalling(e,t,n){var r,i;const s=t.byteRanges.video?t.byteRanges.video.start:null!==(i=null===(r=t.byteRanges.audio)||void 0===r?void 0:r.start)&&void 0!==i?i:-1;var o;e>9e3&&this.emit(yt.BUFFER_STALLED,{byteStart:s,timeStart:(o=t.timeStart,Math.ceil(1e3*o)),stallAmount:e-9e3,didTimeout:n})}_appendBufferData(e,t,n,r=Date.now()){this.emit(yt.BUFFERING_END,null);const i=[];if(e.audio){const s=Rt();this.tryUpdate({playId:n,timestamp:r,fragment:t,type:"append",profileId:e.audio.profileId,buffer:e.audio.buffer,initBuffer:e.audio.initBuffer,codec:e.audio.mimetype,init:!!t.init,resolve:s.resolve}),i.push(s.promise),null!==e.audio.bandwidth&&this._tracker.trackBufferURL(e.audio.bufferURL||"",{bandwidth:e.audio.bandwidth||0})}if(e.video){const s=Rt();this.tryUpdate({playId:n,timestamp:r,fragment:t,type:"append",profileId:e.video.profileId,buffer:e.video.buffer,initBuffer:e.video.initBuffer,codec:e.video.mimetype,init:!!t.init,resolve:s.resolve}),i.push(s.promise),null!==e.video.bandwidth&&this._tracker.trackBufferURL(e.video.bufferURL||"",{bandwidth:e.video.bandwidth||0})}return Promise.all(i)}_appendUpdate(e){var t,n;const r=this._sourceBuffers[e.codec];if(!r||r.updating)return void this._updateQueue.push(e);let i=e.buffer;if(e.fragment.init&&this._currentInitSegments[e.codec]===e.profileId)return null===(t=e.resolve)||void 0===t||t.call(e,!0),void Promise.resolve().then(this.dequeueUpdates);if(e.initBuffer&&e.buffer&&this._currentInitSegments[e.codec]!==e.profileId){const t=new Uint8Array(e.initBuffer.byteLength+e.buffer.byteLength);t.set(new Uint8Array(e.initBuffer),0),t.set(new Uint8Array(e.buffer),e.initBuffer.byteLength),i=t.buffer}try{r.appendBuffer(i)}catch(o){let t=!1;return"QuotaExceededError"===o.name?(_n.warn("Failed to append buffer: exceeded quota."),t=!0,this.emitSync(yt.BUFFER_QUOTA_EXCEEDED,null)):_n.warn("Failed to append buffer",o),void new Promise((e=>{t?setTimeout(e,500):e()})).then((()=>{this._removeAppendingFragment(e.fragment),this.dequeueUpdates()})).then((()=>{e.init&&this._updateQueue.push(e)}))}this._removeAppendingFragment(e.fragment);const s=i.byteLength>e.buffer.byteLength;(e.fragment.init||s)&&(this._currentInitSegments[e.codec]=e.profileId),null===(n=e.resolve)||void 0===n||n.call(e,!0),s?_n.info(`Injected combined init segment and playable segment (${e.codec}, ${e.profileId})`):e.init&&_n.info(`Injected individual init segment (${e.codec}, ${e.profileId})`)}_abortUpdate(e){"fragment"in e&&this._removeAppendingFragment(e.fragment),e.resolve&&e.resolve(!1),Promise.resolve().then(this.dequeueUpdates)}_processUpdate(e){"end"===e.type?this._endUpdate(e):"duration"===e.type?this._durationUpdate(e):"append"===e.type&&this._appendUpdate(e)}_isUpdating(){if(!this._mediaSource)return!1;const e=this._mediaSource.sourceBuffers;for(let t=0,n=e.length;t<n;t++){const n=e[t];if(n&&n.updating)return!0}return!1}_endUpdate(e){this._isUpdating()?this._updateQueue.push(e):this._mediaSource&&"open"===this._mediaSource.readyState&&(this._mediaSource.endOfStream(),e.resolve&&e.resolve(!0))}_durationUpdate(e){this._isUpdating()?this._updateQueue.push(e):(this._mediaSource&&(this._mediaSource.duration=e.duration),e.resolve&&e.resolve(!0))}_destroySourceBuffers(){const e=this._mediaSource;if(!e)return;const t=e.sourceBuffers;if(t.length)for(let r=0,i=t.length;r<i;r++){const i=t[r];i.removeEventListener("updateend",this.dequeueUpdates);try{e.removeSourceBuffer(i),_n.info("Removed source buffer")}catch(n){_n.warn("Failed to remove sourcebuffer",n)}}this._sourceBuffers={},this._currentInitSegments={}}_endOfStream(){this._mediaSource&&"ended"!==this._mediaSource.readyState&&this.tryUpdate({playId:this._playId,timestamp:Date.now(),type:"end"})}dequeueUpdates(){const e=this._updateQueue.shift();e&&this.tryUpdate(e)}appendFragment(e,t,n=!1){if(-1!==this._appendingFragments.indexOf(t))return Promise.resolve([]);this._appendingFragments.push(t),this.emit(yt.BUFFERING_START,null);const r=Date.now(),i=this._playId,s=e.toLogJSON();return e.getBufferForFragment(t).then((e=>(this._trackBufferingProgress(e),i!==this._playId?(_n.info("Append fragment dropped: playId has changed."),[]):(n||this._checkStalling(Date.now()-r,t,!1),this._appendBufferData(e,t,i,r))))).catch((e=>(this._removeAppendingFragment(t),n||this._checkStalling(Date.now()-r,t,!0),this.emit(yt.BUFFER_APPEND_ERROR,{error:e,canPlayNext:!0,track:s}),Promise.reject(e))))}abort(e=!1){if(this._lastBufferClearTime=Date.now(),this._appendingFragments=[],this._disableBufferAbort)_n.info("MediaSource abort skipped; action disabled.");else{if(this._mediaSource){const n=this._mediaSource.sourceBuffers;for(let r=0,i=n.length;r<i;r++)if("open"===this._mediaSource.readyState){const i=n[r];try{i.abort();const t=i.buffered;if(e&&t.length){const e=t.start(0),n=t.end(t.length-1);i.remove(e,n),_n.info("Cleared buffer range",e,n)}}catch(t){_n.warn("ContentBuffer.clear failed.",t)}}}this._currentInitSegments={}}}getMediaSource(){return this._mediaSource}tryUpdate(e){if(!e)return;if(e.playId!==this._playId)return _n.info("Try update dropped: playId has changed"),void this._abortUpdate(e);if(e.timestamp<this._lastBufferClearTime)return _n.info("Try update dropped: update is older than the last clear"),void this._abortUpdate(e);const t=this._mediaSource;t&&"open"!==t.readyState&&"ended"!==t.readyState?this._updateQueue.push(e):this._processUpdate(e)}destroy(){const e=this._mediaSource;e&&(_n.info("Source destroyed"),e.removeEventListener("sourceopen",this._onSourceOpen),e.removeEventListener("sourceclose",this._onSourceClose),this._destroySourceBuffers(),this._mediaSource=null)}progress(e,t,n){const r=this._mediaSource;if(!r)return;const i="video"===e.getMediaType()?fn.VIDEO:fn.AUDIO;if("open"===r.readyState||"ended"===r.readyState){let s;const o=function(e,t){const n=e.sourceBuffers&&e.sourceBuffers.length>0&&e.sourceBuffers[0].buffered;if(n){let e,r;for(let i=0;i<n.length;i++)if(e=n.start(i),r=n.end(i),e<=t&&t<=r)return{start:e,end:r}}return null}(r,n);if(o){if(n+i>r.duration)return void("open"===r.readyState&&this._endOfStream());const a=e.getFragmentLength();Math.ceil(n/a)>Math.floor(o.end/a)&&(s=e.getFragmentForTime(n),s&&this.appendFragment(e,s,t).catch(gn));const c=Math.floor(o.end-n);if(c>i)return;const l=Math.min(e.getFragmentLength(),i-c);if(l<1)return;const u=Math.floor(o.end+l);s=e.getFragmentForTime(u),s?this.appendFragment(e,s,t).catch(gn):this._endOfStream()}else if(s=e.getFragmentForTime(n),s){if(this.appendFragment(e,s,t).catch(gn),s.timeEnd<n+5){const n=e.getFragmentAfterTime(s.timeStart);n?this.appendFragment(e,n,t).catch(gn):this._endOfStream()}}else this._endOfStream()}}recreate(e){this.abort(),this.destroy(),this._codecs=e,this._init()}setDuration(e){this.tryUpdate({playId:this._playId,timestamp:Date.now(),type:"duration",duration:e})}setPlayId(e){this._playId=e}}class yn{constructor(e){if(this._estimate=0,this._totalWeight=0,e<0)throw new TypeError("Halflife must be set to a positive value.");this._weightingDecrease=Math.exp(Math.log(.5)/e)}sample(e,t){const n=Math.pow(this._weightingDecrease,e),r=t*(1-n)+n*this._estimate;isNaN(r)||(this._estimate=r,this._totalWeight+=t)}getEstimate(){return this._estimate/1-Math.pow(this._weightingDecrease,this._totalWeight)}}class vn{constructor(e=4e5){this._totalBytes=0,this._overrideBitrate=0,this._currentBandwidth=e,this._short=new yn(2),this._long=new yn(5),this._init()}_init(){if("undefined"==typeof navigator)return;const e=navigator;e.connection&&e.connection.downlink&&(this._currentBandwidth=1e6*e.connection.downlink,this._onConnectionChange=this._onConnectionChange.bind(this),e.connection.addEventListener("change",this._onConnectionChange))}_onConnectionChange(e){const t=e.target.downlink||0;this._setBandwidth(t)}_setBandwidth(e){this._currentBandwidth=1e6*e}getBandwidthEstimate(){if(this._overrideBitrate)return this._overrideBitrate;if(this._totalBytes<128e3)return this._currentBandwidth;const e=this._short.getEstimate(),t=this._long.getEstimate();return Math.min(e,t)}sample(e,t){if(e<16e3)return;const n=t/1e3,r=8*e/n;this._totalBytes+=e,this._short.sample(n,r),this._long.sample(n,r)}overrideBitrate(e){this._overrideBitrate=e<=0?0:e}}const En=mt("playback.player"),Sn=/^blob:/,bn={[bt.MP4]:!0,[bt.MP4_DUAL]:!0,[bt.MP4_CBCS]:!0,[bt.MP4_FLAC]:!0,[bt.MP3]:!1,[bt.MANIFEST_ID]:!1};function Tn(e){return Math.ceil(1e3*e)}function Cn(e){return e/1e3}function In(e){return document.createElement(e)}class Rn extends ne.vp{constructor(e){super(),this._subtitlesVisible=!1,this._cubicVolume=!1,this._player=null,this._emeManager=null,this._currentContent=null,this._upcomingContent=null,this._preloadingTracks={},this._playId=0,this._loaded=!1,this._licenseRequested=!1,this._playerActivated=!1,this._pauseToken=0,this._syntheticEndedToken=0,this._activeCodecs=[],this._playerVolume=1,this._fatalOnNextError=!1,this._canPreloadEmitted=!1,this._lastTimeUpdatePostion=0,this._buffering=!1,this._preferredBitrate=0,this._disableLicensePrefetch=!1,this._disableBufferingBeforeLicense=!1,this._crossOrigin=null,this._audioResolver=e.audioResolver,this._clearBufferOnSeek=!!e.clearBufferOnSeek,this._createPlayer=e.createPlayer||In,this._cubicVolume=e.cubicVolume,this._disableCache=!!e.disableCache,this._licenseURLResolver=e.licenseURLResolver,this._newBufferPerTrack=!!e.newBufferPerTrack,this._newElementPerTrack=!!e.newElementPerTrack,this._newMediaKeysPerTrack=!!e.newMediaKeysPerTrack,this._rebufferOnQuotaExceeded=!!e.rebufferOnQuotaExceeded,this._disableLicensePrefetch=!!e.disableLicensePrefetch,this._synthesizeEnded=!!e.synthesizeEnded,this._tracker=e.tracker,this._transport=e.transport,this._videoPlayerContainer=e.videoPlayerContainer,this._audioPlayerContainer=e.audioPlayerContainer,this._videoResolver=e.videoResolver,this._abrManager=new vn,this._emeManager=e.disallowProtectedTracks?null:e.emeManager||null,this._disallowProfile=e.disallowProfile,this._disableBufferingBeforeLicense=!!e.disableBufferingBeforeLicense,this._cache=new at.z6(e.trackCacheSize||2),this._defaultSubtitleLanguage=e.preferredSubtitleLanguage||navigator.language,this._activeSubtitleLanguage=this._defaultSubtitleLanguage,this._videoResolution=e.videoResolution,En.info("Setting Player track cache to:",e.trackCacheSize||2),this._buffer=mn.create(this._tracker,void 0,{disableBufferAbort:!!e.disableBufferAbort,reinjectInitsOnAbort:!!e.reinjectInitsOnAbort,noInit:!0}),this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onTimeUpdate=this._onTimeUpdate.bind(this),this._onDurationChange=this._onDurationChange.bind(this),this._onPlaying=this._onPlaying.bind(this),this._onPause=this._onPause.bind(this),this._onSeeking=this._onSeeking.bind(this),this._onEncrypted=this._onEncrypted.bind(this),this._onEnded=this._onEnded.bind(this),this._onError=this._onError.bind(this),this._onRequiresDuration=this._onRequiresDuration.bind(this),this._onQuotaExceeded=this._onQuotaExceeded.bind(this),this._onLoadedMetadata=this._onLoadedMetadata.bind(this),this._onWaiting=this._onWaiting.bind(this),this._onPlayedThresholdReached=this._onPlayedThresholdReached.bind(this),this._onSyntheticEnded=this._onSyntheticEnded.bind(this),this._onLicenseRequestCapped=this._onLicenseRequestCapped.bind(this),this._onLicenseRequestError=this._onLicenseRequestError.bind(this),this._onNavigatorOffline=this._onNavigatorOffline.bind(this),this._onBufferError=this._onBufferError.bind(this),this._emitWarning=this._emitWarning.bind(this),this._handleLoadingComplete=this._handleLoadingComplete.bind(this),this.proxyEmitSync(this._tracker,yt.TRACKER_TRACKING_DATA_CREATED,yt.PLAYER_TRACKING_DATA_CREATED),this.proxyEmitSync(this._tracker,yt.TRACKER_TRACKING_DATA_FINALIZED,yt.PLAYER_TRACKING_DATA_FINALIZED),this.proxyEmitSync(this._tracker,yt.TRACKER_PLAYBACK_START,yt.PLAYER_PLAYBACK_START),this._tracker.on(yt.TRACKER_PLAYED_THRESHOLD_REACHED,this._onPlayedThresholdReached),this._emeManager&&(this._emeManager.on(yt.EME_LICENSE_REQUEST_CAPPED,this._onLicenseRequestCapped),this._emeManager.on(yt.EME_LICENSE_REQUEST_ERROR,this._onLicenseRequestError)),this._disableCache&&En.info("Cache disabled."),this._transport.on(this._transport.EVENT_CONNECTION_OFFLINE,this._onNavigatorOffline),this._buffer.on(yt.BUFFER_APPEND_ERROR,this._onBufferError),this._buffer.on(yt.BUFFER_QUOTA_EXCEEDED,this._onQuotaExceeded),this.proxyEmit(this._buffer,yt.BUFFER_STALLED,yt.PLAYER_BUFFER_STALLED),this.proxyEmit(this._buffer,yt.BUFFERING_START,yt.PLAYER_BUFFERING_START),this.proxyEmit(this._buffer,yt.BUFFERING_END,yt.PLAYER_BUFFERING_END)}static create(e){const t=Object.assign({},e);return en.create({transport:e.transport,disallowRobustnessValues:e.disallowRobustnessValues,disallowCodecs:e.disallowCodecs,noServerCertificate:e.noServerCertificate,precacheServerCertificate:e.precacheServerCertificate,unauthServerCertificateBase:e.unauthServerCertificateBase,preferredKeySystems:e.preferredKeySystems}).then((e=>{t.emeManager=e;const n=new Rn(t);return t.preinitMediaElement?n._preinitMediaElement():n})).catch((n=>{if(e.enableWithoutEME)return Rn.createWithOptions(t);throw n}))}static createWithOptions(e){return new Promise((t=>{const n=new Rn(e);t(e.preinitMediaElement?n._preinitMediaElement():n)}))}_onLicenseRequestError(e){if(e.data.playId!==this._playId)return;const t=this._currentContent;if(!t)return;const n=e.data.error;n.shouldRefreshEndpoint&&this._licenseURLResolver.remove(t.getKeySystem(),t.getMediaType()),this._emitError(n,!n.unrecoverable,t.toLogJSON())}_onLicenseRequestCapped(e){if(e.data.playId!==this._playId)return;this._currentContent&&(this.pause(),this.emit(yt.PLAYER_CAPPED,null))}_shouldNextErrorBeFatal(){const e=this._currentContent;if(!e)return!1;if(e.isAd()||!e.isProtected())return!1;if(!this._player)return!1;const t=this._player.error;if(!(t&&t instanceof MediaError))return this._fatalOnNextError=!1,!1;switch(t.code){case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:case MediaError.MEDIA_ERR_DECODE:return!0;default:return!1}}_onNavigatorOffline(){this._tracker.trackNavigatorOffline()}_onBufferError(e){this._emitError(e.data.error,e.data.canPlayNext,e.data.track)}_addPlayerEvents(e){e.addEventListener(yt.MEDIA_TIMEUPDATE,this._onTimeUpdate),e.addEventListener(yt.MEDIA_PLAYING,this._onPlaying),e.addEventListener(yt.MEDIA_PAUSE,this._onPause),e.addEventListener(yt.MEDIA_SEEKING,this._onSeeking),e.addEventListener(yt.MEDIA_ENCRYPTED,this._onEncrypted),e.addEventListener(yt.MEDIA_ENDED,this._onEnded),e.addEventListener(yt.MEDIA_ERROR,this._onError),e.addEventListener(yt.MEDIA_LOADEDMETADATA,this._onLoadedMetadata),e.addEventListener(yt.MEDIA_DURATIONCHANGE,this._onDurationChange),e.addEventListener(yt.MEDIA_WAITING,this._onWaiting),e.addEventListener(yt.MEDIA_CANPLAY,this._onCanPlay),e.addEventListener(yt.MEDIA_CANPLAYTHROUGH,this._onCanPlayThrough),e.addEventListener(yt.INTERNAL_MEDIA_REQUIRES_DURATION,this._onRequiresDuration)}_removePlayerEvents(e){e.removeEventListener(yt.MEDIA_TIMEUPDATE,this._onTimeUpdate),e.removeEventListener(yt.MEDIA_PLAYING,this._onPlaying),e.removeEventListener(yt.MEDIA_PAUSE,this._onPause),e.removeEventListener(yt.MEDIA_SEEKING,this._onSeeking),e.removeEventListener(yt.MEDIA_ENCRYPTED,this._onEncrypted),e.removeEventListener(yt.MEDIA_ENDED,this._onEnded),e.removeEventListener(yt.MEDIA_ERROR,this._onError),e.removeEventListener(yt.MEDIA_WAITING,this._onWaiting),e.removeEventListener(yt.MEDIA_CANPLAY,this._onCanPlay),e.removeEventListener(yt.MEDIA_CANPLAYTHROUGH,this._onCanPlayThrough),e.removeEventListener(yt.MEDIA_LOADEDMETADATA,this._onLoadedMetadata),e.removeEventListener(yt.MEDIA_DURATIONCHANGE,this._onDurationChange),e.removeEventListener(yt.INTERNAL_MEDIA_REQUIRES_DURATION,this._onRequiresDuration)}_recreateMediaElement(e,t,n,r){if(t!==this._playId)return En.info("Recreate player dropped: playId has changed."),Promise.resolve(!1);const i=this._player;if(i){if(!this._newElementPerTrack&&("AUDIO"!==i.tagName||"video"!==n)){let t=!0;for(const n of e)if('audio/mp2t;codecs="mp4a.40.2"'!==n&&!i.canPlayType(n)){t=!1;break}if(t)return En.info("Reusing media element."),e.join(",")===this._activeCodecs.join(",")&&!this._newBufferPerTrack||r||(En.info("Recreating buffer."),this._buffer.recreate(e),this._activeCodecs=e),Promise.resolve(!0)}this._removePlayerEvents(i),i.pause(),this._emeManager&&this._emeManager.removeMediaKeys(i).catch((function(e){En.warn("Failed to remove media keys.",e)})),this._player=null;const t=this._getContainerElement(this._videoPlayerContainer);t&&i.parentNode===t&&(t.removeChild(i),this.emit(yt.PLAYER_VIDEO_ELEMENT_REMOVED,null));const s=this._getContainerElement(this._audioPlayerContainer);s&&i.parentNode===s&&s.removeChild(i)}En.info("Creating new media element.");const s=this._createPlayer(n),o=this._playerVolume;return s.volume=this._cubicVolume?o*o*o:o,s.autoplay=!1,s.loop=!1,this._crossOrigin=s.crossOrigin,"playsInline"in s&&(s.playsInline=!0),this._player=s,this._playerActivated=!1,this._addPlayerEvents(s),r||this._buffer.recreate(e),this._activeCodecs=e,Promise.resolve(!0)}_getContainerElement(e){return"string"==typeof e?document.querySelector(e):e||null}_onDurationChange(){const e=this._playId,t=()=>{if(!this._player)return;if(e!==this._playId)return void En.info("Duration changed drop: playId has changed.");const t=Tn(this._player.duration),n=Tn(this._player.currentTime);this._tracker.setActualDuration(t),this.emit(yt.PLAYER_DURATION_CHANGED,{timestamp:Date.now(),position:n,duration:t})};this._loaded?t():this.once(yt.PLAYER_LOAD,t)}_onPlaying(){if(!this._player)return;this._playerActivated=!0;const e=this._currentContent,t=Tn(this._player.currentTime);this._tracker.trackPlaying(t),this.emit(yt.PLAYER_PLAYING,{timestamp:Date.now(),position:t,logData:e?e.getLogData():null})}_onPause(){if(!this._player)return;const e=Tn(this._player.currentTime);this._tracker.trackPaused(e);const t=this._currentContent?this._currentContent.getLogData():null;this._pauseToken=setTimeout((()=>{clearTimeout(this._syntheticEndedToken),this.emit(yt.PLAYER_PAUSED,{position:e,logData:t})}),10)}_onSeeking(){this._buffer.abort(this._clearBufferOnSeek),this._lastTimeUpdatePostion=0,this._onTimeUpdate()}_onRequiresDuration(){this._currentContent&&this._currentContent.isProtected()&&this._player&&(this._player.duration=this._currentContent.getCalculatedDuration())}_onQuotaExceeded(){this._player&&this._rebufferOnQuotaExceeded&&(En.info("Exceeded quota: rebuffering current track."),this._buffer.abort(!0),this._player.currentTime=this._player.currentTime,this._onTimeUpdate())}_onEncrypted(e){En.info("Got Encrypted event");this._currentContent&&this.emitSync(yt.INTERNAL_ENCRYPTED,{initData:e.initData,fromPolyfill:!!e.fromPolyfill})}_onEnded(){!this._currentContent||this._synthesizeEnded&&this._currentContent.isProtected()||(En.info("Native ended emitted."),this._emitEnded())}_onSyntheticEnded(){this._synthesizeEnded&&this._currentContent&&this._currentContent.isProtected()&&(En.info("Synthetic ended emitted."),this._emitEnded())}_onError(){if(!this._player)return;const e=this._player,t=e.error;let n,r=!1;const i=this._currentContent;let s,o,a,c=!1;i&&(r=i.isProtected(),n=i.toLogJSON(),c=i.isAd(),i.clearCachedBuffers());let l=!0;const u=!i||c||!this._fatalOnNextError,d=t&&t.msExtendedCode?`0x${(t.msExtendedCode>>>0).toString(16).toUpperCase()}`:null;if(t instanceof MediaError){switch(t.code){case MediaError.MEDIA_ERR_ABORTED:s=H.MEDIA_ABORTED,o="Media aborted.";break;case MediaError.MEDIA_ERR_NETWORK:s=H.MEDIA_NETWORK_ERROR,o="Network error.";break;case MediaError.MEDIA_ERR_DECODE:s=H.MEDIA_DECODING_ERROR,o="Media decoding error.",l=u;break;case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:s=H.MEDIA_NOT_SUPPORTED,o="Media not supported.",l=u;break;default:s=H.PLAYER_MEDIA_ERROR,o="Media error.",a=!0}o+=` (${t.message||d||e.src||t.toString()})`}else s=H.PLAYER_PLAYBACK_ERROR,o="Error message undefined",a=!0;this._buffer.abort(!0);const p=new Tt(s,o);l||(p.unrecoverable=!0),p.listPlayerIgnore=c,p.debug.src_url=e.src,p.debug.protected=r,p.debug.extendedCode=d,p.debug.rawExCode=t&&t.msExtendedCode||null,a&&t&&(p.debug.nativeCode=t.code||null,p.debug.errorData=t),this._emitError(p,l,n)}_onLoadedMetadata(){this.emitSync(yt.INTERNAL_PLAYER_LOADED_METADATA,null)}_onCanPlay(){this._buffering=!1,this.emitSync(yt.INTERNAL_PLAYER_CANPLAY,null),this.emit(yt.PLAYER_FIRST_BYTES,null)}_onCanPlayThrough(){this.emitSync(yt.INTERNAL_PLAYER_CANPLAYTHROUGH,null)}_onWaiting(){clearTimeout(this._syntheticEndedToken),this._player&&!this._player.seeking&&(this._buffering=!0,this._getBufferingLatency().then((e=>{this._tracker.trackMsStalled(e)})))}_onPlayedThresholdReached(e){this._currentContent&&this._player&&this.emit(yt.PLAYER_PLAYED_THRESHOLD_REACHED,{played:e.data.played,threshold:e.data.threshold,position:Tn(this._player.currentTime)})}_emitEnded(){this._currentContent&&"video"===this._currentContent.getMediaType()&&this.emit(yt.PLAYER_ENDED_VIDEO,null),clearTimeout(this._pauseToken),this.emit(yt.PLAYER_ENDED,null)}_emitError(e,t,n){En.error("Player Error",e,n,t),this._tracker.setHadError(!0),!this._disableCache&&n&&n.fileId&&this._cache.remove(n.fileId),this.emit(yt.PLAYER_ERROR,{playId:this._playId,error:e,track:n,canPlayNext:t,position:this._player?Tn(this._player.currentTime):0})}_emitWarning(e,t){En.error("Player Warning",e,t,!0),this._tracker.trackWarning(),this.emit(yt.PLAYER_WARNING,{playId:this._playId,error:e,track:t,canPlayNext:!0,position:this._player?Tn(this._player.currentTime):0})}_prepareMediaElement(e,t){return t===this._playId&&this._upcomingContent?this._recreateMediaElement(this._upcomingContent.getPlayableCodecs(),t,this._upcomingContent.getMediaType(),this._upcomingContent.getKeySystem()===vt.FAIRPLAY).then((e=>{if(!e||t!==this._playId)return En.info("Loading content dropped after recreate: playId has changed."),Promise.resolve(!1);const n=this._player;return n&&this._upcomingContent&&this._upcomingContent.isProtected()&&this._emeManager&&(!n.mediaKeys||n.mediaKeys.shouldRefreshPerTrack||this._newMediaKeysPerTrack)?(En.info("Creating media keys"),this._emeManager.createMediaKeys(n).then((()=>!0)).catch((e=>(e.unrecoverable=!0,this._emitError(e,!1,this._upcomingContent?this._upcomingContent.toLogJSON():void 0),Promise.reject(e))))):Promise.resolve(!0)})):(En.info("Loading content dropped: playId has changed."),Promise.resolve(!1))}_handleLoadingComplete(e){const t=this._currentContent&&this._currentContent.getMediaType(),n=this._getContainerElement("video"===t?this._videoPlayerContainer:this._audioPlayerContainer);return n&&this._player&&this._player.parentNode!==n&&(n.appendChild(this._player),"video"===t&&this.emit(yt.PLAYER_VIDEO_ELEMENT_APPENDED,null)),this._upcomingContent=null,e}_prepareSubtitleElements(){if(!(this._player&&this._currentContent&&this._currentContent instanceof un))return;this._player.crossOrigin="anonymous";const e=this._getActiveSubtitleLanguage();for(const{lang:t,url:n}of this._currentContent.getSubtitles()){const r=document.createElement("track");r.label=`${t} subtitles`,r.kind="subtitles",r.srclang=t,r.src=n,r.default=this._subtitlesVisible&&t.toLowerCase()===e,this._player.appendChild(r)}this._subtitlesVisible&&this.showSubtitles()}_getActiveSubtitleLanguage(){var e;if(this._player&&this._currentContent&&this._currentContent instanceof un)return null===(e=this._currentContent.getSubtitleLanguages().find((e=>{const t=e.toLowerCase();return[this._activeSubtitleLanguage,this._defaultSubtitleLanguage,"en"].find((e=>{if(!e)return!1;const n=e.toLowerCase();return t===n||t.split("-")[0]===n.split("-")[0]}))})))||void 0===e?void 0:e.toLowerCase()}_removeSubtitleElements(){if(!(this._player&&this._currentContent&&this._currentContent instanceof un))return;const e=this._player;for(;e.firstChild;)e.removeChild(e.lastChild);e.crossOrigin=this._crossOrigin}_handleLoadingError(e,t,n,r){if(this._upcomingContent=null,n!==this._playId)return Promise.resolve(!1);if(this._tracker.trackLoadFailed(),this.emit(yt.PLAYER_LOADING_FAILED,{uri:e,logData:t.logData}),r){const n=r.track||{uri:e,fileId:t.fileId,format:t.format,deviceId:t.logData.deviceId};this._emitError(r,"StorageError"!==r.name||!!r.canPlayNext,n)}return Promise.reject(r)}_handleLoadedMetadata(e,t,n){if(e!==this._playId)return void En.info("LoadedMetadata operations dropped: playId has changed.");this._loaded=!0;const r=this._player;if(!r)return;this._buffer.dequeueUpdates();const i=n.position>r.duration?0:n.position;this._lastTimeUpdatePostion=0,r.currentTime!==i&&(En.info("Resetting initial position after metadata."),r.currentTime=i),this._tracker.trackLoadDone(Tn(r.currentTime)),this.emitSync(yt.PLAYER_LOAD,{autoplay:n.autoplay,position:Tn(i),logData:t}),Promise.resolve().then((()=>{this._onTimeUpdate()}));let s=()=>{r.currentTime!==i&&(En.info("Resetting initial position after playable."),r.currentTime=i)};n.autoplay&&!r.error&&(s=()=>{if(r.currentTime!==i&&(En.info("Resetting initial position after playable."),r.currentTime=i),this._playId!==e)return void En.info("Play trigger dropped; different playId");new Promise((e=>e(this._player&&this._player.play()))).catch((e=>{if(e){if("NotSupportedError"===e.name)return Promise.reject(e);if("NotAllowedError"===e.name)return this.emit(yt.PLAYER_AUTOPLAY_FAILED,null),Promise.reject(e)}return this._player?this._player.play():Promise.resolve()})).catch((()=>{this._onPause()}))}),r.readyState>2?(En.info("Ready to play, triggering play."),s()):(En.info("Waiting to be playable."),this.once(yt.INTERNAL_PLAYER_CANPLAY,s))}_handleCanPlayThrough(e){e===this._playId?this._tracker.trackCanPlayThrough():En.info("CanPlayThrough operations dropped: playId has changed.")}_loadContent(e,t){if(t!==this._playId||!this._upcomingContent)return En.info("Loading content dropped: playId has changed."),Promise.resolve(!1);if(!this._player)throw new Tt(H.PLAYER_INVALID_INTERNAL_STATE,"Cannot load content without an HTMLMediaElement");this._canPreloadEmitted=!1;const n=this._upcomingContent;this._upcomingContent=null,this._currentContent=n;const r=e.callback;r&&this.once(yt.PLAYER_LOAD,(()=>{this._playId&&t===this._playId?r():En.info("Load content event dropped: playId has changed.")})),this.once(yt.INTERNAL_PLAYER_LOADED_METADATA,this._handleLoadedMetadata.bind(this,t,this._currentContent.getLogData(),e)),this.once(yt.INTERNAL_PLAYER_CANPLAYTHROUGH,this._handleCanPlayThrough.bind(this,t));let i=e.position;const s=n.getCalculatedDuration();s&&i>s&&(i=e.position=0);try{this._player.currentTime=i}catch(a){En.warn("Cannot set initial position before loading.",a)}const o=n.isProtected();return this._tracker.setProtected(o),n.getKeySystem()===vt.FAIRPLAY?n instanceof hn&&!o?Promise.resolve(this._loadUnprotectedTrack()):Promise.resolve(this._loadHLSProtectedTrack(e,t)):n instanceof un?this._loadVideoTrack(e,t):o?this._loadProtectedTrack(e,t):Promise.resolve(this._loadUnprotectedTrack())}_getBufferingLatency(){return new Promise((e=>{if(!this._player)return void e(0);const t=Date.now();this._player.addEventListener("canplaythrough",(function n(){this.removeEventListener("canplaythrough",n),e(Date.now()-t)}))}))}_loadVideoTrack(e,t){if(!(this._player&&this._currentContent&&this._currentContent instanceof un))return Promise.resolve(!1);const n=this._currentContent;En.info("_loadVideoTrack");const r=()=>{this._currentContent&&this._currentContent.isProtected()&&this._requestLicense(t).then((()=>{this._playId===t&&(this._licenseRequested=!0,this._disableBufferingBeforeLicense&&this._onTimeUpdate())}))};this._disableLicensePrefetch?this.once(yt.INTERNAL_ENCRYPTED,r):this._buffer.once(yt.BUFFER_SOURCE_OPEN,r),this._player.src=URL.createObjectURL(this._buffer.getMediaSource());const i=n.getVideoProfile(),s=n.getAudioProfile();return s||i?(this._tracker.trackVideoLoadStart({bitrate:null==i?void 0:i.video_bitrate,audioProfile:null!=s?s:void 0,videoProfile:null!=i?i:void 0}),this._tracker.trackBufferLoadStart(),this._prepareSubtitleElements(),this._buffer.appendFragment(n,n.getInitFragment()).then((()=>this._buffer.setDuration(n.getCalculatedDuration()))).then(this._onAppendedHeadSegment(t))):Promise.resolve(!1)}_loadHLSProtectedTrack(e,t){if(En.info("Load HLS Protected Track"),!this._player||!this._currentContent)return!1;const n=this._currentContent.getResolvedURL();if(!n)return!1;const r=e=>{e.data.fromPolyfill&&(this.removeListener(yt.INTERNAL_ENCRYPTED,r),this._requestLicense(t,{initData:e.data.initData}))};return this.on(yt.INTERNAL_ENCRYPTED,r),"video"===this._currentContent.getMediaType()&&this._prepareSubtitleElements(),this._tracker.trackBufferLoadStart(),this._tracker.trackBufferURL(n,{bandwidth:0}),this._player.src=this._currentContent.getHLSURL(),this._player.load(),!0}_loadUnprotectedTrack(){if(!this._player||!this._currentContent)return!1;const e=this._currentContent.getResolvedURL();return!!e&&(En.info("_loadUnprotectedTrack",this._currentContent.getURI()),this._tracker.trackBufferLoadStart(),this._tracker.trackBufferURL(e,{bandwidth:0}),this._player.src=e,this._player.load(),!0)}_onAppendedHeadSegment(e){return()=>e===this._playId&&(this._player&&this._player.spload&&this._player.spload(),En.info("Head segment appended."),!0)}_loadProtectedTrack(e,t){if(!(this._currentContent&&this._player&&this._currentContent instanceof hn))return Promise.resolve(!1);const n=this._currentContent;En.info("_loadProtectedTrack",n.getURI());const r=()=>this._requestLicense(t).then((()=>{this._playId===t&&(this._licenseRequested=!0,this._disableBufferingBeforeLicense&&this._onTimeUpdate())}));this._disableLicensePrefetch?this.once(yt.INTERNAL_ENCRYPTED,r):this._buffer.once(yt.BUFFER_SOURCE_OPEN,r),this._player.src=URL.createObjectURL(this._buffer.getMediaSource()),this._tracker.trackBufferLoadStart();const i=n.getFragmentForTime(e.position);let s=null;return i===n.getFirstFragment()?(En.info("Appending combined init and playable fragment."),s=this._buffer.appendFragment(n,n.getHeadFragment())):(En.info("Appending split init and playable fragment."),s=this._buffer.appendFragment(n,i)),s.then(this._onAppendedHeadSegment(t)).then((()=>Promise.resolve(t===this._playId)))}_requestLicense(e,t={}){if(e!==this._playId){const e="Request license dropped: playId has changed.";return En.info(e),Promise.resolve(!1)}if(!this._player||!this._currentContent||!this._emeManager)return Promise.resolve(!1);const n=Date.now(),r=this._player.mediaKeys,i=this._currentContent,s=i.getFileId(),o=i.getLogData(),a=i.toLogJSON(),c=i.getKeySystem(),l=i.getLicenseEndpoint();let u;if(l)u=Promise.resolve(l);else{if(!s)return Promise.reject(new TypeError("Missing: fileId or licenseEndpoint"));u=this._licenseURLResolver.get(c,i.getMediaType()).then((e=>e.replace(/\{contentId\}/,s)))}const d=this._emeManager,p=this._tracker;return p.setKeySystem(c),p.setKeySystemImpl(d.getKeySystemImpl()),Promise.all([u,i.getInitParams()]).then((([i,s])=>{p.setLicenseSessionLatency(Date.now()-n);const o=s.initDataType,a=t.initData||s.initData;if(r&&a&&o){const t=Object.assign(Object.assign({},s),{playId:e,initData:a,mediaKeys:r,licenseServer:i,initDataType:o});return d.createSessionWithParams(t)}return Promise.resolve(!1)})).then((t=>{if(e!==this._playId)return En.info("License tracking dropped: playId has changed."),Promise.resolve(!1);"boolean"!=typeof t&&"elapsed"in t&&(p.setLicenseGenerationLatency(t.elapsed.generate),p.setLicenseRequestLatency(t.elapsed.request),p.setLicenseUpdateLatency(t.elapsed.update));const r=Date.now()-n;return p.setKeyLatency(r),this.emit(yt.PLAYER_KEY_RECEIVED,{requestTime:r,logData:o}),En.info("License updated."),Promise.resolve(!0)})).catch((t=>{if(!t||e!==this._playId)return Promise.resolve(!1);const n=!t||!("canPlayNext"in t)||t.canPlayNext;return this._emitError(t,n,a),Promise.reject(t)}))}_onTimeUpdate(){var e;if(!this._loaded||!(null===(e=this._player)||void 0===e?void 0:e.src)||!this._currentContent)return;const t=this._currentContent,n=this._player.seeking,r=this._player.currentTime,i="video"===t.getMediaType();if(t.isProtected()&&this._disableBufferingBeforeLicense&&!this._licenseRequested)return void En.log("Dropping time update event: buffering before license disabled.");if(!n&&this._lastTimeUpdatePostion&&this._lastTimeUpdatePostion===r)return void En.warn("Dropping duplicate time update.");this._lastTimeUpdatePostion=n?0:r,t.getKeySystem()!==vt.FAIRPLAY&&(i||t.isProtected())&&this._buffer.progress(t,n,r);const s=this._player.duration,o=Tn(r),a=t.getLogData();n?(this._tracker.trackPositionChanged(o,this._player.paused),this.emit(yt.PLAYER_POSITION_CHANGED,{position:o,logData:a})):(this._tracker.trackProgress(o,"getCurrentBitrate"in t?t.getCurrentBitrate():0),this.emit(yt.PLAYER_PROGRESS,{timestamp:Date.now(),position:o,played:this._tracker.getMSPlayed(),interval:500,logData:a})),!this._canPreloadEmitted&&s-r<=10?(this._canPreloadEmitted=!0,this.emit(yt.PLAYER_CAN_PRELOAD,null)):this._canPreloadEmitted=!1,clearTimeout(this._syntheticEndedToken),this._synthesizeEnded&&t.isProtected()&&this._isPlaying()&&(this._syntheticEndedToken=setTimeout(this._onSyntheticEnded,Tn(s-r)))}_isPlaying(){return!!this._player&&!this._player.paused}_createAudioContent(e,t){const n={manifestLatency:0,resolveLatency:0};return(this._emeManager?this._emeManager.getKeySystemInfo():Promise.resolve({keySystem:vt.INVALID_SPOTIFY_KEY})).then((r=>hn.create({abrManager:this._abrManager,keySystem:r.keySystem,licenseEndpoint:t.licenseEndpoint,transport:this._transport,resolver:this._audioResolver,uri:e,fileId:t.fileId,fileFormat:t.fileFormat,format:t.format,isAd:t.isAd,resolvedURL:t.resolvedURL,noManifest:t.noManifest,preloadedManifest:t.preloadedManifest,logData:t.logData,disableCache:this._disableCache,emitWarning:this._emitWarning}).load(n))).then((e=>{const r=this._tracker;return r.setResolveLatency(n.resolveLatency),r.setManifestLatency(n.manifestLatency),e.isProtected()&&t.fileId&&!this._disableCache&&this._cache.set(t.fileId,e),e}))}_createVideoContent(e,t){const n={manifestLatency:0,resolveLatency:0},r=t.fileId;return(this._emeManager?this._emeManager.getKeySystemInfo():Promise.resolve({keySystem:vt.INVALID_SPOTIFY_KEY,audioFormats:[],videoFormats:[]})).then((i=>un.create({uri:e,abrManager:this._abrManager,resolver:this._videoResolver,keySystem:i.keySystem,licenseEndpoint:t.licenseEndpoint,fileId:r,format:bt.MANIFEST_ID,isAd:t.isAd,transport:this._transport,videoFormats:i.videoFormats,videoResolution:this._videoResolution,audioFormats:i.audioFormats,disableCache:this._disableCache,disallowProfile:this._disallowProfile}).load(n))).then((e=>{const t=this._tracker;return t.setResolveLatency(n.resolveLatency),t.setManifestLatency(n.manifestLatency),e.isProtected()&&r&&!this._disableCache&&this._cache.set(r,e),e}))}_preinitMediaElement(){return this._player||!this._emeManager?Promise.resolve(this):this._emeManager.getKeySystemInfo().then((e=>{var t,n;const r=[];return(null===(t=e.audioFormats)||void 0===t?void 0:t[0])&&r.push(e.audioFormats[0].contentType),(null===(n=e.videoFormats)||void 0===n?void 0:n[0])&&r.push(e.videoFormats[0].contentType),!!r.length&&this._recreateMediaElement(r,this._playId,r.length>1?"video":"audio",e.keySystem!==vt.FAIRPLAY)})).then((()=>this),(e=>(En.warn("Cannot precreate media element:",null==e?void 0:e.message),this)))}getCodecInfo(){return{audiocodec:"mp3",bitrate:160}}getMediaSource(){return this._buffer.getMediaSource()}load(e,t,n){const r=function(e,t){return t&&t.hasOwnProperty(e)}(t.uriProperty,e)?t.uriProperty:"uri",i=e[r];if(En.info("load",i),!i)return Promise.reject(new Tt(H.PLAYER_CANNOT_FIND_PLAYABLE_URI,"Cannot find a playable URI."));if(!e.logData)return Promise.reject(new Error("Invalid track: logging info not specified"));if(t.stopPosition&&t.stopPosition<=t.position)return Promise.reject(new TypeError("Invalid options: `stopPosition` cannot be less or equal to `position`"));this.stop(e.logData,e.mediaType),this._loaded=!1,this._licenseRequested=!1,this._buffering=!0,this._currentContent=null;const s=++this._playId,o=this._tracker;o.trackLoadStart(i,e.fileId,s.toString(),e.logData),this.emit(yt.PLAYER_BEFORE_LOAD,{track:e,options:t,logData:e.logData,uri:i,timestamp:Date.now()}),this._buffer.setPlayId(s);const a={position:Cn(t.position||0),autoplay:!("autoplay"in t)||t.autoplay,callback:n};let c;o.setPlayIntended(a.autoplay),o.setPlayedThreshold(t.playedThreshold);const l=this._cache;if("video"===e.mediaType&&!this._emeManager)return Promise.reject(new Tt(H.DISALLOW_PROTECTED_TRACK_ERROR,"Protected tracks not supported"));const u="video"===e.mediaType?this._createVideoContent.bind(this,i,e):this._createAudioContent.bind(this,i,e,s);if(e.fileId){const t=e.fileId,n=this._preloadingTracks[t],r=this._disableCache?null:l.get(t);n?(En.info("Waiting for preloading track.",t),c=n.then((e=>(En.info("Preloading succeeded.",t),o.setResolveLatency(e.resolveLatency),o.setManifestLatency(e.manifestLatency),l.get(t))),(()=>(En.info("Preloading failed, creating new track",t),u())))):r?(En.info("Using cached track.",t,r),o.setMemoryCached(!0),c=Promise.resolve(r)):(En.info("Creating new track from fileId",t),c=u())}else En.info("Creating new track without fileId",e.resolvedURL),c=u();return c.then((n=>{var r;return n.isProtected()&&!this._emeManager?Promise.reject(new Tt(H.DISALLOW_PROTECTED_TRACK_ERROR,"Protected tracks not supported")):(n.setStopPosition(null!==(r=t.stopPosition)&&void 0!==r?r:null),n.setLogData(e.logData),o.setCalculatedDuration(Tn(n.getCalculatedDuration())),this._upcomingContent=n,Promise.resolve())})).then(this._prepareMediaElement.bind(this,a,s)).then(this._loadContent.bind(this,a,s)).then(this._handleLoadingComplete,this._handleLoadingError.bind(this,i,e,s))}preload(e){const t=!this._disableCache,n=e.uri,r=e.fileId,i=this._cache;if(!t||!r||!this._emeManager)return Promise.resolve(null);const s="video"===e.mediaType;if(!(bn[e.format]&&!s)||i.get(r))return Promise.resolve(null);const o=this._preloadingTracks;if(o[r])return o[r];En.info("Preloading track",r);const a={manifestLatency:0,resolveLatency:0},c=this._emeManager.getKeySystemInfo().then((t=>hn.create({abrManager:this._abrManager,keySystem:t.keySystem,licenseEndpoint:e.licenseEndpoint,transport:this._transport,resolver:this._audioResolver,uri:n,fileId:r,format:e.format,fileFormat:e.fileFormat,isAd:e.isAd,resolvedURL:e.resolvedURL,noManifest:e.noManifest,preloadedManifest:e.preloadedManifest,logData:e.logData,disableCache:this._disableCache,emitWarning:this._emitWarning}).load(a))).then((t=>Promise.all([t,"MP4_CBCS"!==e.format?t.getBufferForFragment(t.getHeadFragment()):null]))).then((([e])=>(i.set(r,e),delete o[r],En.info("Cached",r),a))).catch((e=>(delete o[r],En.warn("Preloading error",e),this.emit(yt.PLAYER_PRELOADING_ERROR,{error:e,track:e.track||null,canPlayNext:!("canPlayNext"in e)||e.canPlayNext,preloading:!0}),Promise.reject(e))));return o[r]=c,c}togglePlay(){return this._isPlaying()?this.pause():this.resume()}setSubtitleLanguage(e){this._player&&this._currentContent&&this._currentContent instanceof un&&(this._activeSubtitleLanguage=e,this._subtitlesVisible&&this.showSubtitles())}getSubtitleLanguages(){return this._currentContent instanceof un?this._currentContent.getSubtitleLanguages():[]}getActiveSubtitleLanguage(){return this._getActiveSubtitleLanguage()}setVolume(e,t){if(!this.emitSync(yt.PLAYER_BEFORE_VOLUME_CHANGE,{volume:e,options:t}).defaultPrevented){if(e<0||e>1)throw new Tt(H.PLAYER_ATTEMPTED_VOLUME_OUT_OF_RANGE,"Volume should be in range [0, 1]");this._playerVolume=e,this._player&&(this._player.volume=this._cubicVolume?e*e*e:e)}}getVolume(){return this._playerVolume}getPlayerState(){var e;const t=this._player;return{playing:this._isPlaying(),position:t?Tn(t.currentTime):0,duration:t?Tn(t.duration):0,volume:null!==(e=this._playerVolume)&&void 0!==e?e:1,buffering:this._buffering}}seek(e){if(!this._player)return;const t=this._playId,n=()=>{if(!this._player||t!==this._playId)return void En.info("Seek dropped: playId has changed.");let n=Cn(e);n<0?n=0:n>=this._player.duration&&(n=this._player.duration),this._player.currentTime=n};this._loaded?n():this.once(yt.PLAYER_LOAD,n),this._getBufferingLatency().then((e=>{this._tracker.trackSeekRebuffering(e)}))}pause(){return new Promise((e=>{this._player&&this._isPlaying()?e(this._player&&this._player.pause()):e()}))}resume(){return new Promise((e=>{this._player&&!this._isPlaying()?e(this._player&&this._player.play()):e()}))}stop(e,t){const n=[],r=e||{};this.emit(yt.PLAYER_BEFORE_STOP,{timestamp:Date.now(),logData:r}),this._tracker.trackStopped(e),this._buffer.abort(!0),this._emeManager&&n.push(this._emeManager.destroySessions());const i=this._player;if(i){this._removeSubtitleElements(),this._fatalOnNextError=this._shouldNextErrorBeFatal(),this._fatalOnNextError&&En.warn("MediaError detected: next immediate media error will be fatal.");const e=i.src;Sn.test(e)&&URL.revokeObjectURL(e),i.removeAttribute("src"),i.load()}if(this._currentContent&&this._disableCache&&this._currentContent.clearCachedBuffers(),i&&this._currentContent&&"video"===this._currentContent.getMediaType()){const e=this._getContainerElement(this._videoPlayerContainer);e&&i.parentNode===e&&(this._newElementPerTrack||"video"!==t)&&(e.removeChild(i),this.emit(yt.PLAYER_VIDEO_ELEMENT_REMOVED,null))}else if(i&&this._currentContent&&"audio"===this._currentContent.getMediaType()){const e=this._getContainerElement(this._audioPlayerContainer);e&&i.parentNode===e&&(this._newElementPerTrack||"audio"!==t)&&e.removeChild(i)}return this.emit(yt.PLAYER_STOPPED,null),Promise.all(n).then((()=>!0))}hideSubtitles(){if(!this._player)return;const e=this._player.textTracks;for(let t=0,n=e.length;t<n;t++)e[t].mode=Et.HIDDEN;this._subtitlesVisible=!1}showSubtitles(){if(!this._player)return;const e=this._getActiveSubtitleLanguage(),t=this._player.textTracks;for(let n=0,r=t.length;n<r;n++){const r=t[n];r.language.toLowerCase()===e?r.mode=Et.SHOWING:r.mode=Et.HIDDEN}this._subtitlesVisible=!0}areSubtitlesShown(){return this._subtitlesVisible}getKeySystemInfo(){return this._emeManager?this._emeManager.getKeySystemInfo():Promise.resolve(null)}getVideoVariants(){if(!(this._currentContent&&this._currentContent instanceof un))return[];const e=[],t=this._currentContent.getVideoProfiles();for(let n=0,r=t.length;n<r;n++){const r=t[n];e.push({width:r.video_width,height:r.video_height,bitrate:r.video_bitrate})}return e}setPreferredBitrate(e){return"number"!=typeof e?Promise.resolve(St.INVALID):(this._preferredBitrate=e,this._currentContent&&"video"===this._currentContent.getMediaType()&&e>0&&this._buffer.abort(!0),this._abrManager.overrideBitrate(e),Promise.resolve(St.SUCCESS))}getCurrentBandwidth(){return this._abrManager.getBandwidthEstimate()}setBackgrounded(e){this._abrManager.overrideBitrate(e?1e-32:this._preferredBitrate)}setVideoResolution(e){this._videoResolution=Object.assign(Object.assign({},this._videoResolution),e),this._currentContent instanceof un&&this._currentContent.setVideoResolution(this._videoResolution)}activateElement(){return!(this._playerActivated||!this._player||this._player.src)&&(this._player.load(),this._playerActivated=!0,!0)}getMediaConfig(){return void 0===this._mediaConfig?function(e,t){const n=t||document.createElement("video"),r=e=>{n.canPlayType("audio/mp3")&&(e.formats.audio.push("audio/mp3"),e.supports.unprotected_audio=!0)};if(e)return e.getKeySystemInfo().then((e=>{const t={supports:{protected_audio:!!e.audioFormats.length,unprotected_audio:!0,protected_video:!!e.videoFormats.length,unprotected_video:!0},formats:{audio:e.audioFormats.map((e=>e.contentType)),video:e.videoFormats.map((e=>e.contentType))}};return t.keysystem=e.keySystem,t.keysystem_impl=e.keySystemImpl,r(t),t}));const i=zt([qt[0]],(e=>"probably"===n.canPlayType(e.split(";")[0])));let s=[],o=[];i&&(s=i.audioCapabilities.map((e=>e.contentType)),o=i.videoCapabilities.map((e=>e.contentType)));const a={supports:{protected_audio:!1,unprotected_audio:!!s.length,protected_video:!1,unprotected_video:!!o.length},formats:{audio:s,video:o}};return r(a),Promise.resolve(a)}(this._emeManager,this._player).then((e=>(this._mediaConfig=e,this._mediaConfig))):Promise.resolve(this._mediaConfig)}}var Pn=n(899);class An extends Error{constructor(e,t){super(t),this.debug={},this.name="LoggingError",this.message=t,this.code=e}}var On="7.8.1-0ad1d7f";const kn=mt("playback.logger");class Ln extends ne.vp{constructor(e){super(),this._currentTrackingData=null,this._sequenceId=0,this._sequenceSessionStorage={},this._sessionId="0",this._transport=e.transport,this._logSender=e.logSender,this._player=e.player,this._init()}static create(e){return new Ln(e)}_init(){const e=this._player;e.on(yt.PLAYER_LOAD,this._onPlayerLoad.bind(this)),e.on(yt.PLAYER_ERROR,this._onError.bind(this,!1)),e.on(yt.PLAYER_WARNING,this._onError.bind(this,!0)),e.on(yt.PLAYER_PRELOADING_ERROR,this._onError.bind(this,!1)),e.on(yt.PLAYER_TRACKING_DATA_CREATED,this._onTrackingDataCreated.bind(this)),e.on(yt.PLAYER_TRACKING_DATA_FINALIZED,this._onTrackingDataFinalized.bind(this)),e.on(yt.PLAYER_PLAYBACK_START,this._onPlaybackStart.bind(this))}_emitError(e,t){this.emit(yt.LOGGER_ERROR,{error:e,trackingData:t})}_onError(e,t){var n,r,i;const s=t.data,o=this._currentTrackingData;if(!o||o.noLog)return;const a=s.error,c=null!==(n=null==a?void 0:a.debug)&&void 0!==n?n:{};c.position="position"in s?s.position:0;const l={track:s.track||{},debug:c,preloading:"preloading"in s&&!!s.preloading,session_id:this._sessionId,playback_id:o.playbackId||null,player_play_id:"playId"in s?s.playId:null,http_status_code:null!==(r=null==a?void 0:a.status)&&void 0!==r?r:null,license_server:null!==(i=null==a?void 0:a.licenseServer)&&void 0!==i?i:null};this._logError(a.code||H.UNKNOWN,a,l,o,e)}_onPlayerLoad(e){const t=e.data.logData;if(t)if(t.impressionURLs){let e=t.impressionURLs.length;for(;e--;)this._logImpression(t.impressionURLs[e])}else t.impressionURL&&this._logImpression(t.impressionURL)}_onPlaybackStart(e){const t=e.data.trackingData;t.noLog||t.noStats||this._logPlaybackStart(t)}_onTrackingDataCreated(e){const t=e.data.trackingData;t.noLog?this._currentTrackingData=null:(this._currentTrackingData=t,this._setSessionId(),t.noTSV||this._setSequenceId())}_setSessionId(){this._sessionId=this._transport.getInitTime().toString()}_setSequenceId(){this._sessionId&&(this._sequenceId=this._getSequenceId(this._sessionId))}_onTrackingDataFinalized(e){const t=e.data.trackingData;if(t.noLog)return;const n=this._sessionId!==this._transport.getInitTime().toString();if(n&&this._setSessionId(),t.playbackId&&!t.noTSV){if(n&&this._setSequenceId(),!t.playIntended&&!t.played)return void this._rollbackSequenceId(this._sessionId);this._logTrackStreamVerification(t)}t.noStats||this._logPlaybackStats(t)}_logTrackStreamVerification(e){const t={play_track:e.currentTrackUri,playback_id:e.playbackId,ms_played:e.msPlayed,session_id:this._sessionId,sequence_id:this._sequenceId,next_playback_id:e.nextPlaybackId};kn.debug("Logged TrackStreamVerification",t),this._logSender.logTrackStreamVerification(t).catch((n=>{const r=new An(H.TSV_SENDING_FAILED,n.message||"Unknown reason.");this._logError(r.code,n,t,e,!1),this._emitError(r,e)}))}_logPlaybackStats(e){const t={play_track:e.currentTrackUri,file_id:e.fileId,playback_id:e.playbackId,internal_play_id:e.internalPlayId,memory_cached:e.memoryCached,persistent_cached:e.persistentCached,audio_format:e.audiocodec||"",video_format:e.videocodec||"",manifest_id:e.fileId,protected:!1,key_system:e.keySystem,key_system_impl:e.keySystemImpl,urls_json:JSON.stringify(e.urls),start_time:e.loadTime,end_time:e.stopTime,external_start_time:e.externalLoadTime,ms_play_latency:e.msPlayLatency,ms_init_latency:e.msInitLatency,ms_head_latency:e.msHeadLatency,ms_manifest_latency:e.msManifestLatency,ms_resolve_latency:e.msResolveLatency,ms_license_session_latency:e.msLicenseSessionLatency,ms_license_generation_latency:e.msLicenseGenerationLatency,ms_license_request_latency:e.msLicenseRequestLatency,ms_license_update_latency:e.msLicenseUpdateLatency,ms_played:e.msPlayed,ms_nominal_played:e.msPlayed,ms_file_duration:e.msFileDuration,ms_actual_duration:e.msActualDuration,ms_start_position:e.startPosition,ms_end_position:e.position,ms_seek_rebuffer:e.msSeekRebuffering,ms_seek_rebuffer_longest:e.maxMsSeekRebuffering,ms_stall_rebuffer:e.msStalled,ms_stall_rebuffer_longest:e.maxMsStalled,n_stalls:e.nStalls,n_seekback:e.nSeeksBackward,n_seekforward:e.nSeeksForward,start_bitrate:e.startBitrate||e.bitrate||0,audio_quality:e.audioQuality,time_weighted_bitrate:e.timeWeightedBitrate,reason_start:e.reasonStart,reason_end:e.reasonEnd,initially_paused:!e.playIntended,had_error:e.hadError,n_warnings:e.nWarnings,n_navigator_offline:e.nOffline,session_id:this._sessionId,sequence_id:this._sequenceId,client_id:e.clientId,correlation_id:e.correlationId};kn.info("Logging PlaybackStats"),this._logSender.logJSSDKPlaybackStats(t).catch((n=>{const r=new An(H.PLAYBACK_STATS_SENDING_FAILED,n.message||"Unknown reason.");this._logError(r.code,n,t,e,!1),this._emitError(r,e)}))}_logPlaybackStart(e){const t={play_track:e.currentTrackUri,file_id:e.fileId,playback_id:e.playbackId,session_id:this._sessionId,ms_start_position:e.startPosition,initially_paused:!e.playIntended,client_id:e.clientId,correlation_id:e.correlationId};kn.info("Logging PlaybackStart"),this._logSender.logJSSDKPlaybackStart(t).catch((n=>{const r=new An(H.PLAYBACK_START_SENDING_FAILED,n.message||"Unknown reason.");this._logError(r.code,n,t,e,!1),this._emitError(r,e)}))}_getSequenceId(e){let t=this._sequenceSessionStorage[e];return t||(t=0),t+1>=9007199254740991&&(t=0),this._sequenceSessionStorage[e]=t+1,t}_rollbackSequenceId(e){const t=this._sequenceSessionStorage[e];t&&(this._sequenceSessionStorage[e]=Math.max(t-1,0))}_logImpression(e){this._transport.request(e,{forget:!0}).catch((function(e){kn.warn("Unable to send impression request",e)}))}_logError(e,t,n,r,i){let s="";t&&(s=t.stack||"",s||(s=t.toString()));const o={source:"playback",source_version:On||Pn.eV.UNKNOWN,type:e||Pn.eV.UNKNOWN,message:t&&t.message||Pn.eV.EMPTY,stack:JSON.stringify(s),json_data:JSON.stringify(n||{}),json_data_version:"1.0.0",client_id:r.clientId,correlation_id:r.correlationId};i?this._logSender.logJSSDKWarning(o).catch((e=>kn.warn("Failed to log warning",o,e))):this._logSender.logJSSDKError(o).catch((e=>kn.warn("Failed to log error",o,e)))}}class wn extends Error{constructor(e=H.STORAGE_ERROR,t="Storage Error"){super(t),this.status=-1,this.fileId="",this.debug={},this.canPlayNext=!0,this.code=e,this.message=t,this.name="StorageError"}}const Dn=mt("playback.storage_resolve");class Nn{constructor(e){this._transport=e}_parseResponse(e,t){let n;if(200!==t.status)return n=new wn(H.STORAGE_FAILED_WITH_STATUS,`Storage Resolve responded with ${t.status}`),n.status=t.status,n.fileId=e,Promise.reject(n);const r=t.body;if(!r||!r.cdnurl||!r.cdnurl.length)return n=new wn(H.STORAGE_RETURNED_NO_TRACKS,`Storage Resolve returned no tracks for fileId ${e}`),n.fileId=e,Promise.reject(n);const i={uri:r.cdnurl[0],uris:r.cdnurl,protection:"cenc"};return Promise.resolve(i)}getCDNURL(e,t){Dn.info("Requesting CDN URL for ",e);const n="files/audio/interactive",r=`@webgate/storage-resolve/${t?`v2/${n}/${t}/${e}`:`${n}/${e}`}?version=10000000&product=9&platform=39&alt=json`;return this._transport.request(r,{responseType:"json",retry:{condition:(e,t)=>e.getStatusFamily()!==t.SUCCESS}}).then(this._parseResponse.bind(this,e))}getManifest(e){const t=`https://seektables.scdn.co/seektable/${e}.json`;return Dn.info("Requesting JSON manifest for ",e),this._transport.request(t,{responseType:"json",retry:{condition:(e,t)=>e.getStatusFamily()!==t.SUCCESS}}).then((t=>{let n;return 200!==t.status?(n=new wn(H.STORAGE_TRACK_MANIFEST_FAILED,`Track manifest request failed with status code ${t.status}`),n.debug.file_id=e,n.status=t.status,Promise.reject(n)):t.body?t.body:(n=new wn(H.STORAGE_TRACK_MANIFEST_EMPTY,"Received empty manifest."),n.debug.file_id=e,n.status=t.status,Promise.reject(n))}))}}class Un extends Error{constructor(e,t){super(t),this.debug={},this.name="TrackingError",this.message=t,this.code=e}}class Mn{constructor(){this._version="1.0.0",this._list=new at.Su,this._map={}}clear(){this._list=new at.Su,this._map={}}track(e,t){let n=this._map[e];n||(n=new at.EG({url:e,segments:0,bandwidths:[]}),this._list.append(n),this._map[e]=n);const{value:r}=n;r&&(r.segments+=1,r.bandwidths.push(t.bandwidth))}toJSON(){const e=[];let t=this._list.first;for(;t;){const{value:n}=t;if(!n)continue;const{bandwidths:r}=n;let i=0,s=r.length;for(;s--;)i+=r[s];e.push({url:n.url,segments:n.segments,avg_bw:parseFloat((i/r.length).toFixed(7))}),t=t.next}return{version:this._version,urls:e}}}class Bn{constructor(){this._bitrates={},this._isFinalized=!1,this._needsEndSegment=!1,this._segments=[],this._cdnURLTracker=new Mn,this.audiocodec=null,this.bandwidth=0,this.bitrate=0,this.audioQuality=void 0,this.bufferingPercentage=0,this.bufferLoadStartTime=0,this.urls={},this.currentTrackUri="",this.displayTrack="",this.externalLoadTime=0,this.fileId="",this.gaiaDevId="none",this.hadError=!1,this.internalPlayId="",this.isProtected=!1,this.keySystem="",this.keySystemImpl="",this.lastPlayStartTime=0,this.loadTime=0,this.localTimeMs=-1,this.maxContinuous=0,this.maxMsSeekRebuffering=0,this.maxMsStalled=0,this.memoryCached=!1,this.msActualDuration=0,this.msFileDuration=0,this.msHeadLatency=0,this.msInitLatency=0,this.msKeyLatency=0,this.msLicenseGenerationLatency=0,this.msLicenseRequestLatency=0,this.msLicenseSessionLatency=0,this.msLicenseUpdateLatency=0,this.msManifestLatency=0,this.msPlayed=0,this.msPlayedUnion=0,this.msPlayLatency=0,this.msResolveLatency=0,this.msSeekRebuffering=0,this.msSeeksBackward=0,this.msSeeksForward=0,this.nextPlaybackId="",this.nOffline=0,this.noLog=!1,this.noTSV=!1,this.noStats=!1,this.nWarnings=0,this.msStalled=0,this.nSeeksBackward=0,this.nSeeksForward=0,this.nStalls=0,this.persistentCached=!1,this.playbackId="",this.playContext="",this.played=!1,this.position=0,this.reasonEnd="unknown",this.reasonStart="unknown",this.referrer="unknown",this.referrerVendor="unknown",this.referrerVersion="unknown",this.sourceEnd="unknown",this.sourceStart="unknown",this.startPosition=0,this.stopTime=0,this.streamingRule="none",this.timeWeightedBitrate=0,this.totalBytes=0,this.playIntended=!1,this.videocodec=null,this.clientId="unknown",this.correlationId="unknown"}static create(){return new Bn}_calculateUnion(){const e=this._segments.slice(0);let t=0,n=0,r=0,i=0,s=0,o=0,a=this.maxContinuous;for(;s<e.length;s++)s%2!=0&&void 0!==e[s-1]&&"start"===e[s-1].type&&(o=e[s].time-e[s-1].time,a=o>a?o:a);for(this.maxContinuous=a,e.sort(((e,t)=>e.time-t.time));i<e.length;i++)"start"===e[i].type&&(0===n&&(r=i),++n),"end"===e[i].type&&(--n,0===n&&(t+=e[i].time-e[r].time));return t}_calculateWeightedBitrate(e){const t=this._bitrates;let n=0;for(const r in t)r&&t.hasOwnProperty(r)&&e>0&&(n+=parseInt(r,10)*t[r]/e);return Math.round(n)}registerVideoVariant(e){const t=e.bitrate;t&&(this._bitrates[t]=this._bitrates[t]||0,this.startBitrate||(this.startBitrate=t)),e.audioProfile&&e.audioProfile.audio_codec&&(this.audiocodec=e.audioProfile.audio_codec),e.videoProfile&&e.videoProfile.video_codec&&(this.videocodec=e.videoProfile.video_codec)}addStartSegment(){this._segments.push({type:"start",time:this.position}),this._needsEndSegment=!0}addEndSegment(){this._needsEndSegment&&(this._segments.push({type:"end",time:this.position}),this._needsEndSegment=!1)}addMSPlayed(e){e&&(this.msPlayed+=e)}trackBitrate(e,t){const n=e||"dummy";this._bitrates[n]=this._bitrates[n]||0,this._bitrates[n]+=t}trackBufferURL(e,t){this._cdnURLTracker.track(e,t)}finalize(){if(this._isFinalized)throw new Un(H.TRACK_DATA_ALREADY_FINALIZED,"TrackData already finalized.");return this.msPlayedUnion=this._calculateUnion(),this.nSeeksBackward||this.nSeeksForward||(this.msPlayed=this.maxContinuous=this.msPlayedUnion),this.timeWeightedBitrate=this._calculateWeightedBitrate(this.msPlayed),this.bufferingPercentage=this.msStalled/this.msPlayed,this.startBitrate||(this.startBitrate=this.bitrate),this.urls=this._cdnURLTracker.toJSON(),this._isFinalized=!0,!0}getURLsJSON(){var e,t;return null!==(t=null===(e=this._cdnURLTracker.toJSON().urls)||void 0===e?void 0:e.map((({url:e})=>e)))&&void 0!==t?t:[]}getPlaybackStats(){let e;switch(this.keySystem){case vt.WIDEVINE:e="widevine";break;case vt.PLAYREADY:case vt.PLAYREADY_HARDWARE:e="playready";break;default:e="none"}return{ms_total_est:this.msActualDuration,ms_manifest_latency:this.msManifestLatency,ms_latency:this.msPlayLatency,start_offset_ms:this.startPosition,ms_initial_buffering:this.msPlayLatency,ms_seek_rebuffering:this.msSeekRebuffering,ms_stalled:this.msStalled,max_ms_seek_rebuffering:this.maxMsSeekRebuffering,max_ms_stalled:this.maxMsStalled,n_stalls:this.nStalls,audiocodec:this.audiocodec?this.audiocodec.toLowerCase():void 0,videocodec:this.videocodec?this.videocodec.toLowerCase():void 0,start_bitrate:this.startBitrate||this.bitrate||void 0,full_screen:void 0,time_weighted_bitrate:this.timeWeightedBitrate,buffering_percentage:void 0,prefetched_bytes:void 0,prefetched_bytes_loaded:void 0,prefetched_initial_bitrate:void 0,key_system:e,ms_key_latency:this.msKeyLatency,total_bytes:this.totalBytes,local_time_ms:this.localTimeMs,ms_played_background:void 0}}isFinalized(){return this._isFinalized}}const xn=mt("playback.tracker");class Fn extends ne.vp{constructor(e={}){super(),this._playedThreshold=31e3,this._playedThresholdReached=!1,this._trackingData=null,this._playedThreshold=e.playerThreshold||31e3}static create(e){return new Fn(e)}_checkPlayedThreshold(){const e=this._trackingData;!e||!this._playedThreshold||this._playedThresholdReached||e.msPlayed<this._playedThreshold||(this._playedThresholdReached=!0,this.emit(yt.TRACKER_PLAYED_THRESHOLD_REACHED,{played:e&&e.msPlayed||0,threshold:this._playedThreshold}))}getMSPlayed(){return this._trackingData?this._trackingData.msPlayed:0}trackLoadStart(e,t,n,r){const i=Bn.create();this._trackingData=i,this._playedThresholdReached=!1,i.fileId=null!=t?t:"",i.currentTrackUri=e,i.loadTime=Date.now(),i.internalPlayId=n,i.externalLoadTime=r.externalLoadTime||0,i.displayTrack=r.displayTrack||"",i.playbackId=r.playbackId||"",i.playContext=r.playContext||"",i.reasonStart=r.reason||"unknown",i.sourceStart=r.source||"unknown",i.clientId=r.clientId||"",i.correlationId=r.correlationId||"";const s=r.referrer||{};i.referrer=void 0!==s.name?s.name:"unknown",i.referrerVersion=void 0!==s.version?s.version:"unknown",i.referrerVendor=void 0!==s.vendor?s.vendor:"unknown";const o=r.format||{};o.codec&&(i.audiocodec=o.codec.toLowerCase()),o.bitrate&&(i.bitrate=o.bitrate),o.audioQuality&&(i.audioQuality=o.audioQuality),i.gaiaDevId=r.deviceId||"none",i.noLog=r.noLog||!1,i.noTSV=r.noTSV||!1,i.noStats=r.noStats||!1,this.emit(yt.TRACKER_TRACKING_DATA_CREATED,{trackingData:i})}trackBufferLoadStart(){const e=this._trackingData;e&&(e.bufferLoadStartTime=Date.now())}trackBytesDownloaded(e){const t=this._trackingData;t&&(t.totalBytes+=e)}trackLoadDone(e){const t=this._trackingData;if(!t)return;const n=Date.now();t.msInitLatency=n-t.bufferLoadStartTime,t.lastPlayStartTime=n,t.localTimeMs=n,t.position=e,t.startPosition=e,t.addStartSegment()}trackCanPlayThrough(){const e=this._trackingData;if(!e||e.msPlayLatency)return;const t=Date.now();e.msPlayLatency=t-e.loadTime,e.msHeadLatency=t-e.bufferLoadStartTime}trackBufferURL(e,t){const n=this._trackingData;n&&n.trackBufferURL(e,t)}trackNavigatorOffline(){const e=this._trackingData;e&&(e.nOffline+=1)}trackSeekRebuffering(e){const t=this._trackingData;t&&(e>t.maxMsSeekRebuffering&&(t.maxMsSeekRebuffering=e),t.msSeekRebuffering+=e)}trackMsStalled(e){const t=this._trackingData;t&&(e>t.maxMsStalled&&(t.maxMsStalled=e),t.msStalled+=e,t.nStalls++)}trackLoadFailed(){const e=this._trackingData;e&&(e.msPlayLatency=Date.now()-e.loadTime,e.position=0,e.addStartSegment())}trackStopped(e){const t=this._trackingData;if(!t||t.isFinalized())return;const n=Date.now();t.stopTime=n,t.lastPlayStartTime&&(t.addMSPlayed(n-t.lastPlayStartTime),this._checkPlayedThreshold()),t.addEndSegment(),t.sourceEnd=e.source||"unknown",t.reasonEnd=e.reason||"unknown",t.nextPlaybackId=e.playbackId||"",t.finalize(),xn.info("Tracker data finalized.");const r=t.getPlaybackStats();this.emit(yt.TRACKER_TRACKING_DATA_FINALIZED,{trackingData:t,playbackStats:r})}trackPositionChanged(e,t){const n=this._trackingData;if(!n)return;const r=n.position;e!==r&&(n.addEndSegment(),e>r?(n.nSeeksForward++,n.msSeeksForward+=e-r):e<r&&(n.nSeeksBackward++,n.msSeeksBackward+=r-e),t||(n.lastPlayStartTime=Date.now()),n.position=e,n.addStartSegment())}trackPlaying(e){const t=this._trackingData;t&&(t.played||this.emit(yt.TRACKER_PLAYBACK_START,{trackingData:t}),t.played=!0,t.lastPlayStartTime=Date.now(),t.position=e)}trackPaused(e){const t=this._trackingData;t&&(t.lastPlayStartTime=0,t.position=e)}trackProgress(e,t){const n=this._trackingData;if(!(null==n?void 0:n.played))return;const r=Date.now();let i=0;n.lastPlayStartTime&&(i=r-n.lastPlayStartTime),n.lastPlayStartTime=r,n.addMSPlayed(i),this._checkPlayedThreshold(),n.position=e,t&&n.trackBitrate(t,i)}trackVideoLoadStart(e){const t=this._trackingData;t&&t.registerVideoVariant(e)}trackWarning(){const e=this._trackingData;e&&e.nWarnings++}trackOffline(){const e=this._trackingData;e&&e.nOffline++}setActualDuration(e){const t=this._trackingData;t&&(t.msActualDuration=e)}setKeySystem(e){const t=this._trackingData;t&&(t.keySystem=e)}setKeySystemImpl(e){const t=this._trackingData;t&&(t.keySystemImpl=e)}setManifestLatency(e){const t=this._trackingData;t&&(t.msManifestLatency=e)}setPlayIntended(e){const t=this._trackingData;t&&(t.playIntended=e)}setKeyLatency(e){const t=this._trackingData;t&&(t.msKeyLatency=e)}setMemoryCached(e){const t=this._trackingData;t&&(t.memoryCached=e)}setPersistentCached(e){const t=this._trackingData;t&&(t.persistentCached=e)}setProtected(e){const t=this._trackingData;t&&(t.isProtected=e)}setHadError(e){const t=this._trackingData;t&&(t.hadError=e)}setLicenseSessionLatency(e){const t=this._trackingData;t&&(t.msLicenseSessionLatency=e)}setLicenseGenerationLatency(e){const t=this._trackingData;t&&(t.msLicenseGenerationLatency=e)}setLicenseRequestLatency(e){const t=this._trackingData;t&&(t.msLicenseRequestLatency=e)}setLicenseUpdateLatency(e){const t=this._trackingData;t&&(t.msLicenseUpdateLatency=e)}setResolveLatency(e){const t=this._trackingData;t&&(t.msResolveLatency=e)}setCalculatedDuration(e){const t=this._trackingData;t&&(t.msFileDuration=e)}setPlayedThreshold(e){this._playedThreshold=e}}class jn{constructor(e){this._transport=e}static create(e){return new jn(e)}_parseManifestResponse(e){if(200!==e.status){const t=new wn(H.STORAGE_VIDEO_MANIFEST_FAILED,`Video manifest request failed with status ${e.status}`);return t.status=e.status,Promise.reject(t)}return Promise.resolve(e.body)}getInitSegmentURLs(e,t,n,r){let i="";n&&(i=e+t.replace("{{profile_id}}",n.id.toString(10)).replace("{{file_type}}",n.file_type));let s="";return r&&(s=e+t.replace("{{profile_id}}",r.id.toString(10)).replace("{{file_type}}",r.file_type)),{audio:i,video:s,audioLogging:i,videoLogging:s}}getSegmentURLs(e,t,n,r,i){let s="";r&&(s=e+t.replace("{{profile_id}}",r.id.toString(10)).replace("{{file_type}}",r.file_type));let o="";return i&&(o=e+t.replace("{{profile_id}}",i.id.toString(10)).replace("{{file_type}}",i.file_type)),{audio:s.replace("{{segment_timestamp}}",n.toString()),video:o.replace("{{segment_timestamp}}",n.toString()),audioLogging:s,videoLogging:o}}getManifest(e){const t=`@webgate/manifests/v7/json/sources/${e}/options/supports_drm`;return this._transport.request(t,{authorize:!0,responseType:"json",retry:{condition:(e,t)=>e.getStatusFamily()!==t.SUCCESS}}).then(this._parseManifestResponse)}}class Yn extends Error{constructor(e,t){super(),this.status=-1,this.debug={},this.canPlayNext=!0,this.unrecoverable=!1,this.name="LicenseError",this.code=e,this.message=t}static fatal(e,t){const n=new Yn(e,t);return n.unrecoverable=!0,n.canPlayNext=!1,n}}class Kn{constructor(e){this._sdk={name:"",version:""},this._securityLevel=null,this._urls={},e.sdk&&(this._sdk=e.sdk),e.securityLevel&&(this._securityLevel=e.securityLevel),this._transport=e.transport,this._transport.on(this._transport.EVENT_CONNECTION_ID,(()=>{this._urls={}}))}get(e,t){const n=`${e}:${t}`,r=this._urls[n];if(r&&r.expires>Date.now()+6e4)return Promise.resolve(r.uri);const i=`@webgate/melody/v1/license_url?keysystem=${e}&mediatype=${t}&sdk_name=${this._sdk.name}&sdk_version=${this._sdk.version}`;return this._transport.request(i,{responseType:"json",retry:{condition:(e,t)=>{const n=e.getStatusFamily();return n===t.SERVER_ERROR||n===t.CONNECTION_ERROR}}}).then((e=>{const t=e.body;if(t&&200===e.status)return t.expires*=1e3,t.uri=`@webgate/${t.uri}`,this._securityLevel&&(t.uri+=[-1!==t.uri.indexOf("?")?"&":"?","sl=",this._securityLevel].join("")),this._urls[n]=t,t.uri;let r;return r=t?400===e.status&&t&&"deprecated-version"===t.code?Yn.fatal(H.LICENSE_RESOLVER_DEPRECATED_VERSION,"This version of the SDK is no longer supported. Please upgrade"):new Yn(H.LICENSE_RESOLVER_CANT_RESOLVE_URL,`License URL endpoint responded with status ${e.status}`):Yn.fatal(H.LICENSE_RESOLVE_INVALID_RESPONSE,"License URL endpoint responded with invalid response"),r.status=e.status,Promise.reject(r)}))}remove(e,t){this._urls[`${e}:${t}`]=null}}class Hn extends Pn.Hx{constructor(e){var t;e.platform=null!==(t=e.platform)&&void 0!==t?t:Pn.eV.UNKNOWN,super(e)}logTrackStreamVerification(e){return this._sendLog("/v1/msg/track_stream_verification",e)}logJSSDKPlaybackStats(e){return this._sendLog("/v1/msg/jssdk_playback_stats",e)}logJSSDKPlaybackStart(e){return this._sendLog("/v1/msg/jssdk_playback_start",e)}logJSSDKError(e){return this._sendLog("/v1/msg/jssdk_error",e)}logJSSDKWarning(e){return this._sendLog("/v1/msg/jssdk_warning",e)}}var Vn,Gn,Wn,qn,zn,$n;!function(e){e.NULL_VALUE="NULL_VALUE",e.LIST_START="LIST_START",e.LIST_END="LIST_END",e.FORBIDDEN="FORBIDDEN",e.IGNORE="IGNORE",e.PAUSE="PAUSE"}(Vn||(Vn={})),function(e){e.MP4_AUDIO="audio/mp4",e.MP4_VIDEO="video/mp4",e.MTS_VIDEO="video/mp2t",e.WEBM_AUDIO="audio/webm",e.WEBM_VIDEO="video/webm"}(Gn||(Gn={})),function(e){e.AAC_LC="mp4a.40.2",e.FLAC="flac",e.OPUS="opus",e.VP9="vp9",e.VP8="vp8",e.H264_31="avc1.4d401f"}(Wn||(Wn={})),function(e){e.UNKNOWN="UNKNOWN",e.DEFAULT="DEFAULT",e.LOW="LOW",e.NORMAL="NORMAL",e.HIGH="HIGH",e.VERY_HIGH="VERY_HIGH",e.HIFI="HIFI"}(qn||(qn={})),function(e){e.NONE="NONE",e.CONTEXT="CONTEXT",e.TRACK="TRACK"}(zn||(zn={})),function(e){e.EMPTY="EMPTY",e.SW_CRYPTO="SW_CRYPTO",e.SW_DECODE="SW_DECODE",e.HW_CRYPTO="HW_CRYPTO",e.HW_DECODE="HW_DECODE",e.HW_ALL="HW_ALL"}($n||($n={}));class Qn extends Error{constructor(e,t){super(),this.unrecoverable=!1,this.listPlayerIgnore=!1,this.debug={},this.name="PlaybackError",this.code=e,this.message=t}static fatal(e,t){const n=new Qn(e,t);return n.unrecoverable=!0,n}}function Xn(e){return"uri"in e}class Jn extends ne.vp{constructor(e){if(super(),this._trackPlayerPromise=Rt(),this._maxListErrors=5,this._uid=0,this._loadedList=null,this._loadedOptions=null,this._currentTrack=null,this._currentTrackOptions=null,this._listPlayCount=0,this._listErrorCount=0,this._shuffled=!1,this._repeatMode=zn.NONE,this._currentSeqId=0,!e.trackPlayer)throw new TypeError("Argument `options.trackPlayerManager` not found.");e.maxListErrors&&(this._maxListErrors=e.maxListErrors),this._setListOptions=this._setListOptions.bind(this),this._replaceCurrentList=this._replaceCurrentList.bind(this),this._handleCapped=this._handleCapped.bind(this),this._handlePlaying=this._handlePlaying.bind(this),this._handlePaused=this._handlePaused.bind(this),this._handleEnded=this._handleEnded.bind(this),this._handleCanPreload=this._handleCanPreload.bind(this),this._handleError=this._handleError.bind(this),this._handlePositionChanged=this._handlePositionChanged.bind(this),this._handleDurationChanged=this._handleDurationChanged.bind(this),this._handleTimeout=this._handleTimeout.bind(this),this._handlePlayerInitError=this._handlePlayerInitError.bind(this),this._handleProgress=this._handleProgress.bind(this),this._handlePlayedThresholdReached=this._handlePlayedThresholdReached.bind(this),this._init(e.trackPlayer)}static create(e){return new Jn(e)}_init(e){this._trackPlayerPromise.promise.catch((()=>{})),Promise.resolve(e).then((e=>{this._attachPlayerEvents(e),this._trackPlayerPromise.resolve(e)})).catch(this._handlePlayerInitError)}_attachPlayerEvents(e){e.on(yt.PLAYER_CAN_PRELOAD,this._handleCanPreload),e.on(yt.PLAYER_CAPPED,this._handleCapped),e.on(yt.PLAYER_ENDED,this._handleEnded),e.on(yt.PLAYER_ERROR,this._handleError),e.on(yt.PLAYER_PAUSED,this._handlePaused),e.on(yt.PLAYER_PLAYING,this._handlePlaying),e.on(yt.PLAYER_TIMEOUT,this._handleTimeout),e.on(yt.PLAYER_POSITION_CHANGED,this._handlePositionChanged),e.on(yt.PLAYER_DURATION_CHANGED,this._handleDurationChanged),e.on(yt.PLAYER_PROGRESS,this._handleProgress),e.on(yt.PLAYER_PLAYED_THRESHOLD_REACHED,this._handlePlayedThresholdReached),this.proxyEmitSync(e,yt.PLAYER_BEFORE_VOLUME_CHANGE,yt.LIST_PLAYER_BEFORE_VOLUME_CHANGE),this.proxyEmit(e,yt.PLAYER_AUTOPLAY_FAILED,yt.LIST_PLAYER_AUTOPLAY_FAILED),this.proxyEmit(e,yt.PLAYER_BEFORE_LOAD,yt.LIST_PLAYER_BEFORE_PLAYER_LOAD),this.proxyEmitSync(e,yt.PLAYER_LOAD,yt.LIST_PLAYER_PLAYER_LOAD),this.proxyEmit(e,yt.PLAYER_TRACKING_DATA_CREATED,yt.LIST_PLAYER_TRACKING_DATA_CREATED),this.proxyEmit(e,yt.PLAYER_TRACKING_DATA_FINALIZED,yt.LIST_PLAYER_TRACKING_DATA_FINALIZED),this.proxyEmit(e,yt.PLAYER_BUFFER_STALLED,yt.LIST_PLAYER_BUFFER_STALLED),this.proxyEmit(e,yt.PLAYER_BUFFERING_START,yt.LIST_PLAYER_BUFFERING_START),this.proxyEmit(e,yt.PLAYER_BUFFERING_END,yt.LIST_PLAYER_BUFFERING_END),this.proxyEmit(e,yt.PLAYER_VIDEO_ELEMENT_APPENDED,yt.LIST_PLAYER_VIDEO_ELEMENT_APPENDED),this.proxyEmit(e,yt.PLAYER_VIDEO_ELEMENT_REMOVED,yt.LIST_PLAYER_VIDEO_ELEMENT_REMOVED)}_translatePosition(e){var t,n,r;return null!==(r=null===(n=null===(t=this._loadedList)||void 0===t?void 0:t.translatePosition)||void 0===n?void 0:n.call(t,e))&&void 0!==r?r:e}_translateDuration(e){var t,n,r;return null!==(r=null===(n=null===(t=this._loadedList)||void 0===t?void 0:t.translateDuration)||void 0===n?void 0:n.call(t,e))&&void 0!==r?r:e}_handleProgress(e){const{data:t}=e;this.emit(yt.LIST_PLAYER_PROGRESS,Object.assign(Object.assign({},t),{position:this._translatePosition(t.position)}))}_handlePlayerInitError(e){this._trackPlayerPromise.reject(new Qn(H.LIST_PLAYER_NO_TRACK_PLAYER,e.message||"Track player promise was rejected."))}_handleCapped(){const e=this._currentTrack;e&&this.emit(yt.LIST_PLAYER_CAPPED,{uid:this._uid,track:e,options:this._currentTrackOptions,list:this._loadedList})}_handlePlaying(e){const t=this._currentTrack;t&&this.emit(yt.LIST_PLAYER_PLAYING,{uid:this._uid,track:t,options:this._currentTrackOptions,list:this._loadedList,position:this._translatePosition(e.data.position)})}_handlePaused(e){const t=this._currentTrack;t&&this.emit(yt.LIST_PLAYER_PAUSED,{uid:this._uid,track:t,options:this._currentTrackOptions,list:this._loadedList,position:this._translatePosition(e.data.position)})}_handleCanPreload(){this._preloadUpcomingTrack().catch((()=>{}))}_handleEnded(){const e=this._currentTrack;e&&(this.emit(yt.LIST_PLAYER_TRACK_ENDED,{uid:this._uid,track:e,options:this._currentTrackOptions,list:this._loadedList}),this.next(Z.TRACK_DONE))}_handleTimeout(){const e=this._currentTrack;e&&(this.emit(yt.LIST_PLAYER_TRACK_TIMEOUT,{uid:this._uid,track:e,options:this._currentTrackOptions,list:this._loadedList}),this.next(Z.TRACK_ERROR))}_handlePositionChanged(e){const t=this._currentTrack;t&&this.emit(yt.LIST_PLAYER_POSITION_CHANGED,{uid:this._uid,track:t,options:this._currentTrackOptions,list:this._loadedList,position:this._translatePosition(e.data.position)})}_handleDurationChanged(e){const t=this._currentTrack;t&&this.emit(yt.LIST_PLAYER_DURATION_CHANGED,{uid:this._uid,track:t,options:this._currentTrackOptions,list:this._loadedList,position:this._translatePosition(e.data.position),duration:this._translateDuration(e.data.duration)})}_handlePlayedThresholdReached(e){const t=this._currentTrack;t&&this.emit(yt.LIST_PLAYER_PLAYED_THRESHOLD_REACHED,{uid:this._uid,track:t,options:this._currentTrackOptions,list:this._loadedList,threshold:e.data.threshold,position:this._translatePosition(e.data.position)})}_handleError(e){const t=this._currentTrack,n=e.data;if(!t)return;n.position=this._translatePosition(e.data.position),this.emit(yt.LIST_PLAYER_ERROR,n),this.emitSync(yt.LIST_PLAYER_ERROR_SYNC,n);const r=!!n.error&&n.error.listPlayerIgnore;r||this._listErrorCount++,n.canPlayNext&&(r||this._listErrorCount<=this._maxListErrors?this.next(Z.TRACK_ERROR):this.emit(yt.LIST_PLAYER_MAX_LIST_ERRORS_REACHED,{count:this._listErrorCount,threshold:this._maxListErrors}))}_handleTrackLoaded(e){this.emitSync(yt.LIST_PLAYER_TRACK_LOADED,e)}_incrementSeqId(){return this._currentSeqId>=9007199254740991?this._currentSeqId=0:this._currentSeqId+=1,this._currentSeqId}_getTrackPlayer(){return this._trackPlayerPromise.promise}_setListIndex(e,t){const n=t.index&&-1!==t.index?t.index:0;return Promise.all([e,t,e.startAt(n)])}_setListOptions([e,t,n]){return Promise.all([e.setShuffle(!!this._shuffled),e.setRepeatMode(this._repeatMode)]).then((()=>[e,t]))}_replaceCurrentList([e,t]){return this.emitSync(yt.LIST_PLAYER_BEFORE_LIST_CHANGE,{newList:e,newOptions:t,oldList:this._loadedList,oldOptions:this._loadedOptions}),this._loadedList=e,this._loadedOptions=t,this._listPlayCount=0,this._listErrorCount=0,this.emit(yt.LIST_PLAYER_LIST_CHANGED,{list:e,options:t}),St.SUCCESS}_preloadTrack(e){return this._getTrackPlayer().then((t=>(t.preload(e).catch((()=>{})),St.SUCCESS)))}_changeTrack(e,t,n){if(this._currentSeqId!==n)return Promise.resolve(St.CANCELLED);this.emitSync(yt.LIST_PLAYER_BEFORE_TRACK_LOAD,{list:this._loadedList,newTrack:e,oldTrack:this._currentTrack}),this._uid++;const r=++this._listPlayCount,i=this._loadedOptions;let s,o=!0,a=0,c=3e4;i&&(1===r?(o=!i.paused,a=i.initialPosition||i.position||0):a=i.position||0);const l=t===Z.TRACK_DONE;if("options"in e){const t=e.options;"paused"in t&&(o=!t.paused),void 0!==t.position&&(a=t.position),void 0!==t.playedThreshold&&(c=t.playedThreshold),s=t.stopPosition}this._currentTrack=e,this._currentTrackOptions={reason:t,paused:!o,position:a,playedThreshold:c,stopPosition:s};const u=this._handleTrackLoaded.bind(this,{uid:this._uid,track:this._currentTrack,options:this._currentTrackOptions,list:this._loadedList});return this._getTrackPlayer().then((t=>this._currentSeqId!==n?St.CANCELLED:(Promise.resolve(t.load(e,{uriProperty:"playableURI",autoplay:o,position:a,playedThreshold:c,stopPosition:s,continuePrevious:l},u)).catch((()=>{})),St.SUCCESS)))}_preloadUpcomingTrack(){const e=this._loadedList;if(!e)return Promise.reject(new Qn(H.LIST_PLAYER_NO_LIST,"Cannot perform operation; no list was loaded."));const t={reason:Z.TRACK_DONE,listConstants:Vn};return e.peekNext(t).then((e=>e===Vn.FORBIDDEN?St.FORBIDDEN:e===Vn.NULL_VALUE?this._preloadUpcomingTrack():e===Vn.LIST_END?St.LIST_END:Xn(e)&&e.playable?this._preloadTrack(e):St.INVALID))}activateElement(){return this._getTrackPlayer().then((e=>(e.activateElement(),St.SUCCESS)))}load(e,t){const n=function(e={}){const t={index:-1,position:0,initialPosition:0,duration:-1,paused:!1,reason:Z.UNKNOWN};return void 0!==e.index&&(t.index=e.index),void 0!==e.position&&(t.position=e.position),void 0!==e.initialPosition&&(t.initialPosition=e.initialPosition),void 0!==e.duration&&(t.duration=e.duration),void 0!==e.paused&&(t.paused=e.paused),void 0!==e.reason&&(t.reason=e.reason),t}(t||this._loadedOptions||{});return this._setListIndex(e,n).then(this._setListOptions).then(this._replaceCurrentList)}play(e,t){return this.load(e,t).then((()=>{if(this._loadedList!==e)return St.CANCELLED;const t=this._loadedOptions?this._loadedOptions.reason:Z.UNKNOWN;return this.next(t)}))}canChangeTrack(){return this._loadedList?this._loadedList.peekNext({reason:Z.FORWARD_BUTTON,listConstants:Vn}).then((e=>e!==Vn.FORBIDDEN)):Promise.resolve(!0)}next(e){if(!e)return Promise.reject(new Qn(H.LIST_PLAYER_INVALID_ARGUMENT,"The argument `reason` is required."));const t=this._loadedList;if(!t)return Promise.reject(new Qn(H.LIST_PLAYER_NO_LIST,"Cannot perform operation; no list was loaded."));this.emitSync(yt.LIST_PLAYER_BEFORE_NEXT,{list:t,reason:e});const n=this._incrementSeqId(),r={reason:e,listConstants:Vn};return t.next(r).then((r=>this._currentSeqId!==n?St.CANCELLED:r===Vn.FORBIDDEN?St.FORBIDDEN:r===Vn.NULL_VALUE?this.next(e):r===Vn.LIST_END?(this.emit(yt.LIST_PLAYER_LIST_ENDED,{list:t,reason:Z.END_PLAY}),this.clear(e),St.LIST_END):Xn(r)?r.playable?this._changeTrack(r,e,n):(this.emit(yt.LIST_PLAYER_TRACK_UNPLAYABLE,{track:r,list:t}),this.next(e)):St.INVALID))}previous(e){if(!e)return Promise.reject(new Qn(H.LIST_PLAYER_INVALID_ARGUMENT,"The argument `reason` is required."));const t=this._loadedList;if(!t)return Promise.reject(new Qn(H.LIST_PLAYER_NO_LIST,"Cannot perform operation; no list was loaded."));this.emitSync(yt.LIST_PLAYER_BEFORE_PREVIOUS,{list:t,reason:e});const n=this._incrementSeqId(),r={reason:e,listConstants:Vn};return t.previous(r).then((r=>this._currentSeqId!==n?St.CANCELLED:r===Vn.FORBIDDEN?St.FORBIDDEN:r===Vn.NULL_VALUE?this.previous(e):r===Vn.LIST_START?(this.emit(yt.LIST_PLAYER_LIST_ENDED,{list:t,reason:Z.END_PLAY}),this.clear(e),St.LIST_END):Xn(r)?r.playable?this._changeTrack(r,e,n):(this.emit(yt.LIST_PLAYER_TRACK_UNPLAYABLE,{track:r,list:t}),this.previous(e)):St.INVALID))}pause(){return this._loadedList?this._currentTrack?this._getTrackPlayer().then((e=>e.pause().then((()=>St.SUCCESS)).catch((e=>"AbortError"===(null==e?void 0:e.name)?St.CANCELLED:St.FORBIDDEN)))):Promise.resolve(St.SUCCESS):Promise.reject(new Qn(H.LIST_PLAYER_NO_LIST,"Cannot perform operation; no list was loaded."))}resume(){return this._loadedList?this._currentTrack?this._getTrackPlayer().then((e=>e.resume().then((()=>St.SUCCESS)).catch((e=>"AbortError"===(null==e?void 0:e.name)?St.CANCELLED:St.FORBIDDEN)))):Promise.resolve(St.SUCCESS):Promise.reject(new Qn(H.LIST_PLAYER_NO_LIST,"Cannot perform operation; no list was loaded."))}togglePlay(){return this._loadedList?this._currentTrack?this._getTrackPlayer().then((e=>e.togglePlay().then((()=>St.SUCCESS)).catch((e=>"AbortError"===(null==e?void 0:e.name)?St.CANCELLED:St.FORBIDDEN)))):Promise.resolve(St.SUCCESS):Promise.reject(new Qn(H.LIST_PLAYER_NO_LIST,"Cannot perform operation; no list was loaded."))}stop(e){const t={reason:e||Z.UNKNOWN},n=this._currentTrack;return n&&n.logData&&(t.source=n.logData.source),this._incrementSeqId(),this._getTrackPlayer().then((e=>(e.stop(t),this.emit(yt.LIST_PLAYER_STOPPED,{uid:this._uid,options:this._currentTrackOptions,list:this._loadedList}),St.SUCCESS)))}clear(e){return this.stop(e).then((()=>(this._loadedList=null,this._loadedOptions=null,this._currentTrack=null,this._currentTrackOptions=null,this.emit(yt.LIST_PLAYER_CLEARED,null),St.SUCCESS)))}setShuffle(e){const t=!!e;if(this._shuffled!==t){this._shuffled=t,this.emit(yt.LIST_PLAYER_SHUFFLE_CHANGED,{player:this,shuffled:t});const e=this._loadedList;e&&e.setShuffle(this._shuffled)}return Promise.resolve(St.SUCCESS)}setRepeatMode(e){if(!(e in zn))return Promise.reject(new Qn(H.LIST_PLAYER_INVALID_ARGUMENT,"The value of repeat mode is not a correct RepeatMode enum value"));if(this._repeatMode!==e){this._repeatMode=e,this.emit(yt.LIST_PLAYER_REPEAT_MODE_CHANGED,{player:this,repeatMode:e});const t=this._loadedList;t&&t.setRepeatMode(this._repeatMode)}return Promise.resolve(St.SUCCESS)}getVolume(){return this._getTrackPlayer().then((e=>e.getVolume()))}setVolume(e,t=null){return this._getTrackPlayer().then((n=>(n.setVolume(e,{commandId:null!=t?t:void 0}),this.emit(yt.LIST_PLAYER_VOLUME_CHANGED,{volume:e,commandId:t}),St.SUCCESS)))}seek(e){var t,n;const r=this._loadedList;if(!r)return Promise.reject(new Qn(H.LIST_PLAYER_NO_LIST,"Cannot perform operation; no list was loaded."));if("function"==typeof r.allowSeeking&&!r.allowSeeking())return Promise.reject(new Qn(H.LIST_PLAYER_FORBIDDEN,"The operation is not allowed."));const i=null!==(n=null===(t=r.handleSeek)||void 0===t?void 0:t.call(r,e))&&void 0!==n?n:e;return i===Vn.PAUSE?this.pause():i===Vn.IGNORE?Promise.resolve(St.SUCCESS):this._currentTrack?this._getTrackPlayer().then((e=>(e.seek(i),St.SUCCESS))):Promise.resolve(St.SUCCESS)}getListConstants(){return Vn}getLoadedList(){return this._loadedList}getLoadedOptions(){return this._loadedOptions}getPlayerState(){return this._getTrackPlayer().then((e=>{const t=e.getPlayerState();return Object.assign(Object.assign({},t),{position:this._translatePosition(t.position),duration:this._translateDuration(t.duration)})}))}getState(){return this.getPlayerState().then((e=>({playbackState:e,track:this._currentTrack,list:this._loadedList,options:this._loadedOptions})))}getMediaConfig(){return this._getTrackPlayer().then((e=>e.getMediaConfig()))}hideSubtitles(){return this._getTrackPlayer().then((e=>e.hideSubtitles())).then((()=>St.SUCCESS))}showSubtitles(){return this._getTrackPlayer().then((e=>e.showSubtitles())).then((()=>St.SUCCESS))}areSubtitlesShown(){return this._getTrackPlayer().then((e=>e.areSubtitlesShown()))}getSubtitleLanguages(){return this._getTrackPlayer().then((e=>e.getSubtitleLanguages()))}getActiveSubtitleLanguage(){return this._getTrackPlayer().then((e=>{var t;return null!==(t=e.getActiveSubtitleLanguage())&&void 0!==t?t:null}))}getCurrentBandwidth(){return this._getTrackPlayer().then((e=>e.getCurrentBandwidth()))}setSubtitleLanguage(e){return this._getTrackPlayer().then((t=>t.setSubtitleLanguage(e))).then((()=>St.SUCCESS))}}function Zn(e){return new Promise(((t,n)=>{var r,i,s,o;if(!e.transport)return void n(new TypeError("Argument transport is required."));("undefined"!=typeof window&&"boolean"==typeof window.isSecureContext?window.isSecureContext:function(){if("undefined"==typeof window||!window.location)return!1;const e=window.location;if("https"===e.protocol||"file"===e.protocol)return!0;const t=e.hostname;return!!/^127(\.[0-255]){3}$|^locahost\.?$|\.localhost\.?$/.test(t)}())||null===(r=window.console)||void 0===r||r.warn("%cDRM might not be available from unsecure contexts","background: #222; color: #bada55; font-size: 40px");const a=e.transport,[c="",l=""]=(e.sdkId||"").split(":"),u=Object.assign(Object.assign({},e),{tracker:Fn.create(),audioResolver:new Nn(a),videoResolver:new jn(a),licenseURLResolver:new Kn({transport:a,sdk:{name:c,version:l},securityLevel:e.securityLevel}),newBufferPerTrack:null===(i=e.newBufferPerTrack)||void 0===i||i,preinitMediaElement:null===(s=e.preinitMediaElement)||void 0===s||s});e.unauthenticatedLogs&&!(null===(o=e.loggerOptions)||void 0===o?void 0:o.endpoint)&&(e.loggerOptions=Object.assign(Object.assign({},e.loggerOptions),{endpoint:"https://spclient.wg.spotify.com/melody/unauth"})),Rn.create(u).then((t=>{const n=function(e){return new Hn(e)}(Object.assign(Object.assign({},e.loggerOptions),{transport:a,sdkId:e.sdkId}));return{player:t,logger:Ln.create({transport:a,player:t,logSender:n})}})).then(t,n)}))}n(2081);var er,tr=n(1688);function nr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}!function(e){e.TRACK_DATA_FINALIZED="track_data_finalized",e.DEREGISTER="deregister",e.REGISTER="register",e.BEFORE_TRACK_LOAD="before_track_load",e.CAPPED="capped",e.ERROR="error",e.PAUSE="pause",e.RESUME="resume",e.PLAYED_THRESHOLD_REACHED="played_threshold_reached",e.POSITION_CHANGED="position_changed",e.STARTED_PLAYING="started_playing",e.PROGRESS="progress",e.PING="ping",e.MODIFY_CURRENT_STATE="modify_current_state",e.STATE_CLEAR="state_clear"}(er||(er={}));var rr=function(e){v()(n,e);var t=nr(n);function n(e,r){var i;return h()(this,n),(i=t.call(this,r)).status=-1,i.maxedSubscriptions=!1,i.unrecoverable=!1,i.debug={},i.registration=!1,i.code=e,i.name="TrackPlayerAPIClientError",i}return f()(n,null,[{key:"fatal",value:function(e,t){var r=new n(e,t);return r.unrecoverable=!0,r}}]),n}(le()(Error));function ir(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var sr=ke.P.forTag("tpapiclient"),or=ke.P.forTag("tpapiclient.endsong"),ar=ke.P.forTag("tpapiclient.endsongs"),cr=/^hm:\/\/track-playback\/v1/,lr=/^hm:\/\/play-token\/lost/,ur=function(e,t){var n=e.getStatusFamily();return n===t.SERVER_ERROR||n===t.CONNECTION_ERROR},dr={condition:ur,maxRetries:8},pr={condition:ur,maxRetries:2},hr=function(e){v()(n,e);var t=ir(n);function n(e){var r;return h()(this,n),(r=t.call(this))._deviceId=null,r._sequenceNumber=0,r._currentContext=null,r._loading=!1,r._lastSentStateUpdatePayload=null,r._isSendingConflict=!1,r._queuedRejectedStates=[],r._isSendingUpdate=!1,r._queueSendUpdate=[],r._currentTrackInfo={},r._registered=!1,r._isDeregistering=!1,r._waitingForTrackingData=pe(),r._lastProcessedStateId=null,r._limitStateUpdates=!1,r._lastUpdateStateTime=0,r._initialUpdateSent=!1,r._startedPlayingUpdateSent=!1,r._nextFinalizedDataPayload=null,r._switchingContext=!1,r._connectionId=null,r._transport=e.transport,r._logger=e.logger,r._endpoint=e.endpoint||"http://@webgate/track-playback",r._listPlayer=e.listPlayer,r._ListClass=e.ListClass,r._currentGaiaVolume=e.initialVolume*ae,r._clientVersion=e.clientVersion,r._manifestTrackResolver=e.manifestTrackResolver,r._descriptorPromise=Promise.resolve(e.descriptor),r._init(),r._performCommand=r._performCommand.bind(m()(r)),r._handleRegisterResponse=r._handleRegisterResponse.bind(m()(r)),r._handleStateConflictResponse=r._handleStateConflictResponse.bind(m()(r)),r.register=r.register.bind(m()(r)),r._parseDescriptor=r._parseDescriptor.bind(m()(r)),r._volumeDebouncer=new tr.d(r._sendVolume.bind(m()(r)),{blockInitial:!0}),r}return f()(n,[{key:"_init",value:function(){var e,t=this;this._waitingForTrackingData=pe(),this._waitingForTrackingData.resolve(!0),this._transport.on(this._transport.EVENT_CONNECTION_ID,this._onConnectionId.bind(this)),this._transport.matchMessages(lr,this._onPlayTokenLost.bind(this)),this._transport.matchMessages(cr,this._onTrackPlaybackMessage.bind(this)),this._listPlayer.addListeners((e={},i()(e,yt.LIST_PLAYER_CAPPED,this._onCapped.bind(this)),i()(e,yt.LIST_PLAYER_ERROR_SYNC,this._onError.bind(this)),i()(e,yt.LIST_PLAYER_BEFORE_NEXT,this._onBeforeTrackChange.bind(this)),i()(e,yt.LIST_PLAYER_BEFORE_PREVIOUS,this._onBeforeTrackChange.bind(this)),i()(e,yt.LIST_PLAYER_BEFORE_PLAYER_LOAD,this._onBeforePlayerLoad.bind(this)),i()(e,yt.LIST_PLAYER_PLAYER_LOAD,this._onListPlayerLoad.bind(this)),i()(e,yt.LIST_PLAYER_BEFORE_TRACK_LOAD,this._onBeforeTrackLoad.bind(this)),i()(e,yt.LIST_PLAYER_POSITION_CHANGED,this._onPositionChanged.bind(this)),i()(e,yt.LIST_PLAYER_DURATION_CHANGED,this._onDurationChanged.bind(this)),i()(e,yt.LIST_PLAYER_VOLUME_CHANGED,this._onVolumeChanged.bind(this)),i()(e,yt.LIST_PLAYER_PAUSED,this._onPlayPause.bind(this,!0)),i()(e,yt.LIST_PLAYER_PLAYING,this._onPlayPause.bind(this,!1)),i()(e,yt.LIST_PLAYER_PLAYED_THRESHOLD_REACHED,this._onPlayThresholdReached.bind(this)),i()(e,yt.LIST_PLAYER_PROGRESS,this._onProgress.bind(this)),i()(e,yt.LIST_PLAYER_TRACKING_DATA_CREATED,this._onTrackDataCreatedEvent.bind(this)),i()(e,yt.LIST_PLAYER_TRACKING_DATA_FINALIZED,this._onTrackDataFinalizedEvent.bind(this)),e)),this._descriptorPromise.then((function(e){e.on("descriptor_changed",(function(){t._parseDescriptor(e),t._updateDeviceInfo()}))}))}},{key:"_onBeforeTrackChange",value:function(){var e,t;if(!this._nextFinalizedDataPayload&&!this._switchingContext){var n=null!==(t=null===(e=this._currentContext)||void 0===e?void 0:e.getStateRef())&&void 0!==t?t:null,r=this._generateStatePayload(n,er.TRACK_DATA_FINALIZED);this._setSequenceNumber(r),this._nextFinalizedDataPayload=r}}},{key:"_onBeforeTrackLoad",value:function(e){var t;this._loading=!0,this._switchingContext=!1,this._currentTrackInfo.duration=void 0,this._stateEventPositionOverride=null===(t=e.data.newTrack.options)||void 0===t?void 0:t.position}},{key:"_onBeforePlayerLoad",value:function(e){var t,n,r,i=this._currentContext;if(i){var s=i.getCurrentTrack();this._currentTrackInfo.duration=(null==s?void 0:s.metadata.duration)||0;var o=e.data.track.metadata||{};this._currentTrackInfo={duration:null!==(t=null==s?void 0:s.metadata.duration)&&void 0!==t?t:0,mediaType:e.data.track.mediaType.toUpperCase(),fileFormat:e.data.track.fileFormat,bitrate:null===(r=null===(n=e.data.logData)||void 0===n?void 0:n.format)||void 0===r?void 0:r.bitrate,playbackQuality:o.playbackQuality,hifiStatus:o.hifiStatus};var a=e.data.options;i.setPaused(!a.autoplay),this._setCurrentTrackPosition(a&&a.position||0),this._updateState(er.BEFORE_TRACK_LOAD),this._startedPlayingUpdateSent=!1,this._initialUpdateSent=!1}}},{key:"_onCapped",value:function(){this._listPlayer.clear(Z.CAPPED),this._currentContext=null,this._updateState(er.CAPPED),this._setCurrentTrackPosition(void 0),this._lastProcessedStateId=null,this.emit("state_cleared",null)}},{key:"_onConnectionId",value:function(e){var t=this;this._connectionId=e.data.id,this._isDeregistering||(this._registered=!1,Promise.all([this._listPlayer.getVolume(),this._descriptorPromise.then(this._parseDescriptor)]).then(this.register,(function(e){sr.info("Skipping registration due to error",e),t.emit("registration_aborted",{reason_error:e})})).catch((function(){})))}},{key:"_onDurationChanged",value:function(e){var t,n=null===(t=this._currentContext)||void 0===t?void 0:t.getCurrentTrack();(null==n?void 0:n.metadata.uri)===e.data.track.uri&&(this._currentTrackInfo.duration=e.data.duration,this._emitStateChanged())}},{key:"_onError",value:function(e){"position"in e.data&&(this._setCurrentTrackPosition(e.data.position),this._updateState(er.ERROR))}},{key:"_onPlayPause",value:function(e,t){var n=this._currentContext;n&&(n.setPaused(e),"position"in t.data&&this._setAllTrackPositions(t.data.position),t.data.track.stateId&&this._shouldSendUpdateForEvent(t.data.track.stateId)?this._updateState(e?er.PAUSE:er.RESUME):(this._lastProcessedStateId=null,this._emitStateChanged()))}},{key:"_onPlayThresholdReached",value:function(e){this._initialUpdateSent=!0,this._setAllTrackPositions(e.data.position),this._updateState(er.PLAYED_THRESHOLD_REACHED)}},{key:"_onPlayTokenLost",value:function(){this._listPlayer.pause().catch((function(){}))}},{key:"_onPositionChanged",value:function(e){this._loading||(this._setCurrentTrackPosition(e.data.position),e.data.track&&this._shouldSendUpdateForEvent(e.data.track.stateId)?this._updateState(er.POSITION_CHANGED):(this._lastProcessedStateId=null,this._emitStateChanged()))}},{key:"_onProgress",value:function(e){if(!this._loading&&this._currentContext&&(this._setAllTrackPositions(e.data.position),!this._startedPlayingUpdateSent&&e.data.played>1e3&&(this._startedPlayingUpdateSent=!0,this._updateState(er.STARTED_PLAYING)),e.data.logData)){var t=this._currentContext.getCurrentTrack(),n=t&&"number"==typeof t.ms_playing_update_interval?t.ms_playing_update_interval:null;this._initialUpdateSent&&null!==n&&n>0&&Date.now()-this._lastUpdateStateTime>n&&this._updateState(er.PROGRESS)}}},{key:"_onTrackDataCreatedEvent",value:function(){this._waitingForTrackingData=pe()}},{key:"_onTrackDataFinalizedEvent",value:function(e){var t=this._nextFinalizedDataPayload;t&&(t.playback_stats=e.data.playbackStats,this._updateState(er.TRACK_DATA_FINALIZED,t)),this._nextFinalizedDataPayload=null,this._waitingForTrackingData&&this._waitingForTrackingData.resolve(!0)}},{key:"_onListPlayerLoad",value:function(e){this._loading=!1;var t=this._currentContext;t&&(t.setPaused(!e.data.autoplay),this._setCurrentTrackPosition(e.data.position||0))}},{key:"_onTrackPlaybackMessage",value:function(e){var t=e.payloads;Array.isArray(t)&&t.length&&this._performCommand(t[0])}},{key:"_onVolumeChanged",value:function(e){var t;if(this._currentGaiaVolume=e.data.volume*ae,this._registered){var n=null!==(t=e.data.commandId)&&void 0!==t?t:"",r={seq_num:void 0,volume:this._currentGaiaVolume,command_id:n};this._volumeDebouncer.async(r)}}},{key:"_clearSessionData",value:function(){this._connectionId=null,this._sequenceNumber=0,this._currentContext=null,this._lastSentStateUpdatePayload=null,this._isSendingConflict=!1,this._isSendingUpdate=!1,this._queueSendUpdate=[],this._previousTrackPosition=void 0,this._currentTrackPosition=void 0,this._currentTrackInfo={},this._lastProcessedStateId=null,this.emit("state_cleared",null)}},{key:"_createStateRef",value:function(e,t){if(!t)return null;var n=e.states[t.state_index];if(!n)throw new rr(Q.TP_CANNOT_CREATE_STATE_REF,"Invalid state reference.");return{state_machine_id:e.state_machine_id,state_id:n.state_id,paused:t.paused}}},{key:"_deregisterFromService",value:function(e){var t=this,n=null,r=this._currentContext;r&&(e&&(r.setPaused(!e.playing),this._setAllTrackPositions(e.position)),n=r.getStateRef());var i=this._generateStatePayload(n,er.DEREGISTER);this._setSequenceNumber(i);var s="".concat(this._endpoint,"/v1/devices/").concat(this._deviceId);return this._transport.request(s,{authorize:!0,method:"DELETE",payload:JSON.stringify(i),responseType:"json",retry:pr}).then((function(e){if(200!==e.status&&204!==e.status)return t._registered=!0,!1;var n=e.body;return n&&(n.endsong&&or.log(n.endsong),n.endsongs&&(ar.log(n.endsongs),t.emit("internal_endcontent",{endcontents:n.endsongs}))),t._clearSessionData(),t.emit("deregistered",null),!0}))}},{key:"_emitError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._logger.logJSSDKError({source:"tpapi-client",source_version:Xe.tagged,type:e.code,message:e&&e.message,stack:e&&e.stack,json_data:t,json_data_version:"1.0.0"},"object").catch((function(e){sr.error("Track-Playback Logging Error",e)})),this.emit("error",{error:e,data:t})}},{key:"_emitStateChanged",value:function(){var e=this._currentContext;if(e){var t=this._currentTrackPosition||0;void 0!==this._stateEventPositionOverride&&(t=this._stateEventPositionOverride,this._stateEventPositionOverride=void 0),this.emit("state_changed",{position:t,stateMachine:e.getStateMachine(),stateRef:e.getInternalStateRef(),currentTrackInfo:this._currentTrackInfo,paused:e.isPaused(),loading:this._loading})}}},{key:"_generateStatePayload",value:function(e,t){var n=this._currentTrackInfo;return{seq_num:void 0,seq_nums:void 0,state_ref:e,sub_state:{playback_speed:e&&!e.paused?1:0,position:this._currentTrackPosition,duration:n.duration||void 0,media_type:n.mediaType,bitrate:n.bitrate,audio_quality:n.playbackQuality,format:n.fileFormat},previous_position:this._previousTrackPosition,playback_stats:void 0,rejected_state_refs:void 0,debug_source:t}}},{key:"_handleRegisterResponse",value:function(e){var t;if(429===e.status)return(t=rr.fatal(Q.TP_MAX_SUBSCRIPTIONS_REACHED,"Max connections reached")).maxedSubscriptions=!0,t.status=e.status,this.emit("max_subscriptions_reached",{error:t}),Promise.reject(t);if(403===e.status&&e.body&&"PREMIUM_REQUIRED"===e.body.error_type?t=rr.fatal(Q.TP_REGISTRATION_FAILED_NON_PREMIUM,"Cannot register to Track Playback with non-premium user."):200!==e.status?t=rr.fatal(Q.TP_REGISTRATION_FAILED_WITH_STATUS,"track-playback service responded with status ".concat(e.status," when registering device")):e.body||(t=rr.fatal(Q.TP_NO_RESPONSE_BODY,"Unexpected empty response body from registration request.")),t)return t.status=e.status,Promise.reject(t);var n=e.body;return n.endsong&&or.log(n.endsong),n.endsongs&&(ar.log(n.endsongs),this.emit("internal_endcontent",{endcontents:n.endsongs})),this._sequenceNumber=n.initial_seq_num,this._registered=!0,this.emit("registered",{deviceId:this._deviceId}),Promise.resolve(!0)}},{key:"_handleStateConflictResponse",value:function(e){var t;if(e.status>=200&&e.status<300){var n=null===(t=e.body)||void 0===t?void 0:t.commands;if(!n||!n.length)return;for(var r=0,i=n.length;r<i;r++)this._performCommand(n[r])}else{var s=new rr(Q.TP_CONFLICT_REQUEST_FAILED_WITH_STATUS,"Track-Playback service responded with ".concat(e.status));s.status=e.status,this._emitError(s)}}},{key:"_handleStateUpdateResponse",value:function(e,t){var n;if(200!==t.status)return(n=new rr(Q.TP_PARSE_STATE_UPDATE_FAILED_WITH_STATUS,"Service responded with status ".concat(t.status))).status=t.status,Promise.reject(n);if(!t.body)return(n=new rr(Q.TP_UPDATE_REQUEST_EMPTY_RESPONSE,"Unexpected empty response body from state update request.")).status=t.status,Promise.reject(n);var r=t.body;r.endsong&&or.log(r.endsong),r.endsongs&&(ar.log(r.endsongs),this.emit("internal_endcontent",{endcontents:r.endsongs}));var i=this._currentContext;if(!i)return Promise.resolve();var s=r.state_machine,o=r.updated_state_ref;return this._isCurrentStateRef(e)?(i.setStateMachine(s),i.setCurrentState(o),this._emitStateChanged(),Promise.resolve()):Promise.resolve()}},{key:"_isCurrentStateRef",value:function(e){var t=this._currentContext?this._currentContext.getStateRef():null;return!t&&!e||!(!t||!e)&&(t.state_machine_id===e.state_machine_id&&t.state_id===e.state_id&&t.paused===e.paused)}},{key:"_logUnsentStateUpdate",value:function(e){sr.info("Unsent state update.",e),this._logger.logClientEvent({source:"tpapi-client",source_version:Xe.tagged,source_vendor:"spotify",event:"unsent-state-update",event_version:"1.0.0",json_data:e},"object").catch((function(e){sr.error("Track-Playback Logging Error",e)}))}},{key:"_logout",value:function(){var e=this;this._listPlayer.pause().catch((function(){})),this.emit("state_cleared",null),this.deregister().then((function(t){e._currentContext=null,e._setCurrentTrackPosition(void 0),t&&e.emit("logout",null)}))}},{key:"_parseDescriptor",value:function(e){return this._deviceId=e.getId(),this._deviceInfo=e.toTrackPlaybackDeviceInfo(),!0}},{key:"_performCommand",value:function(e){switch(e.type){case"set_volume":this._setVolume(e);break;case"log_out":this._logout();break;case"replace_state":this._replaceState(e);break;case"ping":this._updateState(er.PING);break;default:this._emitError(new rr(Q.TP_UNKNOWN_COMMAND,"Received unknown command."),{command:e})}}},{key:"_rejectState",value:function(e){var t=this,n=this._queuedRejectedStates;if(void 0!==e&&n.push(e),this._registered&&!this._isSendingConflict&&n.length){this._isSendingConflict=!0;var r=n.splice(0,5),i=this._currentContext?this._currentContext.getStateRef():null,s=this._generateStatePayload(i);s.rejected_state_refs=r,this._setSequenceNumbers(s,r.length);var o=function(){t._isSendingConflict=!1,t._rejectState()},a="".concat(this._endpoint,"/v1/devices/").concat(this._deviceId,"/state_conflict");this._transport.request(a,{authorize:!0,method:"POST",headers:{"Content-Type":"application/json"},responseType:"json",payload:JSON.stringify(s),retry:pr}).then(this._handleStateConflictResponse).then(o,o)}}},{key:"_replaceState",value:function(e){var t,n,r,i=this._listPlayer,s=e.state_machine,o=e.state_ref,a=this._createStateRef(s,o);if(this._isCurrentStateRef(e.prev_state_ref))if(o){var c=null!==(n=null===(t=this._currentContext)||void 0===t?void 0:t.getStateRef())&&void 0!==n?n:null;if(function(e,t){if(!e)throw new Error("Assertion failed: ".concat(t))}(null!==a,"New state reference is null"),this._currentContext&&(null==c?void 0:c.state_id)===a.state_id){var l=this._currentContext;l.setStateMachine(s),l.setCurrentState(o);var u=!1;l.isPaused()!==o.paused&&(u=!0),o.paused?(l.setPaused(!0),i.pause()):(l.setPaused(!1),i.resume());var d=parseInt(e.seek_to,10);l.allowSeeking()&&!isNaN(d)&&(i.seek(d),this._setCurrentTrackPosition(d),u=!0),u?this._emitStateChanged():(this._lastProcessedStateId=null,this._updateState(er.MODIFY_CURRENT_STATE))}else{this._lastProcessedStateId=null!==(r=a.state_id)&&void 0!==r?r:null,this._currentContext&&this._onBeforeTrackChange();var p=this._ListClass.create("spotify:app:jsspeaker",this._manifestTrackResolver);p.setStateMachine(s),p.startAtState(o),this._deviceId&&p.setDeviceId(this._deviceId),this._currentContext=p;var h=e.seek_to||0;p.setInitialPosition(h),this._loading=!0,this._switchingContext=!0,i.play(p,{reason:Z.REMOTE})}}else this._clearContextAndState();else this._rejectState(a)}},{key:"_clearContextAndState",value:function(){var e=this._listPlayer;e.pause().catch((function(){})),e.clear(Z.REMOTE),this._currentContext=null,this._updateState(er.STATE_CLEAR),this._setAllTrackPositions(void 0),this._lastProcessedStateId=null,this.emit("state_cleared",null),this._loading=!0}},{key:"_sendDevicesRequest",value:function(e,t){var n="".concat(this._endpoint,"/v1/devices");return"PUT"===e&&(n="".concat(n,"/").concat(this._deviceId)),this._transport.request(n,{authorize:!0,method:e||"POST",headers:{"Content-Type":"application/json"},responseType:"json",payload:JSON.stringify(t),retry:dr})}},{key:"_sendVolume",value:function(e){var t="".concat(this._endpoint,"/v1/devices/").concat(this._deviceId,"/volume");return this._setSequenceNumber(e),this._transport.request(t,{authorize:!0,method:"PUT",headers:{"Content-Type":"application/json"},payload:JSON.stringify(e)})}},{key:"_setAllTrackPositions",value:function(e){this._previousTrackPosition=e,this._currentTrackPosition=e}},{key:"_setCurrentTrackPosition",value:function(e){this._previousTrackPosition=this._currentTrackPosition,this._currentTrackPosition=e}},{key:"_setSequenceNumber",value:function(e){return void 0===e.seq_num&&(e.seq_num=++this._sequenceNumber),e}},{key:"_setSequenceNumbers",value:function(e,t){e.seq_nums=[];for(var n=0;n<t;n++)e.seq_nums.push(++this._sequenceNumber);return e}},{key:"_setVolume",value:function(e){var t,n=e.volume/ae;this._listPlayer.setVolume(n,null!==(t=e.command_id)&&void 0!==t?t:"tpcommand-".concat(Date.now()))}},{key:"_shouldSendUpdateForEvent",value:function(e){return!(!e||e===this._lastProcessedStateId)}},{key:"_updateDeviceInfo",value:function(){var e=this;this._registered&&this._deviceInfo&&this._sendDevicesRequest("PUT",this._deviceInfo).then((function(t){204===t.status&&e.emit("registration_updated",null)}))}},{key:"_updateState",value:function(e,t){var n,r,i,s,o=this;if(this._registered)if(t?(i=t.state_ref,s=t):(i=null!==(r=null===(n=this._currentContext)||void 0===n?void 0:n.getStateRef())&&void 0!==r?r:null,s=this._generateStatePayload(i,e)),this._wasStatePayloadSentRecently(s)){if(this._emitStateChanged(),this._isSendingUpdate&&this._limitStateUpdates)return this._logUnsentStateUpdate(s),void this._queueSendUpdate.push(e);this._isSendingUpdate=!0,this._queueSendUpdate=[],this._setSequenceNumber(s),this._lastSentStateUpdatePayload=s;var a=function(){o._isSendingUpdate=!1,o._queueSendUpdate.length&&o._updateState(o._queueSendUpdate[o._queueSendUpdate.length-1]),sr.info("State update sent.",e,s)},c="".concat(this._endpoint,"/v1/devices/").concat(this._deviceId,"/state");this._lastUpdateStateTime=Date.now(),this._transport.request(c,{authorize:!0,method:"PUT",headers:{"Content-Type":"application/json"},responseType:"json",payload:JSON.stringify(s),retry:dr}).then(this._handleStateUpdateResponse.bind(this,i)).then(a,(function(e){o._emitError(e),a()}))}else sr.info("State update ignored (duplicate).",s)}},{key:"_wasStatePayloadSentRecently",value:function(e){var t=this._lastSentStateUpdatePayload;if(!t||!t.state_ref||!e.state_ref)return!0;var n=e.state_ref,r=t.state_ref;if(n.paused!==r.paused||n.state_id!==r.state_id||n.state_machine_id!==r.state_machine_id)return!0;var i=e.sub_state,s=t.sub_state;return i.playback_speed!==s.playback_speed||i.position!==s.position||i.duration!==s.duration||e.previous_position!==t.previous_position}},{key:"stop",value:function(){return!(!this._registered||!this._currentContext)&&(this._clearContextAndState(),!0)}},{key:"deregister",value:function(){var e=this;return this._registered?(this._isDeregistering=!0,this._registered=!1,this._listPlayer.getPlayerState().then((function(t){return Promise.all([e._deregisterFromService(t),e._waitingForTrackingData.promise,e._listPlayer.stop().catch((function(){}))]).then((function(t){var n=te()(t,1)[0];return e._isDeregistering=!1,n}))}),(function(){return e._isDeregistering=!1,e._registered=!0,!1}))):Promise.resolve(!1)}},{key:"register",value:function(){var e,t=this;if(this._registered)return Promise.resolve(!1);if(!this._deviceInfo)return Promise.reject(new Error("Need DeviceInfo for device registration."));if(!this._connectionId)return Promise.reject(new Error("Need connection-id for device registration"));var n=this._currentContext;return n&&(e=this._generateStatePayload(n.getStateRef(),er.REGISTER),this._setSequenceNumber(e)),this._sendDevicesRequest("POST",{device:this._deviceInfo,outro_endcontent_snooping:"true"==={NODE_ENV:"production",DEBUG_EVENT_SENDER:!1,DEBUG_SEMANTIC_METRICS:void 0,CDN_FILE_URLS:'{"fonts/CircularSpUIAraOnly-Black.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Black.6d6a4c25.otf","fonts/CircularSpUIAraOnly-Black.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Black.05b31ded.woff","fonts/CircularSpUIAraOnly-Black.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Black.c32951f4.woff2","fonts/CircularSpUIAraOnly-Bold.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Bold.f97cb921.otf","fonts/CircularSpUIAraOnly-Bold.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Bold.9ddc7126.woff","fonts/CircularSpUIAraOnly-Bold.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Bold.317e96e5.woff2","fonts/CircularSpUIAraOnly-Book.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Book.f0effcd1.otf","fonts/CircularSpUIAraOnly-Book.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Book.3ad862e2.woff","fonts/CircularSpUIAraOnly-Book.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Book.aaab109b.woff2","fonts/CircularSpUIAraOnly-Light.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Light.f0833f3b.otf","fonts/CircularSpUIAraOnly-Light.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Light.5c7ed8d8.woff","fonts/CircularSpUIAraOnly-Light.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Light.dde45e52.woff2","fonts/CircularSpUICyrOnly-Black.otf":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Black.50cd1ca9.otf","fonts/CircularSpUICyrOnly-Black.woff":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Black.7536a73f.woff","fonts/CircularSpUICyrOnly-Black.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Black.f5526fc4.woff2","fonts/CircularSpUICyrOnly-Bold.otf":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Bold.67641b90.otf","fonts/CircularSpUICyrOnly-Bold.woff":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Bold.909126fc.woff","fonts/CircularSpUICyrOnly-Bold.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Bold.30dc9fb2.woff2","fonts/CircularSpUICyrOnly-Book.otf":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Book.15af6ebe.otf","fonts/CircularSpUICyrOnly-Book.woff":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Book.918c53b8.woff","fonts/CircularSpUICyrOnly-Book.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Book.6a858994.woff2","fonts/CircularSpUICyrOnly-Light.otf":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Light.b10eb959.otf","fonts/CircularSpUICyrOnly-Light.woff":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Light.034997d0.woff","fonts/CircularSpUICyrOnly-Light.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Light.55fa9f4a.woff2","fonts/CircularSpUIHbrOnly-Black.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Black.11abebe4.otf","fonts/CircularSpUIHbrOnly-Black.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Black.0a11e734.woff","fonts/CircularSpUIHbrOnly-Black.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Black.217fb21f.woff2","fonts/CircularSpUIHbrOnly-Bold.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Bold.57b36278.otf","fonts/CircularSpUIHbrOnly-Bold.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Bold.9f406804.woff","fonts/CircularSpUIHbrOnly-Bold.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Bold.ef043f44.woff2","fonts/CircularSpUIHbrOnly-Book.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Book.fae4aece.otf","fonts/CircularSpUIHbrOnly-Book.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Book.ad2b13cd.woff","fonts/CircularSpUIHbrOnly-Book.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Book.cb36b6ec.woff2","fonts/CircularSpUIHbrOnly-Light.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Light.2e1df62a.otf","fonts/CircularSpUIHbrOnly-Light.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Light.2128eeac.woff","fonts/CircularSpUIHbrOnly-Light.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Light.4884da16.woff2","fonts/CircularSpUIv3T-Black.ttf":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Black.ce8ef887.ttf","fonts/CircularSpUIv3T-Black.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Black.effa986f.woff","fonts/CircularSpUIv3T-Black.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Black.c21e63c5.woff2","fonts/CircularSpUIv3T-Bold.ttf":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Bold.7eb7d0f7.ttf","fonts/CircularSpUIv3T-Bold.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Bold.10e93738.woff","fonts/CircularSpUIv3T-Bold.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Bold.8d0a45cc.woff2","fonts/CircularSpUIv3T-Book.ttf":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Book.a357677a.ttf","fonts/CircularSpUIv3T-Book.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Book.ea8d19db.woff","fonts/CircularSpUIv3T-Book.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Book.3466e0ec.woff2","fonts/CircularSpUIv3T-Light.ttf":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Light.89e4be2e.ttf","fonts/CircularSpUIv3T-Light.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Light.2a78c017.woff","fonts/CircularSpUIv3T-Light.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Light.afd9ab26.woff2","fonts/spoticon_regular_2.ttf":"https://open.scdn.co/cdn/fonts/spoticon_regular_2.127670b5.ttf","fonts/spoticon_regular_2.woff":"https://open.scdn.co/cdn/fonts/spoticon_regular_2.ff4c6091.woff","fonts/spoticon_regular_2.woff2":"https://open.scdn.co/cdn/fonts/spoticon_regular_2.d319d911.woff2","generated/manifest-mobile-web-player.json":"https://open.scdn.co/cdn/generated/manifest-mobile-web-player.2aef628f.json","generated/manifest-web-player.json":"https://open.scdn.co/cdn/generated/manifest-web-player.038c3337.json","generated/opensearch.xml":"https://open.scdn.co/cdn/generated/opensearch.abfbfc66.xml","images/checkmark.png":"https://open.scdn.co/cdn/images/checkmark.389faa13.png","images/concert-hub-fb-card.png":"https://open.scdn.co/cdn/images/concert-hub-fb-card.5072379c.png","images/concert-hub-header.png":"https://open.scdn.co/cdn/images/concert-hub-header.56bcad9b.png","images/concert-hub-iphone-de.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-de.b6f99e33.png","images/concert-hub-iphone-el.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-el.5672149c.png","images/concert-hub-iphone-en.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-en.6eda306a.png","images/concert-hub-iphone-es_419.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-es_419.cefd672a.png","images/concert-hub-iphone-es.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-es.cefd672a.png","images/concert-hub-iphone-fi.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-fi.52e8d625.png","images/concert-hub-iphone-fr_CA.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-fr_CA.93b897cb.png","images/concert-hub-iphone-fr.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-fr.336e7db1.png","images/concert-hub-iphone-hu.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-hu.5eba9191.png","images/concert-hub-iphone-id.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-id.87ecf560.png","images/concert-hub-iphone-it.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-it.18450a29.png","images/concert-hub-iphone-ja.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-ja.6eda306a.png","images/concert-hub-iphone-ms.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-ms.83140310.png","images/concert-hub-iphone-nl.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-nl.cb3a5038.png","images/concert-hub-iphone-pl.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-pl.45abd89b.png","images/concert-hub-iphone-pt_BR.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-pt_BR.e932ef02.png","images/concert-hub-iphone-sv.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-sv.5e512289.png","images/concert-hub-iphone-tr.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-tr.a017f03c.png","images/concert-hub-iphone-zh_TW.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-zh_TW.6eda306a.png","images/concert-hub-twitter-card.png":"https://open.scdn.co/cdn/images/concert-hub-twitter-card.71f6a06d.png","images/connect_header@1x.png":"https://open.scdn.co/cdn/images/connect_header@1x.ecc6912d.png","images/connect-to-devices-white.svg":"https://open.scdn.co/cdn/images/connect-to-devices-white.69d4229a.svg","images/desktop-auth-check.svg":"https://open.scdn.co/cdn/images/desktop-auth-check.65be3bbc.svg","images/desktop-auth-error.svg":"https://open.scdn.co/cdn/images/desktop-auth-error.b82f823b.svg","images/devices/android.png":"https://open.scdn.co/cdn/images/devices/android.460a5815.png","images/devices/ios.png":"https://open.scdn.co/cdn/images/devices/ios.535e1468.png","images/devices/mac-web.png":"https://open.scdn.co/cdn/images/devices/mac-web.71c1af1f.png","images/devices/mac.png":"https://open.scdn.co/cdn/images/devices/mac.80dcea83.png","images/devices/windowsphone.png":"https://open.scdn.co/cdn/images/devices/windowsphone.350c5a17.png","images/embed-podcast/upsell-background.png":"https://open.scdn.co/cdn/images/embed-podcast/upsell-background.00c81565.png","images/embed/copy-32_circle_grey_outline_bg.svg":"https://open.scdn.co/cdn/images/embed/copy-32_circle_grey_outline_bg.0c6130eb.svg","images/embed/embed-code-32_circle_grey_outline_bg.svg":"https://open.scdn.co/cdn/images/embed/embed-code-32_circle_grey_outline_bg.b40a255f.svg","images/embed/fb_colour.svg":"https://open.scdn.co/cdn/images/embed/fb_colour.13fa515f.svg","images/embed/messenger_colour.svg":"https://open.scdn.co/cdn/images/embed/messenger_colour.8f4836ec.svg","images/embed/twitter_colour.svg":"https://open.scdn.co/cdn/images/embed/twitter_colour.456d46db.svg","images/embed/whatsapp.svg":"https://open.scdn.co/cdn/images/embed/whatsapp.e33bfab4.svg","images/emi.png":"https://open.scdn.co/cdn/images/emi.c7e51c1a.png","images/employee-podcasts-modal-art.png":"https://open.scdn.co/cdn/images/employee-podcasts-modal-art.956e5f5e.png","images/equaliser-animated-green.gif":"https://open.scdn.co/cdn/images/equaliser-animated-green.73b73928.gif","images/equaliser-green.svg":"https://open.scdn.co/cdn/images/equaliser-green.1184ed87.svg","images/favicon.ico":"https://open.scdn.co/cdn/images/favicon.5cb2bd30.ico","images/favicon.png":"https://open.scdn.co/cdn/images/favicon.0c211e2e.png","images/favicon16.png":"https://open.scdn.co/cdn/images/favicon16.19fc3918.png","images/favicon32.png":"https://open.scdn.co/cdn/images/favicon32.a19b4f5b.png","images/focused_stroy_play.png":"https://open.scdn.co/cdn/images/focused_stroy_play.c908b733.png","images/follow/avatar-placeholder.png":"https://open.scdn.co/cdn/images/follow/avatar-placeholder.2f817d4a.png","images/follow/sprite.gif":"https://open.scdn.co/cdn/images/follow/sprite.e282a709.gif","images/follow/sprite@1.png":"https://open.scdn.co/cdn/images/follow/sprite@1.b994540b.png","images/hifi-button-off.svg":"https://open.scdn.co/cdn/images/hifi-button-off.87461500.svg","images/hifi-button-on.svg":"https://open.scdn.co/cdn/images/hifi-button-on.48a2de90.svg","images/hifi.svg":"https://open.scdn.co/cdn/images/hifi.0526a5b1.svg","images/home-icon.svg":"https://open.scdn.co/cdn/images/home-icon.ba66757a.svg","images/icons/Spotify_1024.png":"https://open.scdn.co/cdn/images/icons/Spotify_1024.d6467a14.png","images/icons/Spotify_128.png":"https://open.scdn.co/cdn/images/icons/Spotify_128.c9ce2f2e.png","images/icons/Spotify_16.png":"https://open.scdn.co/cdn/images/icons/Spotify_16.aa3775a0.png","images/icons/Spotify_256.png":"https://open.scdn.co/cdn/images/icons/Spotify_256.c8416b60.png","images/icons/Spotify_32.png":"https://open.scdn.co/cdn/images/icons/Spotify_32.492cdebf.png","images/icons/Spotify_512.png":"https://open.scdn.co/cdn/images/icons/Spotify_512.49a0bf03.png","images/icons/Spotify_64.png":"https://open.scdn.co/cdn/images/icons/Spotify_64.47bcd979.png","images/icons/Spotify_MWP_192.png":"https://open.scdn.co/cdn/images/icons/Spotify_MWP_192.c70b9055.png","images/icons/Spotify_MWP_512.png":"https://open.scdn.co/cdn/images/icons/Spotify_MWP_512.591cfa88.png","images/improved-modal-bg.jpg":"https://open.scdn.co/cdn/images/improved-modal-bg.23e5dcb1.jpg","images/login-background.jpg":"https://open.scdn.co/cdn/images/login-background.078204fe.jpg","images/login-signup-burst.svg":"https://open.scdn.co/cdn/images/login-signup-burst.5f6a6521.svg","images/logo-complete-black.svg":"https://open.scdn.co/cdn/images/logo-complete-black.573d8227.svg","images/logo-white-2x.png":"https://open.scdn.co/cdn/images/logo-white-2x.ef36ed81.png","images/merlin.png":"https://open.scdn.co/cdn/images/merlin.cd7e72d1.png","images/mid-year.png":"https://open.scdn.co/cdn/images/mid-year.9e2ead8f.png","images/moviebuff.png":"https://open.scdn.co/cdn/images/moviebuff.65e80213.png","images/og-image.png":"https://open.scdn.co/cdn/images/og-image.64b84348.png","images/orchard.png":"https://open.scdn.co/cdn/images/orchard.677c5ae0.png","images/rovi.png":"https://open.scdn.co/cdn/images/rovi.7b503678.png","images/s2l-desktopui-ltr.png":"https://open.scdn.co/cdn/images/s2l-desktopui-ltr.3024b050.png","images/s2l-desktopui-rtl.png":"https://open.scdn.co/cdn/images/s2l-desktopui-rtl.a9690daf.png","images/s2l-mobileui.png":"https://open.scdn.co/cdn/images/s2l-mobileui.9fc9d151.png","images/sony.png":"https://open.scdn.co/cdn/images/sony.7e5692e6.png","images/spotifylogo.svg":"https://open.scdn.co/cdn/images/spotifylogo.a884cca3.svg","images/station-header-wave.svg":"https://open.scdn.co/cdn/images/station-header-wave.0f3784ea.svg","images/station-wave.svg":"https://open.scdn.co/cdn/images/station-wave.2b7b882c.svg","images/sw_saber_ahsoka1.png":"https://open.scdn.co/cdn/images/sw_saber_ahsoka1.5495e812.png","images/sw_saber_anakin.png":"https://open.scdn.co/cdn/images/sw_saber_anakin.a7ba22d2.png","images/sw_saber_leia.png":"https://open.scdn.co/cdn/images/sw_saber_leia.1146243b.png","images/sw_saber_luke.png":"https://open.scdn.co/cdn/images/sw_saber_luke.e4e10033.png","images/sw_saber_mace.png":"https://open.scdn.co/cdn/images/sw_saber_mace.1ba83c7d.png","images/sw_saber_rey.png":"https://open.scdn.co/cdn/images/sw_saber_rey.994789b5.png","images/sw_saber_vader.png":"https://open.scdn.co/cdn/images/sw_saber_vader.070f862b.png","images/touch-icon-114.png":"https://open.scdn.co/cdn/images/touch-icon-114.0d424df2.png","images/touch-icon-144.png":"https://open.scdn.co/cdn/images/touch-icon-144.36faaf96.png","images/touch-icon-57.png":"https://open.scdn.co/cdn/images/touch-icon-57.5460f415.png","images/touch-icon-72.png":"https://open.scdn.co/cdn/images/touch-icon-72.cffecbdb.png","images/tracklist-placeholder.png":"https://open.scdn.co/cdn/images/tracklist-placeholder.59aa68d8.png","images/tracklist-row-episode-fallback.svg":"https://open.scdn.co/cdn/images/tracklist-row-episode-fallback.e8ae3577.svg","images/tracklist-row-song-fallback.svg":"https://open.scdn.co/cdn/images/tracklist-row-song-fallback.4db3ccfe.svg","images/tracklist-row-video-fallback.svg":"https://open.scdn.co/cdn/images/tracklist-row-video-fallback.954459da.svg","images/universal.png":"https://open.scdn.co/cdn/images/universal.3ceb95fd.png","images/vinyl-bottom-layer.svg":"https://open.scdn.co/cdn/images/vinyl-bottom-layer.82d9f6ef.svg","images/vinyl-top-layer.svg":"https://open.scdn.co/cdn/images/vinyl-top-layer.b56c3ccf.svg","images/warner.png":"https://open.scdn.co/cdn/images/warner.a5039776.png","images/zara-larsson-singles.png":"https://open.scdn.co/cdn/images/zara-larsson-singles.59dbba9e.png","js/fb.js":"https://open.scdn.co/cdn/js/fb.83cf1e53.js","js/gtag.js":"https://open.scdn.co/cdn/js/gtag.343176db.js","js/gtm.js":"https://open.scdn.co/cdn/js/gtm.6d498f08.js","js/retargeting-pixels.js":"https://open.scdn.co/cdn/js/retargeting-pixels.1fa1ceda.js","js/urlRedirect.js":"https://open.scdn.co/cdn/js/urlRedirect.156df566.js","js/urlScheme.js":"https://open.scdn.co/cdn/js/urlScheme.f1e6e8b6.js"}'}.OUTRO_SNOOPING,connection_id:this._connectionId,client_version:this._clientVersion,previous_session_state:e,volume:this._currentGaiaVolume}).then(this._handleRegisterResponse).catch((function(e){return e&&!e.maxedSubscriptions&&(e.registration=!0,t._emitError(e)),!1}))}}],[{key:"create",value:function(e){return new n(e)}}]),n}(ne.vp);function _r(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var fr,gr=function(e){v()(n,e);var t=_r(n);function n(e){var r;return h()(this,n),(r=t.call(this))._client=e.client,r._initialVolume=e.initialVolume,r._listPlayer=e.listPlayer,r._playerPromise=e.playerPromise,r._playbackServiceClient=e.playbackServiceClient,r._playbackStateObserver=e.playbackStateObserver,r._stopOnBackground=e.stopOnBackground,r._init(),r}return f()(n,[{key:"_init",value:function(){var e,t,n,r=this;this._client.addListeners((e={},i()(e,"before_disconnect",this._onClientBeforeDisconnect.bind(this)),i()(e,"before_offline_disconnect",this._onClientBeforeOfflineDisconnect.bind(this)),e));var s=this._listPlayer;s.addListeners((t={},i()(t,yt.LIST_PLAYER_CAPPED,this._onCapped.bind(this)),i()(t,yt.LIST_PLAYER_TRACK_ENDED,this._onTrackEnded.bind(this)),i()(t,yt.LIST_PLAYER_BEFORE_VOLUME_CHANGE,this._onBeforeVolumeChange.bind(this)),i()(t,yt.LIST_PLAYER_VOLUME_CHANGED,this._onVolumeChanged.bind(this)),i()(t,yt.LIST_PLAYER_ERROR,this._onError.bind(this,ie.PLAYBACK)),t)),this.proxyEmitAll(s,(n={},i()(n,yt.LIST_PLAYER_AUTOPLAY_FAILED,"autoplay_failed"),i()(n,yt.LIST_PLAYER_TRACK_LOADED,"track_loaded"),i()(n,yt.LIST_PLAYER_DURATION_CHANGED,"duration_changed"),i()(n,yt.LIST_PLAYER_POSITION_CHANGED,"position_changed"),i()(n,yt.LIST_PLAYER_PROGRESS,"progress"),i()(n,yt.LIST_PLAYER_BUFFER_STALLED,"stalled"),i()(n,yt.LIST_PLAYER_BUFFERING_END,"buffering_end"),i()(n,yt.LIST_PLAYER_BUFFERING_START,"buffering_start"),i()(n,yt.LIST_PLAYER_MAX_LIST_ERRORS_REACHED,"max_list_errors_reached"),i()(n,yt.LIST_PLAYER_VIDEO_ELEMENT_APPENDED,"video_element_appended"),i()(n,yt.LIST_PLAYER_VIDEO_ELEMENT_REMOVED,"video_element_removed"),i()(n,yt.LIST_PLAYER_LIST_ENDED,"context_ended"),n));var o,a=this._playbackServiceClient;a instanceof hr&&(a.addListeners((o={},i()(o,"logout",this._onTPAPILogout.bind(this)),i()(o,"error",this._onError.bind(this,ie.TRACK_PLAYBACK)),o)),this.proxyEmit(a,"max_subscriptions_reached","max_subscriptions_reached"),this.proxyEmit(a,"deregistered","deregistered"),this.proxyEmit(a,"registered","registered"),this.proxyEmit(a,"registration_aborted","registration_aborted"),this.proxyEmitSync(a,"internal_endcontent","internal_endcontent"));this.proxyEmit(this._playbackStateObserver,"state_changed","state_changed"),this._stopOnBackground&&document.addEventListener&&document.addEventListener("visibilitychange",(function(){document.hidden&&r.stop()&&r.emitSync("stopped_on_background",null)})),this._playerPromise.then((function(e){e.setVolume(r._initialVolume),r.emit("player_initialization_done",null)}),(function(e){r.emit("player_initialization_failed",{reason:e.message,error:e})}))}},{key:"_assertOperationSuccess",value:function(e){return e===St.SUCCESS}},{key:"_onTrackEnded",value:function(){this.emit("track_ended",null)}},{key:"_onClientBeforeDisconnect",value:function(e){e.data.awaitPromise(this.deregister().catch((function(){})))}},{key:"_onClientBeforeOfflineDisconnect",value:function(e){e.data.awaitPromise(this.pause().catch((function(){})))}},{key:"_onBeforeVolumeChange",value:function(e){var t;this.emitSync("before_volume_change",{volume:e.data.volume,remote:!!(null===(t=e.data.options)||void 0===t?void 0:t.commandId)}).defaultPrevented&&e.preventDefault()}},{key:"_onVolumeChanged",value:function(e){this.emit("volume_changed",{volume:e.data.volume,remote:!!e.data.commandId})}},{key:"_onCapped",value:function(){this.emit("playback_capped",null)}},{key:"_onError",value:function(e,t){var n=t.data.error;n&&(n&&"registration"in n&&n.registration&&e===ie.TRACK_PLAYBACK&&this.emit("registration_error",{error:n}),this.emit("error",{source:e,error:n}),this._client.notifyError(e,n))}},{key:"_onTPAPILogout",value:function(){this.emit("logged_out",null)}},{key:"stop",value:function(){return this._playbackServiceClient.stop()}},{key:"register",value:function(){return this._playbackServiceClient.register()}},{key:"deregister",value:function(){return this._playbackServiceClient.deregister()}},{key:"resume",value:function(){return this._listPlayer.resume().then(this._assertOperationSuccess)}},{key:"pause",value:function(){return this._listPlayer.pause().then(this._assertOperationSuccess)}},{key:"nextTrack",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z.FORWARD_BUTTON;return this._listPlayer.next(e).then(this._assertOperationSuccess)}},{key:"canChangeTrack",value:function(){return this._listPlayer.canChangeTrack()}},{key:"previousTrack",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z.BACK_BUTTON;return this._listPlayer.previous(e).then(this._assertOperationSuccess)}},{key:"togglePlay",value:function(){return this._listPlayer.togglePlay().then(this._assertOperationSuccess)}},{key:"setVolume",value:function(e){return this._listPlayer.setVolume(e).then(this._assertOperationSuccess)}},{key:"getVolume",value:function(){return this._listPlayer.getVolume()}},{key:"seek",value:function(e){return this._listPlayer.seek(e).then(this._assertOperationSuccess)}},{key:"getCurrentState",value:function(){return this._playbackStateObserver.getCurrentState()}},{key:"getVideoVariants",value:function(){return this._playerPromise.then((function(e){return e.getVideoVariants()}))}},{key:"setPreferredBitrate",value:function(e){var t=this;return this._playerPromise.then((function(n){return n.setPreferredBitrate(e).then(t._assertOperationSuccess)}))}},{key:"setVideoResolution",value:function(e){return this._playerPromise.then((function(t){return t.setVideoResolution(e)}))}},{key:"setBackgrounded",value:function(e){return this._playerPromise.then((function(t){return t.setBackgrounded(e)}))}},{key:"activateElement",value:function(){return this._playerPromise.then((function(e){return e.activateElement()}))}},{key:"hideSubtitles",value:function(){return this._listPlayer.hideSubtitles().then(this._assertOperationSuccess)}},{key:"showSubtitles",value:function(){return this._listPlayer.showSubtitles().then(this._assertOperationSuccess)}},{key:"areSubtitlesShown",value:function(){return this._listPlayer.areSubtitlesShown()}},{key:"getSubtitleLanguages",value:function(){return this._listPlayer.getSubtitleLanguages()}},{key:"getActiveSubtitleLanguage",value:function(){return this._listPlayer.getActiveSubtitleLanguage()}},{key:"setSubtitleLanguage",value:function(e){return this._listPlayer.setSubtitleLanguage(e).then(this._assertOperationSuccess)}},{key:"getMediaConfig",value:function(){return this._listPlayer.getMediaConfig()}}]),n}(ne.vp),mr=function(){function e(t,n){h()(this,e),this._stateMachine=null,this._currentState=null,this._currentStateIndex=null,this._pausedState=!1,this._initialPlaybackPosition=null,this._uri=t,this._manifestTrackResolver=n}return f()(e,[{key:"setPaused",value:function(e){this._pausedState=e}},{key:"isPaused",value:function(){return this._currentStateIndex&&this._currentStateIndex<0&&this._currentState&&this._currentState.transitions.advance?!!this._currentState.transitions.advance.paused:this._pausedState}},{key:"setInitialPosition",value:function(e){this._initialPlaybackPosition=e}},{key:"setStateMachine",value:function(e){this._stateMachine=e}},{key:"setDeviceId",value:function(e){this._deviceId=e}},{key:"startAtState",value:function(e){var t=this._stateMachine&&this._stateMachine.states[e.state_index];if(!t)throw new rr(Q.TP_MISSING_INITIAL_STATE,"Invalid state reference.");var n=t.transitions;this._currentStateIndex=-1,this._currentState={decoy:!0,paused:!!e.paused,track:-1,state_id:null,transitions:{advance:e,show_next:n.show_next,show_prev:n.show_prev,skip_next:e,skip_prev:n.skip_prev}}}},{key:"setCurrentState",value:function(e){var t=e.state_index;this._currentStateIndex=t,this._currentState=this._stateMachine&&this._stateMachine.states[t]}},{key:"getStateMachine",value:function(){return this._stateMachine}},{key:"getInternalStateRef",value:function(){var e=this._pausedState,t=this._currentStateIndex;if(!t)return null;if(t&&t<0){var n=this._currentState&&this._currentState.transitions.advance;n&&(t=n.state_index,e=!!n.paused)}return{paused:e,state_index:t}}},{key:"getStateRef",value:function(){var e,t,n=this._stateMachine;if(!n||null===this._currentStateIndex)return null;if(this._currentStateIndex<0){var r=this._currentState&&this._currentState.transitions.advance;r&&(e=n.states[r.state_index],t=r.paused)}else e=n.states[this._currentStateIndex],t=this._pausedState;return e?{state_machine_id:n.state_machine_id,state_id:e.state_id,paused:!!t}:null}},{key:"getCurrentTrack",value:function(){var e,t=this._stateMachine;if(!t||null===this._currentStateIndex)return null;if(this._currentStateIndex<0){var n=this._currentState&&this._currentState.transitions.advance;n&&(e=t.states[n.state_index])}else e=t.states[this._currentStateIndex];return e?t.tracks[e.track]:null}},{key:"startAt",value:function(){return Promise.resolve(St.SUCCESS)}},{key:"setShuffle",value:function(){return Promise.resolve(St.SUCCESS)}},{key:"setRepeatMode",value:function(){return Promise.resolve(St.SUCCESS)}},{key:"next",value:function(e){var t=this._currentState,n=null;if(t){var r=t.transitions;switch(e.reason){case Z.FORWARD_BUTTON:"skip_next"in r&&(n=r.skip_next);break;default:"advance"in r&&(n=r.advance)}}return this._transitionTo(e,n,!1)}},{key:"peekNext",value:function(e){var t=this._currentState,n=null;if(t){var r=t.transitions;switch(e.reason){case Z.FORWARD_BUTTON:"skip_next"in r&&(n=r.skip_next);break;default:"advance"in r&&(n=r.advance)}}return this._transitionTo(e,n,!0)}},{key:"previous",value:function(e){var t=this._currentState,n=null;t&&(n=t.transitions.skip_prev);return this._transitionTo(e,n,!1)}},{key:"allowSeeking",value:function(){return!!this._currentState&&!this._currentState.disallow_seeking}},{key:"_transitionTo",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise((function(i){var s,o=e.reason,a=e.listConstants;if(!t)return i(a.FORBIDDEN);var c=n._stateMachine;if(!c)return i(a.NULL_VALUE);var l=c.states[t.state_index];if(!l)return i(a.NULL_VALUE);var u=c.tracks[l.track];if(!(null===(s=null==u?void 0:u.metadata)||void 0===s?void 0:s.uri))return i(a.NULL_VALUE);if(!n._currentState)return i(a.NULL_VALUE);var d=n._currentState,p=d.decoy?!!d.paused:t.paused;r||(n._currentState=l,n._currentStateIndex=t.state_index,n._pausedState=!!p);var h=0;return r||null===n._initialPlaybackPosition?"initial_playback_position"in l&&(h=l.initial_playback_position||0):(h=n._initialPlaybackPosition,n._initialPlaybackPosition=null),n._manifestTrackResolver.resolveFromStateTrack(u).then((function(e){if(!e)return i(a.NULL_VALUE);var t=n._uri;u.metadata&&u.metadata.context_uri&&(t=u.metadata.context_uri);var r=o,s=u.ms_played_until_update,c={playbackQuality:e.playbackQuality,hifiStatus:e.hifi_status},d={uri:e.uri,playableURI:e.uri,fileId:e.fileId,resolvedURL:e.resolvedURL,playable:e.playable,isAd:e.isAd,format:e.format,fileFormat:e.fileFormat,mediaType:e.mediaType,noManifest:e.noManifest,metadata:c,options:{position:h,paused:p,playedThreshold:s},logData:{noLog:!!e.noLog,noTSV:!!e.noTSV,noStats:!!e.noStats,deviceId:n._deviceId,playbackId:l.state_id?l.state_id:void 0,reason:r,displayTrack:e.uri,playContext:t,impressionURL:e.impressionURL,impressionURLs:e.impressionURLs,format:{codec:e.format,bitrate:e.bitrate},uriType:e.uriType},stateId:l.state_id?l.state_id:void 0};return i(d)}))}))}}],[{key:"create",value:function(t,n){return new e(t,n)}}]),e}(),yr=n(1573);!function(e){e.ON="ON",e.OFF="OFF",e.NONE="NONE"}(fr||(fr={}));var vr=/^disallow_([^]+)_reasons$/;function Er(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var Sr,br=ke.P.forTag("tp.stream.PlaybackStateObserver"),Tr=function(e){v()(n,e);var t=Er(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return h()(this,n),(r=t.call(this))._tpApiClient=e,r._numPreviousTracks=i.numPrevious||2,r._numNextTracks=i.numNextTracks||2,r._currentState=null,r._init(),r}return f()(n,[{key:"_init",value:function(){this._tpApiClient.on("state_changed",this._onStateChanged.bind(this)),this._tpApiClient.on("state_cleared",this._onStateCleared.bind(this))}},{key:"_onStateChanged",value:function(e){var t,n,r,i,s,o,a,c,l=e.data,u=l.stateMachine,d=l.stateRef,p=l.position,h=l.paused,_=l.loading,f=l.currentTrackInfo,g=null==u?void 0:u.states;if(u&&(null==g?void 0:g.length)&&d){var m=g[d.state_index],y=u.tracks[m.track];if(m&&y){var v=null!==(t=f.duration)&&void 0!==t?t:0,E=this._createTrackWindow(u,m,v);v||(v=null!==(r=null===(n=E.current_track)||void 0===n?void 0:n.duration_ms)&&void 0!==r?r:0);var S=function(e,t){var n={};for(var r in e)e.hasOwnProperty(r)&&"disallow_resuming_reasons"!==r&&"disallow_pausing_reasons"!==r&&(n[r]=e[r]);return t?n.disallow_pausing_reasons=["already_paused"]:n.disallow_resuming_reasons=["not_paused"],n}(m.restrictions||{},h),b=function(e){var t={};for(var n in e)if(e.hasOwnProperty(n)){var r=e[n],i=!(!r||!r.length);t[n.replace(vr,"$1")]=i}return t}(S),T={timestamp:Date.now(),context:{uri:null!==(s=null===(i=y.metadata)||void 0===i?void 0:i.context_uri)&&void 0!==s?s:null,metadata:{}},position:p,duration:v,paused:h,playback_quality:null!==(o=f.playbackQuality)&&void 0!==o?o:qn.UNKNOWN,playback_features:{hifi_status:null!==(a=f.hifiStatus)&&void 0!==a?a:fr.NONE},shuffle:this._getShuffleSetting(u),repeat_mode:this._getRepeatSetting(u),track_window:E,restrictions:S,disallows:b,loading:_};(null===(c=y.metadata)||void 0===c?void 0:c.context_description)&&(T.context.metadata.context_description=y.metadata.context_description),this._currentState=T,this.emit("state_changed",{state:T?Object.assign({},T):null})}else br.warn("_onStateChanged called with no current state or track",e)}else br.warn("_onStateChanged called with no current state",e)}},{key:"_createTrackWindow",value:function(e,t,n){var r=this,i=e.states;return{current_track:this._getTrackMetadata(e,t,n),next_tracks:this._getNextStates(t,i).map((function(t){return r._getTrackMetadata(e,t,null)})).filter((function(e){return!!e})),previous_tracks:this._getPreviousStates(t,i).map((function(t){return r._getTrackMetadata(e,t,null)})).filter((function(e){return!!e}))}}},{key:"_onStateCleared",value:function(){this._currentState=null,this.emit("state_changed",{state:null})}},{key:"_getRepeatSetting",value:function(e){var t=e.attributes.options;return t.repeating_track?se.TRACK:t.repeating_context?se.CONTEXT:se.OFF}},{key:"_getShuffleSetting",value:function(e){return e.attributes.options.shuffling_context}},{key:"_getNextStates",value:function(e,t){for(var n=this._numNextTracks,r=[],i=e;i&&"show_next"in i.transitions&&i.transitions.show_next;){var s=t[i.transitions.show_next.state_index];if(r.push(s),i=s,r.length>=n)break}return r}},{key:"_getPreviousStates",value:function(e,t){for(var n=this._numPreviousTracks,r=[],i=e;i&&"show_prev"in i.transitions&&i.transitions.show_prev;){var s=t[i.transitions.show_prev.state_index];if(r.unshift(s),i=s,r.length>=n)break}return r}},{key:"_getTrackMetadata",value:function(e,t,n){var r=null==e?void 0:e.tracks[t.track];if(!(null==r?void 0:r.metadata))return null;var i=r.metadata,s=r.manifest&&"manifest_ids_video"in r.manifest,o=r.track_type.toLowerCase(),a=yr.from(i.uri),c=i.linked_from_uri?yr.from(i.linked_from_uri):null;return{id:a?yr.hexToId(a.id):null,uri:i.uri,type:(null==a?void 0:a.type)||"unknown",uid:t.track_uid,linked_from:{uri:i.linked_from_uri||null,id:c?yr.hexToId(c.id):null},media_type:s?"video":"audio",track_type:o,name:i.name,duration_ms:n||i.duration,artists:i.authors,album:{uri:i.group_uri,name:i.group_name,images:i.images},is_playable:!0}}},{key:"getCurrentState",value:function(){var e=this._currentState;if(e&&!e.paused){var t=Date.now(),n=e.position+(t-e.timestamp);e.position=n,e.timestamp=t}return Promise.resolve(this._currentState?Object.assign({},this._currentState):null)}}],[{key:"create",value:function(e,t){return new n(e,t)}}]),n}(ne.vp);function Cr(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ir(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ir(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){a=!0,s=e},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw s}}}}function Ir(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Rr=/^https:\/\//,Pr=/^(.+?)\/([^./]+)(\.[^/]*)?$/,Ar=(Sr={},i()(Sr,Ye.FILE_URLS_MP3,bt.MP3),i()(Sr,Ye.FILE_URLS_EXTERNAL,bt.MP3),i()(Sr,Ye.FILE_IDS_MP4,bt.MP4),i()(Sr,Ye.FILE_IDS_MP4_DUAL,bt.MP4),i()(Sr,Ye.FILE_IDS_CBCS,bt.MP4_CBCS),i()(Sr,Ye.FILE_IDS_MP4FLAC,bt.MP4_FLAC),i()(Sr,Ye.MANIFEST_IDS_VIDEO,bt.MANIFEST_ID),Sr),Or=function(){function e(t){h()(this,e),this._descriptor=t.descriptor,this._listPlayer=t.listPlayer}return f()(e,[{key:"_resolveFromStateTrack",value:function(e,t,n){for(var r,i,s=e.manifest,o=e.metadata.uri,a=yr.from(o),c=null,l=0;l<n.length;l++){var u=n[l],d=s[u];if(d){var p,h=Cr(d);try{for(h.s();!(p=h.n()).done;){var _=p.value;if(_.file_id||_.file_url){var f=!(!a||a.type!==yr.Type.AD&&a.type!==yr.Type.INTERRUPTION),g=_.file_url,m=_.file_id||"";if(g&&u===Ye.FILE_URLS_MP3&&f){if((m=g.replace(Pr,"$2"))===g)continue;g=void 0}if(g&&!Rr.test(g)&&(g=void 0),m||g){var y=void 0;y=_.track_type?_.track_type.toLowerCase():u===Ye.MANIFEST_IDS_VIDEO?"video":"audio";var v=void 0;if(_.format){var E=parseInt(_.format,10);dn[E]&&(v=E)}var S=null!==(r=_.bitrate)&&void 0!==r?r:u===Ye.FILE_IDS_MP4FLAC?1411200:128e3,b=null!==(i=_.bitrate)&&void 0!==i?i:u===Ye.FILE_IDS_MP4FLAC?7e5:128e3;if(c={uri:o,uriType:a&&a.type?a.type:void 0,fileId:m,resolvedURL:g,mediaType:y,format:Ar[u],bitrate:b,fileFormat:null!=v?v:void 0,playbackQuality:_.audio_quality,hifi_status:_.hifi_status,impressionURL:_.impression_url,impressionURLs:_.impression_urls,isAd:f,noLog:!1,noTSV:f,noStats:f,noManifest:!!_.file_url,playable:!0},u===Ye.MANIFEST_IDS_VIDEO||S<=t)return c}}}}catch(T){h.e(T)}finally{h.f()}}}return c}},{key:"resolveFromStateTrack",value:function(e){var t=this;return Promise.all([Promise.resolve(this._descriptor),this._listPlayer.getCurrentBandwidth()]).then((function(n){var r=te()(n,2),i=r[0],s=r[1];return t._resolveFromStateTrack(e,s,i.getManifestFormats())}))}}],[{key:"create",value:function(t){return new e(t)}}]),e}();var kr,Lr=n(9294);n(6252),n(9217),n(190);function wr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}!function(e){e.LOCAL_PLAYER_DISABLED="local_player_disabled",e.STOPPED="stopped",e.REMOTE_ACTIVATED="remote_activated",e.UNKNOWN="unknown"}(kr||(kr={}));var Dr=function(e){v()(n,e);var t=wr(n);function n(e,r){var i;return h()(this,n),(i=t.call(this,r)).status=-1,i.maxedSubscriptions=!1,i.unrecoverable=!1,i.debug={},i.code=e,i.name="PlayerAPIClientError",i}return f()(n,null,[{key:"fatal",value:function(e,t){var r=new n(e,t);return r.unrecoverable=!0,r}}]),n}(le()(Error));function Nr(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ur(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ur(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){a=!0,s=e},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw s}}}}function Ur(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Mr=function(){function e(t){h()(this,e),this._transport=t.transport,this._metadataCache=new at.z6(t.cacheSize||20)}return f()(e,[{key:"_decorateTrackWindow",value:function(e){var t,n,r,i=this._metadataCache,s={current_track:null,next_tracks:[],previous_tracks:[]};e.current_track&&(n=i&&e.current_track&&"uri"in e.current_track&&i.get(e.current_track.uri),s.current_track=Object.assign({uid:e.current_track.uid},n||e.current_track)),t=e.next_tracks.length;for(;t--;)r=e.next_tracks[t],n=i&&r&&"uri"in r&&i.get(r.uri),s.next_tracks[t]=Object.assign({uid:r.uid},n||r);for(t=e.previous_tracks.length;t--;)r=e.previous_tracks[t],n=i&&r&&"uri"in r&&i.get(r.uri),s.previous_tracks[t]=Object.assign({uid:r.uid},n||r);return s}},{key:"_buildTrackList",value:function(e){var t,n=[],r={},i=Nr([e.current_track].concat(fe()(e.next_tracks),fe()(e.previous_tracks)));try{for(i.s();!(t=i.n()).done;){var s=t.value;s&&!r[s.uri]&&n.push(s.uri)}}catch(o){i.e(o)}finally{i.f()}return n}},{key:"_cacheMetadata",value:function(e){for(var t=[],n=[],r=this._metadataCache,i=0,s=e.length;i<s;i++){var o=e[i];if(!r.get(o)){var a=yr.from(o);if(a){var c=yr.hexToId(a.id);a.type===yr.Type.TRACK?n.push(c):a.type===yr.Type.EPISODE&&t.push(c)}}}return t.length||n.length?Promise.all([this._requestMultiData("episodes",t),this._requestMultiData("tracks",n)]).then((function(e){var t=te()(e,2),n=t[0],r=t[1];return!!n||!!r})):Promise.resolve(!0)}},{key:"_requestMultiData",value:function(e,t){var n=this;if(!t.length)return Promise.resolve(!1);var r=this._metadataCache,i=["https://@webapi/v1/",e,"?ids=",t.join(","),"&market=from_token"].join("");return this._transport.request(i,{responseType:"json"}).then((function(t){var i;if(200!==t.status)return!1;var s=null===(i=t.body)||void 0===i?void 0:i[e];if(!s)return!1;for(var o=s.length;o--;){var a=s[o];a&&("episodes"===e?a=n._formatEpisodeData(a):(a.track_type="audio",a.media_type="audio"),r&&r.set(a.uri,a),r&&a.linked_from&&a.linked_from.uri&&r.set(a.linked_from.uri,a))}return!0}))}},{key:"_formatEpisodeData",value:function(e){var t="audio"===e.show.media_type?"audio":"video";return{id:e.id,uri:e.uri,type:"episode",media_type:t,track_type:e.show.media_type,name:e.name,artists:[{uri:e.show.uri,name:e.show.publisher}],album:{uri:e.show.uri,name:e.show.name,images:e.images},duration_ms:e.duration_ms||0,is_playable:!0}}},{key:"formatLocalTrack",value:function(e,t){return e&&e.type===yr.Type.LOCAL?{uri:e.toURI(),type:"local",uid:t,media_type:"audio",track_type:"audio",name:e.track,artists:[{uri:yr.localArtistURI(e.artist).toURI(),name:e.artist}],album:{uri:yr.localAlbumURI(e.artist,e.album).toURI(),name:e.album,images:[{url:""}]},duration_ms:e.duration?1e3*e.duration:0,is_playable:!1}:null}},{key:"formatAd",value:function(e,t){if(!e||e.type!==yr.Type.AD&&e.type!==yr.Type.INTERRUPTION)return null;if(!t||!t.metadata)return null;var n=t.metadata;return{id:e.id,uri:e.toURI(),type:e.type,uid:t.uid,media_type:"audio",track_type:"audio",name:n.advertiser,artists:[{uri:n.click_url,name:n.buttonMessage||n.advertiser}],album:{uri:n.click_url,name:n.advertiser,images:[{url:n.image_url}]},duration_ms:parseInt(n.duration,10),is_playable:!1}}},{key:"decorateTrackWindow",value:function(e,t){var n=this,r=null!=t?t:this._buildTrackList(e);return this._cacheMetadata(r).then((function(t){return t?n._decorateTrackWindow(e):e}))}}],[{key:"create",value:function(t){return new e(t)}}]),e}();function Br(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}function xr(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Fr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Fr(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){a=!0,s=e},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw s}}}}function Fr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var jr=ke.P.forTag("harmony.controller"),Yr=/^disallow_([^]+)_reasons$/,Kr={disallow_pausing_reasons:!0,disallow_peeking_next_reasons:!0,disallow_peeking_prev_reasons:!0,disallow_resuming_reasons:!0,disallow_seeking_reasons:!0,disallow_skipping_next_reasons:!0,disallow_skipping_prev_reasons:!0,disallow_toggling_repeat_context_reasons:!0,disallow_toggling_repeat_track_reasons:!0,disallow_toggling_shuffle_reasons:!0,disallow_transferring_playback_reasons:!0},Hr="premium",Vr="on-demand",Gr={unknown:qn.UNKNOWN,default:qn.DEFAULT,low:qn.LOW,normal:qn.NORMAL,normalized:qn.NORMAL,high:qn.HIGH,veryhigh:qn.VERY_HIGH,hifi:qn.HIFI},Wr={on:fr.ON,off:fr.OFF,none:fr.NONE};function qr(e,t){if(!e)return[];for(var n=[],r=[yr.Type.TRACK,yr.Type.EPISODE],i=0,s=e.length;i<s;i++){var o=e[i];if(!o)throw new TypeError("Null value inside track array.");var a=void 0;if("string"==typeof o?(a=yr.from(o),o={uri:o}):a=yr.from(o.uri),!/^spotify:(meta:|delimiter)/.test(o.uri)){if(!a)throw new TypeError("Invalid uri string: ".concat(a));if(-1===r.indexOf(a.type))throw new TypeError("Invalid track uri: ".concat(o.uri))}o.metadata||(o.metadata={}),t&&t.queued&&(o.metadata.is_queued="true"),n.push(o)}return n}function zr(e){if(e){if(/^.+:\/\//.test(e))return e;throw new TypeError("Invalid page url: ".concat(e))}}var $r=function(e){v()(n,e);var t=Br(n);function n(e){var r;return h()(this,n),(r=t.call(this))._suppressed=!1,r._lastDeviceInfoData=null,r._state=null,r._lastPlayerState=null,r._isOrphanedState=!1,r._progressPosition=0,r._lastProgressTs=0,r._trackingIntervalId=0,r._queue=null,r._client=e.client,r._serverTime=e.serverTime,r._version=e.version,r._playerClient=e.playerClient,r._disableProgress=!!e.disableProgress,r._transport=r._client.getPublicTransport(),r._decorate=!!e.decorateTrackWindow,r._metadataDecorator=new Mr({transport:r._transport}),r._onClientBeforeDisconnect=r._onClientBeforeDisconnect.bind(m()(r)),r._onDeviceStateChanged=r._onDeviceStateChanged.bind(m()(r)),r._onPlayerStateChanged=r._onPlayerStateChanged.bind(m()(r)),r._onProgressTracking=r._onProgressTracking.bind(m()(r)),r._client.on("before_disconnect",r._onClientBeforeDisconnect),r.proxyEmit(r._playerClient,"max_subscriptions_reached","max_subscriptions_reached"),r.proxyEmit(r._playerClient,"devices_changed","devices_changed"),r.proxyEmit(r._playerClient,"registered","registered"),r.proxyEmit(r._playerClient,"deregistered","deregistered"),r._playerClient.on("device_state_changed",r._onDeviceStateChanged),r._playerClient.on("player_state_changed",r._onPlayerStateChanged),r}return f()(n,[{key:"_onClientBeforeDisconnect",value:function(e){e&&e.data.awaitPromise(this._playerClient.deregister().catch((function(){})))}},{key:"_onDeviceStateChanged",value:function(e){var t,n,r=this,i=e.data,s=i.deviceState,o=i.hasOrphanedState,a=!!(null===(n=null===(t=this._lastDeviceInfoData)||void 0===t?void 0:t.deviceInfo)||void 0===n?void 0:n.local);this._lastDeviceInfoData={deviceInfo:s,hasOrphanedState:o},a&&!(null==s?void 0:s.local)&&this._playerClient.getDevices().then((function(e){var t=e.localDevice,n=kr.STOPPED;o?t||(n=kr.LOCAL_PLAYER_DISABLED):n=kr.REMOTE_ACTIVATED,r.emit("device_deactivated",{reason:n})})).catch((function(e){jr.warn("Device deactivation checking failed.",e)})),this._suppressed||this.emit("device_info_changed",this._lastDeviceInfoData)}},{key:"_startProgressTracking",value:function(){this._stopProgressTracking(),this._lastProgressTs=Date.now(),this._onProgressTracking(),this._trackingIntervalId=setInterval(this._onProgressTracking,500)}},{key:"_stopProgressTracking",value:function(){this._trackingIntervalId&&(clearInterval(this._trackingIntervalId),this._trackingIntervalId=0)}},{key:"_onProgressTracking",value:function(){var e,t=Date.now(),n=(null===(e=this._lastPlayerState)||void 0===e?void 0:e.playback_speed)||1;this._progressPosition+=n*(t-this._lastProgressTs),this.emit("progress",{position:this._progressPosition,timestamp:Date.now()}),this._lastProgressTs=t}},{key:"_getLicense",value:function(){return this._client.getProductState().then((function(e){return"premium"===e.product?Hr:Vr})).catch((function(){return Vr}))}},{key:"_generatePlayOptions",value:function(e,t){return this._getLicense().then((function(n){var r={license:n};if(!e)return r;if(("index"in e||"trackUID"in e||"trackURI"in e||"pageIndex"in e)&&(r.skip_to={track_uid:e.trackUID,track_index:e.index,track_uri:e.trackURI,page_index:e.pageIndex}),"initialOffset"in e&&(r.seek_to=e.initialOffset),"paused"in e&&(r.initially_paused=e.paused),"alwaysPlaySomething"in e&&(r.always_play_something=e.alwaysPlaySomething),t)return r;r.player_options_override={};var i=r.player_options_override;if("shuffle"in e&&(i.shuffling_context=e.shuffle),"repeatMode"in e)switch(e.repeatMode){case se.CONTEXT:i.repeating_context=!0,i.repeating_track=!1;break;case se.TRACK:i.repeating_track=!0,i.repeating_context=!1;break;case se.OFF:i.repeating_track=!1,i.repeating_context=!1}return r}))}},{key:"_setFilterAndSort",value:function(e,t){t&&t.filter&&e.metadata&&(e.metadata["filtering.predicate"]=t.filter),t&&t.sort&&e.metadata&&(e.metadata["sorting.criteria"]=t.sort)}},{key:"_setMetadataOptions",value:function(e,t){if(t){var n=e.metadata||{};"autoplayCandidate"in t&&(n.autoplay_candidate=t.autoplayCandidate?"true":"false"),e.metadata=n}}},{key:"_generatePlayOrigin",value:function(e){if(e&&e.featureClasses&&!Array.isArray(e.featureClasses))throw new TypeError("PlayOptions playOrigin.featureClasses must be an array of strings.");return{feature_identifier:e&&e.featureIdentifier||"harmony",feature_version:e&&e.featureVersion||this._version,feature_classes:e&&e.featureClasses,view_uri:e&&e.viewURI,external_referrer:e&&e.externalReferrer,referrer_identifier:e&&e.referrerIdentifier}}},{key:"_generateLoggingParams",value:function(e){var t=e.pageInstanceId,n=e.interactionId;return{page_instance_ids:t?[t]:[],interaction_ids:n?[n]:[]}}},{key:"_parseRestrictions",value:function(e){var t={};for(var n in e.restrictions)e.restrictions.hasOwnProperty(n)&&Kr[n]?t[n]=e.restrictions[n]:Kr[n]&&(t[n]=[]);return t}},{key:"_parseDisallows",value:function(e){var t={},n=e.restrictions;for(var r in n)if(n.hasOwnProperty(r)&&Kr[r]){var i=n[r],s=!(!i||!i.length);t[r.replace(Yr,"$1")]=s}return t}},{key:"_onPlayerStateChanged",value:function(e){var t=this;this._isOrphanedState=e.data.orphaned,this._parsePlayerState(e.data.playerState).then((function(n){t._state=n,t._suppressed||t.emit("state_changed",{state:n?Object.assign({},n):null,orphaned:e.data.orphaned}),!t._disableProgress&&n&&(t._progressPosition=n.position,n.paused?t._stopProgressTracking():t._startProgressTracking())}))}},{key:"_parsePlayerState",value:function(e){var t=this;return this._lastPlayerState=e,e?this._getTrackWindow(e).then((function(n){var r,i,s,o,a,c,l,u;return{context:{uri:e.context_uri||null,metadata:e.context_metadata||{}},timestamp:e.timestamp,duration:e.duration||n.current_track&&"uri"in n.current_track&&n.current_track.duration_ms||0,position:e.is_paused?e.position_as_of_timestamp:t._offsetPosition(e.timestamp,e.position_as_of_timestamp,null===(r=t._lastPlayerState)||void 0===r?void 0:r.playback_speed),playback_quality:null!==(o=Gr[null!==(s=null===(i=e.playback_quality)||void 0===i?void 0:i.bitrate_level)&&void 0!==s?s:"unknown"])&&void 0!==o?o:qn.UNKNOWN,playback_features:{hifi_status:Wr[null!==(c=null===(a=e.playback_quality)||void 0===a?void 0:a.hifi_status)&&void 0!==c?c:"none"]},paused:!!e.is_paused,shuffle:!(!e.options||!e.options.shuffling_context),repeat_mode:t._getStateRepeatMode(e),restrictions:t._parseRestrictions(e),disallows:t._parseDisallows(e),track_window:n,bitrate:null,loading:null!==(u=null===(l=t._state)||void 0===l?void 0:l.loading)&&void 0!==u&&u}})):Promise.resolve(null)}},{key:"_offsetPosition",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,i=r||this._serverTime.getApproximate(),s=(i-e)*n,o=t+s;return o<0?0:o}},{key:"_isRestricted",value:function(e,t){if(!e||!e.restrictions)return!1;var n="disallow_".concat(t,"_reasons");return!!(e.restrictions[n]||[]).length}},{key:"_getTrackWindow",value:function(e){var t={current_track:null,next_tracks:[],previous_tracks:[]},n={},r=[];if(!e.track)return Promise.resolve(t);var i=e.track.uri;if(!i)return Promise.resolve(t);var s=this._metadataDecorator,o=yr.from(i),a=s.formatLocalTrack(o,e.track.uid),c=s.formatAd(o,e.track);return t.current_track=a||c||{uri:i,uid:e.track.uid,type:o&&o.type?o.type:"unknown"},a||c||(n[i]=1,r.push(i)),this._isRestricted(e,"peeking_next")||this._fillWindow(r,t.next_tracks,n,e.next_tracks?e.next_tracks.slice(0,5):[]),this._isRestricted(e,"peeking_prev")||this._fillWindow(r,t.previous_tracks,n,e.prev_tracks?e.prev_tracks.slice(-5):[],!0),this._decorate?this._metadataDecorator.decorateTrackWindow(t,r):Promise.resolve(t)}},{key:"_fillWindow",value:function(e,t,n,r,i){i&&r.reverse();for(var s=0,o=r.length;s<o;s++){var a=r[s].uri,c=yr.from(a);if(a&&"spotify:delimiter"!==a&&(!c||c.type!==yr.Type.AD&&c.type!==yr.Type.INTERRUPTION)){var l=this._metadataDecorator.formatLocalTrack(c,r[s].uid),u=l||{uri:a,uid:r[s].uid,type:"unknown"};if(l||a in n||(n[a]=1,e.push(a)),i?t.unshift(u):t.push(u),2===t.length)break}}}},{key:"_getStateRepeatMode",value:function(e){var t=e.options;return t&&t.repeating_track?se.TRACK:t&&t.repeating_context?se.CONTEXT:se.OFF}},{key:"_play",value:function(e,t,n){var r=this;return this._setFilterAndSort(e,n),this._setMetadataOptions(e,n),this._generatePlayOptions(n).then((function(i){var s={context:e,play_origin:r._generatePlayOrigin(n&&n.playOrigin),options:i};return(null==n?void 0:n.loggingParams)&&(s.logging_params=r._generateLoggingParams(n.loggingParams)),r._playerClient.play(s,t)}))}},{key:"getActiveDevice",value:function(){return this._playerClient.getActiveDevice()}},{key:"getCurrentState",value:function(e){var t;if(e&&this._isOrphanedState)return Promise.resolve(null);var n=this._state;if(n&&!n.paused){var r=this._serverTime.getApproximate();n.position=this._offsetPosition(n.timestamp,n.position,null===(t=this._lastPlayerState)||void 0===t?void 0:t.playback_speed,r),n.timestamp=r}return Promise.resolve(n?Object.assign({},n):null)}},{key:"getContextPlayerState",value:function(){return jr.warn("The `getContextPlayerState()` method is not well supported. Please avoid using it directly."),this._playerClient.getContextPlayerState()}},{key:"getDevices",value:function(){return this._playerClient.getDevices()}},{key:"playURI",value:function(e,t,n){if(!yr.from(e))return Promise.reject(new TypeError("Invalid Spotify URI"));var r={uri:e,url:"context://".concat(e),metadata:n&&n.contextMetadata||{}};return this._play(r,t,n)}},{key:"playPages",value:function(e,t,n){var r,i;if(!Array.isArray(e))return Promise.reject(new TypeError("Invalid pages array."));try{i=function(e){var t,n,r,i,s=[],o=xr(e);try{for(o.s();!(i=o.n()).done;){var a=i.value;s.push({tracks:Array.isArray(a.tracks)?qr(a.tracks):void 0,page_url:null!==(t=zr(a.pageURL))&&void 0!==t?t:void 0,next_page_url:null!==(n=zr(a.nextPageURL))&&void 0!==n?n:void 0,metadata:null!==(r=a.metadata)&&void 0!==r?r:void 0})}}catch(c){o.e(c)}finally{o.f()}return s}(e)}catch(o){return Promise.reject(o)}var s={uri:null!==(r=null==n?void 0:n.contextURI)&&void 0!==r?r:"spotify:internal:harmony-play-pages",metadata:(null==n?void 0:n.contextMetadata)||{},pages:i};return this._play(s,t,n)}},{key:"playTracks",value:function(e,t,n){var r,i;if(!Array.isArray(e))return Promise.reject(new TypeError("Invalid tracks array."));try{i=qr(e)}catch(o){return Promise.reject(o)}var s={uri:null!==(r=null==n?void 0:n.contextURI)&&void 0!==r?r:"spotify:internal:harmony-play-tracks",metadata:(null==n?void 0:n.contextMetadata)||{},pages:[{tracks:i}]};return this._play(s,t,n)}},{key:"updateCurrentContext",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._playerClient.updateCurrentContext(e,t)}},{key:"setQueue",value:function(e,t,n){if(!Array.isArray(e))return Promise.reject(new TypeError("Invalid nextTracks array."));if(!Array.isArray(t))return Promise.reject(new TypeError("Invalid previousTracks array."));var r,i;try{r=qr(e),i=qr(t)}catch(o){return Promise.reject(o)}var s={next_tracks:r.length?r:void 0,prev_tracks:i.length?i:void 0};return this._playerClient.setQueue(s,n)}},{key:"togglePlay",value:function(e){return this._playerClient.togglePlay(e)}},{key:"transfer",value:function(e,t){var n=this;return this._generatePlayOptions(t,!0).then((function(t){return n._playerClient.transfer(e,t)}))}},{key:"pause",value:function(e){return this._playerClient.pause(e)}},{key:"resume",value:function(e){return this._playerClient.resume(e)}},{key:"nextTrack",value:function(e,t){var n={};return(null==t?void 0:t.track)&&(n.track=Te([t.track])[0]),this._playerClient.nextTrack(e,n)}},{key:"previousTrack",value:function(e,t){var n={};return(null==t?void 0:t.track)&&(n.track=Te([t.track])[0]),this._playerClient.previousTrack(e,n)}},{key:"seek",value:function(e,t){return this._playerClient.seek(e,t)}},{key:"setShuffle",value:function(e,t){return this._playerClient.setShuffle(e,t)}},{key:"toggleShuffle",value:function(e){return this._playerClient.toggleShuffle(e)}},{key:"setVolume",value:function(e,t){return this._playerClient.setVolume(e,t)}},{key:"logout",value:function(e){return this._playerClient.logout(e)}},{key:"setRepeatMode",value:function(e,t){var n=this;return this.getCurrentState().then((function(r){if(!r)return Promise.reject(new Dr(Q.CONNECTAPI_CLIENT_NO_STATE,"Nothing playing"));var i=n._playerClient,s=r.disallows;switch(e){case se.OFF:return(!s.toggling_repeat_context||!s.toggling_repeat_track)&&i.setOptions({repeating_context:!!s.toggling_repeat_context&&void 0,repeating_track:!!s.toggling_repeat_track&&void 0},t);case se.CONTEXT:return!s.toggling_repeat_context&&i.setOptions({repeating_context:!0,repeating_track:!!s.toggling_repeat_track&&void 0},t);case se.TRACK:return!s.toggling_repeat_track&&i.setOptions({repeating_context:!s.toggling_repeat_context||void 0,repeating_track:!0},t);default:return Promise.reject(new TypeError("Unknown repeat mode."))}}))}},{key:"register",value:function(){return this._playerClient.register()}},{key:"suppressEvents",value:function(){this._suppressed=!0}},{key:"unsuppressEvents",value:function(){this._suppressed=!1,this._lastDeviceInfoData&&this.emit("device_info_changed",this._lastDeviceInfoData),this._state&&this.emit("state_changed",{state:this._state})}},{key:"getQueueManager",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._queue){var n=t.reportInitial?this._lastPlayerState:null;this._queue=new Ie(Object.assign({connectClient:this._playerClient,initialContextPlayerState:n,runner:e},t))}return this._queue}}],[{key:"create",value:function(e){return new n(e)}}]),n}(ne.vp),Qr=n(9202);function Xr(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Jr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Jr(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){a=!0,s=e},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw s}}}}function Jr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Zr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var ei=/connect-state\/v1\/cluster$/,ti=/^([a-zA-Z0-9_%:-]{1,40}).*$/;function ni(e){var t,n,r;return!!e.track&&0===(null!==(r=null===(n=null===(t=e.restrictions)||void 0===t?void 0:t.disallow_transferring_playback_reasons)||void 0===n?void 0:n.length)&&void 0!==r?r:0)}var ri="::a_";function ii(e){if(!e)return{deviceId:null};var t=e.split(ri),n=te()(t,2),r=n[0],i=n[1];return{deviceId:r,aliasId:i?parseInt(i,10):void 0}}var si=function(e){v()(n,e);var t=Zr(n);function n(e){var r;return h()(this,n),(r=t.call(this))._autoregister=!0,r._connectionId="",r._localDeviceId="",r._localObserverDeviceId=null,r._lastActiveDevice=null,r._lastKnownPlayerState=null,r._lastKnownDevices=[],r._localDevice=null,r._fetchedInitialState=!1,r._awaitingAcknowledgment={},r._acknowledgementMaps=[],r._lastProcessedTimestamp=0,r._descriptor=e.descriptor,r._transport=e.transport,r._endpoint=e.endpoint||"@webgate/connect-state",r._autoregister=!("autoregister"in e)||!!e.autoregister,r._onConnectionId=r._onConnectionId.bind(m()(r)),r._onClusterMessage=r._onClusterMessage.bind(m()(r)),r._awaitResponseWithAck=r._awaitResponseWithAck.bind(m()(r)),r._transport.on(r._transport.EVENT_CONNECTION_ID,(function(e){r._onConnectionId(e.data.id)})),r._transport.matchMessages(ei,r._onClusterMessage),r._descriptorPromise=Promise.resolve(r._descriptor).then((function(e){return r._localDeviceId=e.id||"",r._localObserverDeviceId=("hobs_"+r._localDeviceId).replace(ti,"$1"),!0})),r}return f()(n,[{key:"_onConnectionId",value:function(e){this._connectionId=e,this._autoregister&&this.register()}},{key:"_onClusterMessage",value:function(e){var t=e.payloads&&e.payloads[0];if(t){if(t.ack_id){var n=t.ack_id,r=this._awaitingAcknowledgment[n];if(r)r.resolve(!0);else for(var i=this._acknowledgementMaps,s=0,o=i.length;s<o;s++)i[s][n]=pe()}this._parseCluster(t.cluster)}}},{key:"_resolveTargetDevice",value:function(e){var t=this;return this._descriptorPromise.then((function(){var n=t._localDeviceId;return ii(e?e===oe?n:e:t._lastActiveDevice?t._lastActiveDevice.id:n)}))}},{key:"_makeEndpoint",value:function(e,t,n){var r=this;return this._descriptorPromise.then((function(){var i=r._localDeviceId;return"".concat(r._endpoint,"/").concat(e,"/").concat(t,"/from/").concat(i,"/to/").concat(n)}))}},{key:"_sendPlayerCommand",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r.endpoint=e;var i={command:r};return this._resolveTargetDevice(n).then((function(e){if(!e.deviceId)throw new Dr(Q.CONNECTAPI_CLIENT_MISSING_DEVICE_ID,"Operation resulted in a null device id");return!i.target_alias_id&&e.aliasId&&(i.target_alias_id=e.aliasId),t._makeEndpoint("v1","player/command",e.deviceId)})).then((function(e){return t._sendRequest(Qr.n.POST,e,i)})).then(this._awaitResponseWithAck)}},{key:"_sendConnectCommand",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i="volume"===e?Qr.n.PUT:Qr.n.POST,s="volume"===e||"logout"===e;return this._resolveTargetDevice(n).then((function(n){if(!n.deviceId)throw new Dr(Q.CONNECTAPI_CLIENT_MISSING_DEVICE_ID,"Operation resulted in a null device id");return n.aliasId&&(s?r.command_options={target_alias_id:n.aliasId}:r.target_alias_id||(r.target_alias_id=n.aliasId)),t._makeEndpoint("v1","connect/".concat(e),n.deviceId)})).then((function(e){return t._sendRequest(i,e,r)})).then(this._awaitResponseWithAck)}},{key:"_sendRequest",value:function(e,t,n){var r=this._acknowledgementMaps,i={};r.push(i);var s=function(){var e=r.indexOf(i);-1!==e&&r.splice(e,1)};return this._transport.request(t,{method:e,payload:n?JSON.stringify(n):void 0,responseType:"json",retry:{condition:function(e,t){var n=e.getStatusFamily();return n===t.SERVER_ERROR||n===t.CONNECTION_ERROR}}}).then((function(e){return s(),{response:e,map:i}}),(function(e){return s(),Promise.reject(e)}))}},{key:"_awaitResponseWithAck",value:function(e){if(404===e.response.status)return Promise.reject(new Dr(Q.CONNECTAPI_CLIENT_NO_DEVICE,"No such device."));var t=e.response.body&&e.response.body.ack_id;if(200===e.response.status&&t){if(e.map&&e.map[t])return Promise.resolve(!0);var n=pe();return this._awaitingAcknowledgment[t]=n,n.promise}return Promise.resolve(202===e.response.status&&!t)}},{key:"_parseCluster",value:function(e){if(e){var t=parseInt(e.timestamp,10);this._lastProcessedTimestamp>t||(this._lastProcessedTimestamp=t,this._parseClusterDevices(e),this._parseClusterPlayerState(e))}}},{key:"_parseClusterDevices",value:function(e){var t=this._lastActiveDevice;this._lastActiveDevice=null,this._lastKnownDevices=[],this._localDevice=null;var n=[];for(var r in e.devices)e.devices.hasOwnProperty(r)&&n.push(r);if(n.sort(),n.length)for(var i=e.active_device_id,s=0,o=n.length;s<o;s++){var a,c=e.devices[n[s]],l=this._formatClusterDevice(c,i);(a=this._lastKnownDevices).push.apply(a,fe()(l));var u,d=Xr(l);try{for(d.s();!(u=d.n()).done;){var p=u.value;p.is_active&&(this._lastActiveDevice=p),p.local&&(this._localDevice=p)}}catch(f){d.e(f)}finally{d.f()}}if(!this._fetchedInitialState||!he(this._lastActiveDevice,t)){var h=e.player_state,_=h&&ni(h);this.emit("device_state_changed",{deviceState:this._lastActiveDevice,hasOrphanedState:!this._lastActiveDevice&&!!_,disappeared:!!t&&!this._lastActiveDevice})}this.emit("devices_changed",{devices:this._lastKnownDevices,localDevice:this._localDevice})}},{key:"_formatClusterDevice",value:function(e,t){var n={};if(e&&Array.isArray(e.metadata))for(var r=0,i=e.metadata.length;r<i;r++){var s=e.metadata[r];n[s.type]=s.metadata}var o=e.capabilities||{},a={};"supports_hifi"in o&&(a.hifi_status=o.supports_hifi);var c={hidden:!1,id:e.device_id,is_active:e.device_id===t,is_controllable:!!o.is_controllable,is_observable:!!o.is_observable,local:e.device_id===this._localDeviceId,metadata:n,name:e.name,type:(e.device_type||Ke.UNKNOWN).toLowerCase(),version:e.device_software_version,volume:o.disable_volume?-1:e.volume/ae,capabilities:{supports_lossless_audio:!!o.supports_lossless_audio},is_alias:!1,is_alias_group:!1,playback_features:a};if(!e.device_aliases)return[c];var l=[];for(var u in e.device_aliases)if(e.device_aliases.hasOwnProperty(u)){var d=e.device_aliases[u],p=Object.assign(Object.assign({},c),{id:"".concat(c.id).concat(ri).concat(d.id),name:d.display_name,is_alias:!0,is_alias_group:!!d.is_group,is_active:c.is_active&&e.selected_alias_id===d.id});l.push(p)}return l}},{key:"_parseClusterPlayerState",value:function(e){this._lastKnownPlayerState=null;var t=e.active_device_id,n=t&&e.devices[t],r=e.player_state;r&&r.track&&(n&&n.capabilities&&!n.capabilities.is_observable?r=null:(n||(r.is_paused=!0,r.restrictions&&(delete r.restrictions.disallow_resuming_reasons,r.restrictions.disallow_pausing_reasons=["already_paused"])),r.duration=parseInt(r.duration,10),r.position=parseInt(r.position,10),r.position_as_of_timestamp=parseInt(r.position_as_of_timestamp,10),r.timestamp=parseInt(r.timestamp,10),r.next_tracks=r.next_tracks||[],r.prev_tracks=r.prev_tracks||[]),this._lastKnownPlayerState=r);var i=!n&&!!this._lastKnownPlayerState;i&&r&&!ni(r)&&(this._lastKnownPlayerState=null,i=!1),this.emit("player_state_changed",{playerState:this._lastKnownPlayerState,orphaned:i,isLocal:!!t&&t===this._localDeviceId})}},{key:"_register",value:function(){var e=this;this._fetchedInitialState=!1;var t="".concat(this._endpoint,"/v1/devices/").concat(this._localObserverDeviceId);return this._connectionId||Promise.reject(new Dr(Q.CONNECTAPI_CLIENT_NO_CONNECTION_ID,"Cannot register: no connection id.")),this._transport.request(t,{method:"PUT",headers:{"X-Spotify-Connection-Id":this._connectionId,Accept:"application/json"},payload:JSON.stringify({member_type:"CONNECT_STATE",device:{device_info:{capabilities:{can_be_player:!1,hidden:!0,needs_full_player_state:!0}}}}),responseType:"json"}).then((function(t){429===t.status?e.emit("max_subscriptions_reached",{error:new Dr(Q.CONNECTAPI_MAX_SUBSCRIPTIONS_REACHED,"Max connections reached")}):200===t.status&&(e.emit("registered",null),t.body&&(e._parseCluster(t.body),e._fetchedInitialState=!0))}))}},{key:"register",value:function(){return this._connectionId?this._descriptorPromise.then(this._register.bind(this)):Promise.reject(new Dr(Q.CONNECTAPI_CLIENT_NO_CONNECTION_ID,"Cannot register: no connection id."))}},{key:"deregister",value:function(){var e=this,t="".concat(this._endpoint,"/v1/devices/").concat(this._localObserverDeviceId);return this._transport.request(t,{method:"DELETE",responseType:"json"}).then((function(t){200===t.status&&e.emit("deregistered",null)}))}},{key:"getDevices",value:function(){var e=this;return this._fetchedInitialState?Promise.resolve({devices:this._lastKnownDevices,localDevice:this._localDevice}):new Promise((function(t){e.once("device_state_changed",(function(){t({devices:e._lastKnownDevices,localDevice:e._localDevice})}))}))}},{key:"getActiveDevice",value:function(){var e=this;return this._fetchedInitialState?Promise.resolve(this._lastActiveDevice):new Promise((function(t){e.once("device_state_changed",(function(e){t(e.data.deviceState)}))}))}},{key:"getContextPlayerState",value:function(){var e=this;return this._fetchedInitialState?Promise.resolve(this._lastKnownPlayerState):new Promise((function(t){e.once("player_state_changed",(function(e){t(e.data.playerState)}))}))}},{key:"play",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e?this._sendPlayerCommand("play",t,e):Promise.reject(new Dr(Q.CONNECTAPI_CLIENT_INVALID_ARGUMENTS,"Descriptor is required for play commands"))}},{key:"updateCurrentContext",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.getContextPlayerState().then((function(r){return r?r.session_id?r.context_url||n.forceNonUpdateable?e._sendPlayerCommand("update_context",t,{context:{url:r.context_url||"context://".concat(r.context_uri)},session_id:r.session_id}):Promise.resolve(!1):Promise.reject(new Dr(Q.CONNECTAPI_CLIENT_NO_SESSION_ID,"The current state does not have a session id")):Promise.reject(new Dr(Q.CONNECTAPI_CLIENT_NO_STATE,"Nothing playing"))}))}},{key:"setQueue",value:function(e,t){return this._sendPlayerCommand("set_queue",t,e)}},{key:"addToQueue",value:function(e,t){return this._sendPlayerCommand("add_to_queue",t,{track:e})}},{key:"togglePlay",value:function(e){var t=this;return this.getContextPlayerState().then((function(n){return n?n.is_paused?t.resume(e):t.pause(e):Promise.reject(new Dr(Q.CONNECTAPI_CLIENT_NO_STATE,"Nothing playing"))}))}},{key:"transfer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={transfer_options:{restore_paused:"restore"}};return t&&"initially_paused"in t&&(n.transfer_options.restore_paused=t.initially_paused?"pause":"resume"),this._sendConnectCommand("transfer",e||oe,n)}},{key:"pause",value:function(e){return this._sendPlayerCommand("pause",e)}},{key:"resume",value:function(e){return this._sendPlayerCommand("resume",e)}},{key:"nextTrack",value:function(e,t){return this._sendPlayerCommand("skip_next",e,t)}},{key:"previousTrack",value:function(e,t){return this._sendPlayerCommand("skip_prev",e,t)}},{key:"seek",value:function(e,t){return isNaN(e)||e<0?Promise.reject(new Dr(Q.CONNECTAPI_CLIENT_INVALID_POSITION,"Invalid position.")):this._sendPlayerCommand("seek_to",t,{value:e})}},{key:"setShuffle",value:function(e,t){return this._sendPlayerCommand("set_shuffling_context",t,{value:!!e})}},{key:"toggleShuffle",value:function(e){var t=this;return this.getContextPlayerState().then((function(n){if(!n)return Promise.reject(new Dr(Q.CONNECTAPI_CLIENT_NO_STATE,"Nothing playing"));var r=n.options&&n.options.shuffling_context;return t.setShuffle(!r,e)}))}},{key:"setRepeatingContext",value:function(e,t){return this._sendPlayerCommand("set_repeating_context",t,{value:e})}},{key:"setRepeatingTrack",value:function(e,t){return this._sendPlayerCommand("set_repeating_track",t,{value:!!e})}},{key:"setOptions",value:function(e,t){return this._sendPlayerCommand("set_options",t,Object.assign({},e))}},{key:"setVolume",value:function(e,t){if(isNaN(e)||e<0)return Promise.reject(new Dr(Q.CONNECTAPI_CLIENT_INVALID_VOLUME,"Invalid volume."));var n=Math.round(e*ae);return this._sendConnectCommand("volume",t,{volume:n})}},{key:"logout",value:function(e){return this._sendConnectCommand("logout",e)}}],[{key:"create",value:function(e){return new n(e)}}]),n}(ne.vp);var oi=Object.assign(Object.assign(Object.assign({},Q),X.J),H);function ai(e){var t,n=e.transport;if(!n)throw new TypeError("No Transport instance provided");var r=function(e){return st.create(e)}(Object.assign(Object.assign({},e.client),{transport:n,hidden:!!e.hidden,playTokenLostBehavior:e.hidden&&!e.onlyLocalState?"stop":"pause"})),i=e.streamer||{},s=e.controller||{},o=void 0,a=!1;e.streamer&&e.streamer.disabled?(e.hidden=!0,e.onlyLocalState=!1,e.claimInactivePlayerStates=!1,a=!0):(o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.getSDKId(),r=e.getPublicTransport(),i=e.getLogger(),s=e.getDeviceDescriptor(),o="initialVolume"in t&&void 0!==t.initialVolume?t.initialVolume:1,a=Zn(Object.assign(Object.assign({},t),{transport:r,sdkId:e.getUntaggedSDKId(),loggerOptions:{platform:e.getPlatformIdentifier(),clientVersion:e.getPlatformVersion()}})).then((function(e){return e.player})),c=a.then((function(e){return e.getMediaConfig()})),l=Promise.all([s,c]).then((function(e){var n=te()(e,2),r=n[0],i=n[1];return r.getCapability("audio_podcasts")&&!t.disableExternalFiles&&r.appendManifestFormat(Ye.FILE_URLS_EXTERNAL),i.keysystem===vt.FAIRPLAY?r.appendManifestFormat(Ye.FILE_IDS_CBCS):i.keysystem!==vt.WIDEVINE||t.preferMultiDRMFormat?r.appendManifestFormat(Ye.FILE_IDS_MP4_DUAL,Ye.FILE_IDS_MP4):(-1!==i.formats.audio.indexOf('audio/mp4; codecs="flac"')&&r.getCapability("lossless_playback")&&r.appendManifestFormat(Ye.FILE_IDS_MP4FLAC),r.appendManifestFormat(Ye.FILE_IDS_MP4,Ye.FILE_IDS_MP4_DUAL)),i.supports.protected_video&&r.getCapability("video_playback")&&r.prependManifestFormat(Ye.MANIFEST_IDS_VIDEO),r})),u=Jn.create({trackPlayer:a}),d=Or.create({descriptor:s,listPlayer:u}),p=hr.create({initialVolume:o,listPlayer:u,logger:i,transport:r,clientVersion:n,descriptor:l,endpoint:t.endpoint,ListClass:mr,manifestTrackResolver:d}),h=Tr.create(p),_="stopOnBackground"in t?t.stopOnBackground:"undefined"==typeof MediaSource;return new gr({client:e,playbackServiceClient:p,playbackStateObserver:h,initialVolume:o,playerPromise:a,listPlayer:u,stopOnBackground:_})}(r,i),s.autoregister=!1,e.onlyLocalState&&(s.decorateTrackWindow=!1,s.disableProgress=!0));var c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.getPublicTransport(),r=e.getVersionDescriptor().tagged,i=si.create({autoregister:!("autoregister"in t)||t.autoregister,descriptor:e.getClientDescriptor(),transport:n});return $r.create({client:e,playerClient:i,version:r,serverTime:Lr.X.create(n),decorateTrackWindow:"boolean"!=typeof t.decorateTrackWindow||t.decorateTrackWindow,disableProgress:t.disableProgress})}(r,s);return Oe.create({transport:n,client:r,streamer:o,controller:c,enableControllerWithoutStreamer:a,hidden:e.hidden,onlyLocalState:e.onlyLocalState,claimInactivePlayerStates:e.claimInactivePlayerStates,autoActivateElement:null!==(t=e.autoActivateElement)&&void 0!==t?t:"undefined"!=typeof WebKitMediaKeys,experimentalDeactivateOnStop:e.experimentalDeactivateOnStop})}var ci=null;function li(){if(null===ci)throw new Error("Missing `instance`. Have you called `setTransportInstance` yet?");return ci}n(5623),n(1514);var ui,di,pi=n(3630),hi=n.n(pi);!function(e){e.Web="Web",e.PWA="PWA",e.Desktop="Desktop"}(ui||(ui={})),function(e){e.macOS="macOS",e.Windows="Windows",e.Linux="Linux",e.ChromeOS="ChromeOS",e.Other="Other"}(di||(di={}));n(2759),n(895),n(1755),n(1918);var _i=n(1873),fi=n.n(_i);n(7276),n(1203);function gi(e){var t=hi().getParser(window.navigator.userAgent),n=function(e){switch(e){case"macOS":return"osx";case"Chrome OS":return"chrome";default:return e}}(t.getOSName()||"not_applicable"),r=function(e,t){if("Windows"===e)switch(t){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return""}return t}(n,t.getOSVersion()),i=t.getBrowserName(),s=t.getBrowserVersion();return"web_player ".concat(n," ").concat(r,";").concat(i," ").concat(s,";").concat(e).toLowerCase()}function mi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mi(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var vi,Ei="@local",Si=function(){function e(t,n){h()(this,e),i()(this,"player",null),i()(this,"transport",null),i()(this,"playbackState",null),i()(this,"onConnectCallbacks",[]),i()(this,"onTrackChangeCallbacks",[]),i()(this,"onProgressCallbacks",[]),i()(this,"onVolumeChangeCallbacks",[]),i()(this,"onActiveStateChangeCallbacks",[]),i()(this,"onInitializationFailureCallbacks",[]),i()(this,"onResetCallbacks",[]),i()(this,"onPauseCallbacks",[]),i()(this,"onPlayCallbacks",[]),this.resource=n,this.session=t}return f()(e,[{key:"initialize",value:function(){var e=this,t=gi("embed");this.transport=li(),this.player=ai({transport:this.transport,client:{descriptor:{id:null,randomizeId:!0,name:"SPB",brand:"spotify",model:w,platform_identifier:t}},streamer:{disallowRobustnessValues:[$n.EMPTY]},hidden:!0,onlyLocalState:!0}),this.player.on(re.STATE_CHANGED,(function(t){var n=t.data.state;e.playbackState&&!n?e.onResetCallbacks.forEach((function(e){return e()})):n&&(e.playbackState&&n.track_window.current_track.uri===e.playbackState.track_window.current_track.uri||e.onTrackChangeCallbacks.forEach((function(e){return e(n.track_window.current_track)})),e.playbackState&&n.paused===e.playbackState.paused||(n.paused?e.onPauseCallbacks.forEach((function(e){return e()})):e.onPlayCallbacks.forEach((function(e){return e()})))),e.playbackState=n})),this.player.on(re.LAST_ACTIVE_DEVICE_INFO_CHANGED,(function(t){var n=t.data.deviceInfo;n&&(e.onVolumeChangeCallbacks.forEach((function(e){return e(n.volume)})),e.onActiveStateChangeCallbacks.forEach((function(e){return e(n.is_active)})))})),this.player.on(re.PROGRESS,(function(t){var n=t.data;e.onProgressCallbacks.forEach((function(e){return e(n)}))})),this.player.on(re.PLAYER_INITIALIZATION_FAILED,(function(t){var n=t.data;e.onInitializationFailureCallbacks.forEach((function(e){return e(n)})),e.onInitializationFailureCallbacks=[]})),this.player.on(re.LOCAL_PLAYER_ENABLED,(function(){e.onConnectCallbacks.forEach((function(e){return e()})),e.onConnectCallbacks=[]}))}},{key:"executeOrQueue",value:function(e){null===this.player?(this.onConnectCallbacks.push(e),this.initialize()):e()}},{key:"play",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.executeOrQueue((function(){e?t.player.playURI(e.uri,Ei,yi(yi({},n),{},{autoplayCandidate:!1})):t.resume()}))}},{key:"pause",value:function(){var e=this;this.executeOrQueue((function(){e.player.pause(Ei)}))}},{key:"resume",value:function(){var e=this;this.executeOrQueue((function(){e.player.resume(Ei)}))}},{key:"next",value:function(){var e=this;this.executeOrQueue((function(){e.player.nextTrack(Ei)}))}},{key:"prev",value:function(){var e=this;this.executeOrQueue((function(){e.player.previousTrack(Ei)}))}},{key:"seek",value:function(e){var t=this;this.executeOrQueue((function(){t.player.seek(e,Ei)}))}},{key:"seekForward",value:function(e){var t=this;this.executeOrQueue((function(){t.player.seekForward(e,Ei)}))}},{key:"seekBackward",value:function(e){var t=this;this.executeOrQueue((function(){t.player.seekBackward(e,Ei)}))}},{key:"setVolume",value:function(e){var t=this;this.executeOrQueue((function(){t.player.setVolume(e,Ei)}))}},{key:"onProgress",value:function(e){var t=this;return this.onProgressCallbacks.push(e),{unsubscribe:function(){var n=t.onProgressCallbacks.indexOf(e);t.onProgressCallbacks.splice(n,1)}}}},{key:"onReset",value:function(e){var t=this;return this.onResetCallbacks.push(e),{unsubscribe:function(){var n=t.onResetCallbacks.indexOf(e);t.onResetCallbacks.splice(n,1)}}}},{key:"onPause",value:function(e){var t=this;return this.onPauseCallbacks.push(e),{unsubscribe:function(){var n=t.onPauseCallbacks.indexOf(e);t.onPauseCallbacks.splice(n,1)}}}},{key:"onPlay",value:function(e){var t=this;return this.onPlayCallbacks.push(e),{unsubscribe:function(){var n=t.onPlayCallbacks.indexOf(e);t.onPlayCallbacks.splice(n,1)}}}},{key:"onTrackChange",value:function(e){var t=this;return this.onTrackChangeCallbacks.push(e),{unsubscribe:function(){var n=t.onTrackChangeCallbacks.indexOf(e);t.onTrackChangeCallbacks.splice(n,1)}}}},{key:"onVolumeChange",value:function(e){var t=this;return this.onVolumeChangeCallbacks.push(e),{unsubscribe:function(){var n=t.onVolumeChangeCallbacks.indexOf(e);t.onVolumeChangeCallbacks.splice(n,1)}}}},{key:"onActiveStateChange",value:function(e){var t=this;return this.onActiveStateChangeCallbacks.push(e),{unsubscribe:function(){var n=t.onActiveStateChangeCallbacks.indexOf(e);t.onActiveStateChangeCallbacks.splice(n,1)}}}},{key:"onInitializationFailure",value:function(e){var t=this;return this.onInitializationFailureCallbacks.push(e),{unsubscribe:function(){var n=t.onInitializationFailureCallbacks.indexOf(e);t.onInitializationFailureCallbacks.splice(n,1)}}}},{key:"onUnavailableTrack",value:function(){}}]),e}(),bi={},Ti=(n(5699),function(){function e(){var t=this;h()(this,e),i()(this,"onTrackChangeCallbacks",[]),i()(this,"onVolumeChangeCallbacks",[]),i()(this,"onUnavailableTrackCallbacks",[]),i()(this,"onPauseCallbacks",[]),i()(this,"onPlayCallbacks",[]),this.player=new Audio,this.player.addEventListener("ended",(function(){t.next()})),this.player.addEventListener("playing",(function(){t.onPlayCallbacks.forEach((function(e){return e()}))})),this.player.addEventListener("pause",(function(){t.onPauseCallbacks.forEach((function(e){return e()}))}))}return f()(e,[{key:"initialize",value:function(){}},{key:"_playIndex",value:function(e){var t=this;this.currentTrack=this.trackList[e],this.onTrackChangeCallbacks.forEach((function(e){return e(t.currentTrack)})),this.currentTrack&&this.currentTrack.is_playable&&this.currentTrack.preview_url?(this.player.src=this.currentTrack.preview_url,this.resume()):this.onUnavailableTrackCallbacks.forEach((function(e){return e(t.currentTrack)}))}},{key:"play",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e){var n=Math.max(e._trackList.findIndex((function(e){return e.is_playable})),0),r=t.index||n;this.context=e,this.trackList=e._trackList,this._playIndex(r)}else this.player.src&&this.resume()}},{key:"pause",value:function(){this.player.pause()}},{key:"resume",value:function(){var e=this.player.play();void 0!==e&&e.catch((function(){}))}},{key:"next",value:function(){if(this.trackList){var e=this.trackList.indexOf(this.currentTrack),t=e<this.trackList.length-1?e+1:0;this._playIndex(t)}}},{key:"prev",value:function(){if(this.trackList){var e=this.trackList.indexOf(this.currentTrack);this._playIndex(e-1)}}},{key:"seek",value:function(e){this.player.currentTime=e/1e3}},{key:"seekForward",value:function(e){this.seek(1e3*this.player.currentTime+e)}},{key:"seekBackward",value:function(e){this.seek(1e3*this.player.currentTime-e)}},{key:"setVolume",value:function(e){this.player.volume=e,this.onVolumeChangeCallbacks.forEach((function(t){return t(e)}))}},{key:"onProgress",value:function(e){var t=this,n=function(){return e({position:1e3*t.player.currentTime})};return this.player.addEventListener("timeupdate",n),{unsubscribe:function(){t.player.removeEventListener("timeupdate",n)}}}},{key:"onTrackChange",value:function(e){var t=this;return this.onTrackChangeCallbacks.push(e),{unsubscribe:function(){var n=t.onTrackChangeCallbacks.indexOf(e);t.onTrackChangeCallbacks.splice(n,1)}}}},{key:"onVolumeChange",value:function(e){var t=this;return this.onVolumeChangeCallbacks.push(e),{unsubscribe:function(){var n=t.onVolumeChangeCallbacks.indexOf(e);t.onVolumeChangeCallbacks.splice(n,1)}}}},{key:"onUnavailableTrack",value:function(e){var t=this;return this.onUnavailableTrackCallbacks.push(e),{unsubscribe:function(){var n=t.onUnavailableTrackCallbacks.indexOf(e);t.onUnavailableTrackCallbacks.splice(n,1)}}}},{key:"onReset",value:function(){}},{key:"onPause",value:function(e){var t=this;return this.onPauseCallbacks.push(e),{unsubscribe:function(){var n=t.onPauseCallbacks.indexOf(e);t.onPauseCallbacks.splice(n,1)}}}},{key:"onPlay",value:function(e){var t=this;return this.onPlayCallbacks.push(e),{unsubscribe:function(){var n=t.onPlayCallbacks.indexOf(e);t.onPlayCallbacks.splice(n,1)}}}},{key:"onInitializationFailure",value:function(){}},{key:"onActiveStateChange",value:function(e){e(!0)}}]),e}());function Ci(e,t){try{var n=document.getElementById(e);return n?JSON.parse(n.innerHTML):t}catch(r){return t}}var Ii=function(e){return Ci("config",{})[e]},Ri=function(e){return e.playback.isPlaying},Pi=function(e){return e.playback.isPaused},Ai=function(e){return D(e,e.playback.trackUri)},Oi=function(e){var t=e.platform,n=void 0===t?{}:t,r=e.session,i=void 0===r?{}:r;return n.forcePreview||n.isMobile||n.isSafari||i.premiumOnlyMarket||!i.loggedIn||!i.accessToken},ki=function(e){var t=Ai(e);if(t)return Oi(e)?Math.min(t.duration_ms,3e4):t.duration_ms},Li=function(e){return Oi(e)?vi||(vi=new Ti):(t=e.session,n=e.resource,bi[n]&&t.accessToken===bi[n].session.accessToken||(bi[n]=new Si(t,n)),bi[n]);var t,n},wi=function(e){var t=Ai(e);return!(!t||"episode"!==t.type)&&-1!==(t.available_markets||F(e).available_markets||t.show.available_markets||[]).indexOf(Ii("countryCode"))};function Di(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ni(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Di(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Di(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ui="PROMPT",Mi="UNAVAILABLE_TRACK",Bi={visible:!1,type:null},xi=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Bi,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ji.SHOW_PROMPT:return Ni(Ni({},e),{},{visible:!0,type:Ui});case zi.UNAVAILABLE_TRACK:return Ni(Ni({},e),{},{visible:!0,type:Mi});case ji.HIDE_MODAL:return Ni(Ni({},e),{},{visible:!1,type:null});default:return e}},Fi={SHOW_PROMPT:"SHOW_PROMPT",HIDE_MODAL:"HIDE_MODAL",CLICK_LOGIN:"CLICK_LOGIN",CLICK_SIGNUP:"CLICK_SIGNUP",GET_SPOTIFY_APP:"GET_SPOTIFY_APP"},ji=Fi,Yi=function(e){return function(t,n){var r=n(),i=r.modal,s=i.type,o=i.visible;s===Mi&&o||Oi(r)&&setTimeout((function(){return t({type:Fi.SHOW_PROMPT})}),e||0)}};function Ki(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Hi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ki(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ki(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Vi,Gi,Wi,qi={RESET:"RESET",PLAY:"PLAY",PAUSE:"PAUSE",SKIP_NEXT:"SKIP_NEXT",SKIP_PREV:"SKIP_PREV",TRACK_CHANGE:"TRACK_CHANGE",PROGRESS_UPDATE:"PROGRESS_UPDATE",PLAY_IN_APP:"PLAY_IN_APP",GET_IN_APP:"GET_IN_APP",UNAVAILABLE_TRACK:"UNAVAILABLE_TRACK"},zi=qi,$i=function(){return{type:qi.PLAY}},Qi=function(){return{type:qi.PAUSE}},Xi=function(){return function(e,t){var n=t(),r=Li(n);e({type:qi.SKIP_NEXT}),e($i()),r.next(),e(Yi())}},Ji=function(){return function(e,t){var n=t(),r=Li(n);e({type:qi.SKIP_PREV}),e($i()),r.prev(),e(Yi())}},Zi=function(e){return{type:qi.TRACK_CHANGE,uri:e}},es=function(){return function(e,t){e(Qi()),Li(t()).pause()}},ts=function(e){return function(t,n){var r=n(),i=void 0!==e;if(i||!Ri(r)){var s=Li(r);if(!i&&Pi(r))s.resume();else{var o=i?{index:e}:{};s.play(Hi(Hi({},F(r)),{},{_trackList:Y(r)}),o),t(Yi(3e3))}}}},ns=n(1315);function rs(e){return"string"!=typeof e}!function(e){e.af="af",e.am="am",e.ar="ar",e.az="az",e.bg="bz",e.bn="bn",e.bho="bho",e.cs="cs",e.da="da",e.de="de",e.el="el",e.en="en",e.es419="es-419",e.es="es",e.et="et",e.fa="fa",e.fi="fi",e.fil="fil",e.frCA="fr-CA",e.fr="fr",e.gu="gu",e.he="he",e.hi="hi",e.hr="hr",e.hu="hu",e.id="id",e.is="is",e.it="it",e.ja="ja",e.kn="kn",e.ko="ko",e.lt="lt",e.lv="lv",e.ml="ml",e.mr="mr",e.ms="ms",e.nb="bn",e.ne="ne",e.nl="nl",e.or="or",e.paIN="pa-IN",e.paPK="pa-PK",e.pl="pl",e.ptBR="pt-BR",e.ptPT="pa-PT",e.ro="ro",e.ru="ru",e.sk="sk",e.sl="sl",e.sr="sr",e.sv="sv",e.sw="sw",e.ta="ta",e.te="te",e.th="th",e.tr="tr",e.uk="uk",e.ur="ur",e.vi="vi",e.zhCN="zh-CN",e.zhTW="zh-TW",e.zu="zu"}(Vi||(Vi={})),function(e){e.AR=" ",e.FA=" ",e.EN=", "}(Gi||(Gi={})),function(e){e.ZERO="zero",e.ONE="one",e.TWO="two",e.FEW="few",e.MANY="many",e.OTHER="other"}(Wi||(Wi={}));var is={},ss=function(e,t){try{return(is[e]||(is[e]=new Intl.PluralRules(e))).select(t)}catch(n){return Wi.OTHER}};function os(e){return"number"==typeof e?e.toString():e.replace(/\$/,"$$$$")}var as=function(e){switch(e){case"ar":return"ar-u-nu-latn";default:return e}};function cs(e){return{seconds:Math.round(e/1e3),minutes:Math.round(e/1e3/60),hours:Math.round(e/1e3/60/60),days:Math.round(e/1e3/60/60/24)}}var ls=new(function(){function e(){h()(this,e),i()(this,"_locale",void 0),i()(this,"_dictionary",void 0),i()(this,"_isPseudoLocalizationOn",void 0),this._dictionary={},this._locale=Vi.en,this._isPseudoLocalizationOn=!1}return f()(e,[{key:"setDictionary",value:function(e){this._dictionary=e}},{key:"setLocale",value:function(e){this._locale=e}},{key:"getLocale",value:function(){return this._locale}},{key:"enablePseudoLocalization",value:function(){this._isPseudoLocalizationOn=!0}},{key:"disablePseudoLocalization",value:function(){this._isPseudoLocalizationOn=!1}},{key:"toLocaleLowerCase",value:function(e){return null==e?void 0:e.toLocaleLowerCase(this._locale)}},{key:"toLocaleUpperCase",value:function(e){return null==e?void 0:e.toLocaleUpperCase(this._locale)}},{key:"get",value:function(e){for(var t=(e in this._dictionary?this._dictionary[e]:e),n="",r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];if(rs(t)){var o=i[0],a=ss(this._locale,parseInt(o,10)),c=t[a];void 0!==c?n=c:t.other&&(n=t.other)}else n=t;if(/%\d%/.test(n)){var l=["desktop.login.DefaultErrorMessage","desktop.login.ErrorProxyAuthRequired","desktop.login.MissingUserInfoMessage","desktop.login.RegionMismatchMessage","desktop.login.ClientUpdateFail","desktop.login.FbUserNotFoundSignUp","desktop.login.errorCode","desktop-auth.error"];if(!l.includes(e))throw new Error("i18n: The placeholder format %0% is legacy and is only allowed for existing strings.")}if((null==i?void 0:i.length)>0)for(var u=0;u<i.length;u++){var d=i[u];if(null!=d)if("string"==typeof d)n=n.replace("{".concat(u,"}"),os(d)).replace("%".concat(u,"%"),os(d));else if("number"==typeof d){var p=this.formatNumber(d);n=n.replace("{".concat(u,"}"),p).replace("%".concat(u,"%"),p)}else if("object"===fi()(d))for(var h=0,_=Object.keys(d);h<_.length;h++){var f=_[h],g=d[f];n=n.replace("%".concat(f,"%"),os(g))}}return this._isPseudoLocalizationOn&&(n=ns.ZP.localize(n)),n}},{key:"getSeparator",value:function(){switch(this._locale){case Vi.ar:return Gi.AR;case Vi.fa:return Gi.FA;default:return Gi.EN}}},{key:"formatNumber",value:function(e){return e.toLocaleString(as(this._locale))}},{key:"formatDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n={year:"numeric",month:"long",day:"numeric"},r=t||n;return new Intl.DateTimeFormat(as(this._locale),r).format(e)}},{key:"formatRelativeDate",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=new Date(Date.now()),i=(e=new Date(e)).getTime()-r.getTime(),s=Math.abs(i)<2592e6;if(s&&null!==(t=Intl)&&void 0!==t&&t.RelativeTimeFormat){var o=cs(i),a=o.days,c=o.hours,l=o.minutes,u=o.seconds,d=new Intl.RelativeTimeFormat;return a||c||l?a||c?a?d.format(a,"days"):d.format(c,"hours"):d.format(l,"minutes"):d.format(u,"seconds")}return this.formatDate(e,n)}},{key:"__resetForTests",value:function(){this._dictionary={},this._locale=Vi.en,is={}}}]),e}()),us={width:"100%",height:"100%",color:"white"},ds=function(){return o().createElement("svg",{style:us,viewBox:"0 0 26 26",xmlns:"http://www.w3.org/2000/svg"},o().createElement("title",null,ls.get("embed_play")),o().createElement("path",{d:"M7.712 22.04a.732.732 0 0 1-.806.007.767.767 0 0 1-.406-.703V4.656c0-.31.135-.544.406-.703.271-.16.54-.157.806.006l14.458 8.332c.266.163.4.4.4.709 0 .31-.134.546-.4.71L7.712 22.04z",fill:"currentColor",fillRule:"evenodd"}))},ps={width:"100%",height:"100%",color:"white"},hs=(0,d.zo)((function(){return o().createElement("svg",{style:ps,viewBox:"0 0 26 26",xmlns:"http://www.w3.org/2000/svg"},o().createElement("title",null,ls.get("embed_pause")),o().createElement("g",{fill:"currentColor",fillRule:"evenodd"},o().createElement("rect",{x:"5",y:"3",width:"5",height:"20",rx:"1"}),o().createElement("rect",{x:"16",y:"3",width:"5",height:"20",rx:"1"})))}),{width:"100%",height:"100%"});function _s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fs(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_s(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var ms=(0,d.zo)("div",{position:"relative",width:"100%",height:"100%",minWidth:"80px",minHeight:"80px"}),ys=function(e){v()(n,e);var t=gs(n);function n(e){var r;return h()(this,n),r=t.call(this,e),i()(m()(r),"state",{isLoaded:!1}),i()(m()(r),"onImageLoad",(function(){r.setState({isLoaded:!0})})),e.src&&r.loadImage(e.src),r}return f()(n,[{key:"componentDidUpdate",value:function(){this.props.src&&!this._img&&this.loadImage(this.props.src)}},{key:"componentWillUnmount",value:function(){this._img&&(this._img.onload=null)}},{key:"loadImage",value:function(e){this._img=new Image,this._img.onload=this.onImageLoad,this._img.src=e}},{key:"render",value:function(){var e={height:"100%",position:"relative"};e=this.props.src&&this.state.isLoaded?fs(fs({},e),{},{backgroundImage:"url(".concat(this.props.src,")"),backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"center ".concat(this.props.top?"top":"center")}):fs(fs({},e),{},{backgroundColor:"transparent"});var t=(0,d.zo)("div",e);return o().createElement(ms,null,o().createElement(t,{onClick:this.props.onClick},this.props.children))}}]),n}(o().Component);function vs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var Es=(0,d.zo)("button",{background:"rgba(0, 0, 0, 0.5)",border:"1px solid white",borderRadius:"50%",position:"absolute",top:"25%",left:"25%",height:"50%",width:"50%",outline:"none",boxShadow:"0 0 10px rgba(0, 0, 0, 0.4)",transition:"transform 0.1s",cursor:"pointer",":hover":{transform:"scale(1.1)"}}),Ss=function(e){v()(n,e);var t=vs(n);function n(){return h()(this,n),t.apply(this,arguments)}return f()(n,[{key:"render",value:function(){var e=this.props.isPlaying?hs:ds,t=this.props.isPlaying?ls.get("embed_pause"):ls.get("embed_play"),n=this.props.noCoverArt?void 0:this.props.coverArtUrl;return o().createElement(ys,{src:n,onClick:this.props.onClick,top:this.props.top},this.props.noButton?void 0:o().createElement(Es,{title:t,onClick:this.props.onClick},o().createElement(e,null)))}}]),n}(o().PureComponent);function bs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var Ts=function(e){v()(n,e);var t=bs(n);function n(){var e;h()(this,n);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return e=t.call.apply(t,[this].concat(s)),i()(m()(e),"handleClick",(function(t){e.togglePlayback(),t.stopPropagation()})),i()(m()(e),"handleKeydown",(function(t){" "===t.key&&e.togglePlayback()})),i()(m()(e),"togglePlayback",(function(){e.props.isPlaying?e.props.onPause():e.props.onPlay()})),e}return f()(n,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeydown)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeydown)}},{key:"render",value:function(){return o().createElement(Ss,$()({},this.props,{onClick:this.handleClick}))}}]),n}(o().Component),Cs=(0,l.$j)((function(e){return{isPlaying:Ri(e),isPaused:Pi(e),coverArtUrl:K(e)}}),(function(e){return{onPlay:function(){return e(ts())},onPause:function(){return e(es())}}}))(Ts),Is=function(){return o().createElement("div",{style:{margin:"16px"}},o().createElement("p",null,"This size is now its own component, and not yet implemented... Stay put!"))};function Rs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var Ps=(0,d.zo)("a",{display:"block",margin:"8px 8px",textDecoration:"none",color:"inherit",fontWeight:"200",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",cursor:"pointer"}),As=(0,d.zo)("div",(function(e){var t;return t={color:e.$color,fontWeight:L,textOverflow:"ellipsis",overflow:"hidden"},i()(t,R,{fontSize:"14px",lineHeight:"19px"}),i()(t,P,{fontSize:"16px",lineHeight:"23px"}),t})),Os=(0,d.zo)("div",{textOverflow:"ellipsis",overflow:"hidden"}),ks=function(e){v()(n,e);var t=Rs(n);function n(){return h()(this,n),t.apply(this,arguments)}return f()(n,[{key:"render",value:function(){var e=this.props,t=e.title,n=e.titleColor,r=e.subtitle,i=e.onClick;return o().createElement(Ps,{onClick:i},o().createElement(As,{$color:n},o().createElement("span",{dir:"auto"},t)),o().createElement(Os,null,o().createElement("span",{dir:"auto"},r)))}}]),n}(o().PureComponent);i()(ks,"defaultProps",{titleColor:C.ixZ});var Ls=(0,M.P1)([function(e){return F(e)},function(e){return Ai(e)}],(function(e,t){return"artist"!==e.type||t?(t||e).name:ls.get("top_tracks_for_artist",{artist:e.name})})),ws=(0,M.P1)([function(e){return F(e)},function(e){return Ai(e)}],(function(e,t){if("playlist"===e.type&&!t)return e.primary_color})),Ds=(0,M.P1)([function(e){return F(e)},function(e){return Ai(e)}],(function(e,t){switch(e.type){case"album":return e.artists.map((function(e){return e.name})).join(ls.getSeparator());case"playlist":return t?"episode"===t.type?t.show.name:t.artists.map((function(e){return e.name})).join(ls.getSeparator()):e.owner.display_name;case"track":return e.album.artists.map((function(e){return e.name})).join(ls.getSeparator());case"episode":return e.show.name;case"show":return t?e.name:e.publisher;default:return""}})),Ns=(0,l.$j)((function(e){return{title:Ls(e),titleColor:ws(e),subtitle:Ds(e)}}))(ks);n(6e3);function Us(e,t){var n,r=0;return function(){for(var i=this,s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];var c=Date.now();r+t<c?(e.apply(this,o),r=c):(clearTimeout(n),n=setTimeout((function(){e.apply(i,o),r=c}),t))}}n(219),n(5163);var Ms=function(e){var t=Math.floor(e/6e4),n=Math.floor(e%6e4/1e3);return"".concat(t,":").concat(n<10?"0":"").concat(n)};function Bs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}function xs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fs(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xs(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var js=(0,d.zo)("div",(function(e){var t=e.$disabled,n=e.$styleProps;return Fs({padding:" 16px 0",position:"relative",flexGrow:1,cursor:t?"auto":"pointer"},void 0===n?{}:n)})),Ys=(0,d.zo)("div",{backgroundColor:"rgba(255, 255, 255, 0.3)",height:"4px",flex:"4"}),Ks=(0,d.zo)("div",(function(e){var t=e.$progress,n=e.$disabled;return{backgroundColor:"".concat(C.ixZ),height:"4px",width:"".concat(t,"%"),opacity:n?"0.4":"1"}})),Hs={from:{opacity:"0"},to:{opacity:"1"}},Vs={from:{opacity:"1"},to:{opacity:"0"}},Gs=(0,d.zo)("div",(function(e){var t=e.$progress,n=e.$isDragging,r=e.$width;return{position:"absolute",left:"calc(".concat(t,"% - ").concat(r,"px / 2)"),font:"0.8em Verdana,sans-serif",boxShadow:"0.1em 0.1em 0 ".concat(C.Snx,"B3"),bottom:"30px",display:"block",backgroundColor:"".concat(C.ixZ),color:"".concat(C.Snx),padding:"2px 5px",textShadow:"none",textAlign:"center",animationName:n?Hs:Vs,animationDuration:"0.1s",opacity:n?"1":"0",userSelect:"none",userDrag:"none"}})),Ws=(0,d.zo)("div",(function(e){var t=e.$progress,n=e.$isMouseOver,r=e.$disabled;return{position:"absolute",left:"calc(".concat(t,"% - 6px)"),bottom:"12px",display:n&&!r?"block":"none",backgroundColor:"".concat(C.ixZ),padding:"0px",textShadow:"none",height:"12px",width:"12px",zIndex:"100",boxShadow:"0 2px 4px 0 ".concat(C.Snx,"80"),borderRadius:"50%",userSelect:"none",userDrag:"none"}})),qs=function(e){v()(n,e);var t=Bs(n);function n(){var e;h()(this,n);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return e=t.call.apply(t,[this].concat(s)),i()(m()(e),"state",{isDragging:!1,fakeValue:null,isMouseOver:!1}),i()(m()(e),"renderSleepCount",0),i()(m()(e),"setBar",(function(t){e.bar=t})),i()(m()(e),"setProgressTimeTooltip",(function(t){e.progressTimeTooltip=t})),i()(m()(e),"handleMouseDown",(function(t){if(!e.props.disabled&&0===t.button){t.stopPropagation();var n=e.getRelativePosition(t.clientX);e.setState({isDragging:!0,fakeValue:n}),e.props.shouldIgnoreDragStart||e.reportUpdate(n)}})),i()(m()(e),"handleMouseMove",Us((function(t){if(!e.props.disabled&&e.state.isDragging)if(e.isOutsideBounds(t))e.handleMouseUp(t);else{var n=e.getRelativePosition(t.clientX);e.setState({fakeValue:n}),e.props.shouldUpdateWhileDragging&&e.reportUpdate(n)}}),50)),i()(m()(e),"handleMouseUp",(function(t){!e.props.disabled&&e.state.isDragging&&(t.stopPropagation(),e.setState({isDragging:!1}),e.reportUpdate(e.getRelativePosition(t.clientX)))})),i()(m()(e),"handleWrapperMouseEnter",(function(){e.setState({isMouseOver:!0})})),i()(m()(e),"handleWrapperMouseLeave",(function(){e.setState({isMouseOver:!1})})),e}return f()(n,[{key:"componentDidMount",value:function(){document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp)}},{key:"shouldComponentUpdate",value:function(e,t){var n=this,r=Object.keys(Fs(Fs({},e),this.props)).every((function(t){return e[t]===n.props[t]})),i=Object.keys(Fs(Fs({},t),this.state)).every((function(e){return t[e]===n.state[e]}));return(!r||!i)&&(Math.abs(e.currentValue-this.props.currentValue>1e3)?(this.renderSleepCount=0,!0):(this.state.isDragging&&!t.isDragging&&(this.renderSleepCount=3),!(this.renderSleepCount>0)||(this.renderSleepCount--,!1)))}},{key:"getRelativePosition",value:function(e){var t=this.bar.getBoundingClientRect(),n=t.right-t.left;return Math.max(0,Math.min((e-t.left)/n,1))*this.props.max}},{key:"reportUpdate",value:function(e){this.props.onUpdate(Math.max(0,Math.min(e,this.props.max)))}},{key:"isOutsideBounds",value:function(e){return e.pageX<0||e.pageY<0||e.pageX>window.innerWidth||e.pageY>window.innerHeight+window.scrollY}},{key:"progressTimeTooltipWidth",value:function(){if(this.progressTimeTooltip){var e=this.progressTimeTooltip.getBoundingClientRect();return e.right-e.left}return 0}},{key:"render",value:function(){var e=this.props,t=e.currentValue,n=e.max,r=e.disabled,i=e.$styleProps,s=this.state,a=s.isDragging,c=s.fakeValue,l=s.isMouseOver,u=a?c:t,d=Math.min(u/n*100,100),p=Ms(Math.max(0,u));return o().createElement(js,{onMouseDown:this.handleMouseDown,$styleProps:i,$disabled:r,onMouseEnter:this.handleWrapperMouseEnter,onMouseLeave:this.handleWrapperMouseLeave},o().createElement(Gs,{ref:this.setProgressTimeTooltip,$progress:d,$width:this.progressTimeTooltipWidth(),$isDragging:a},p),o().createElement(Ws,{$progress:d,$isMouseOver:l,$disabled:r}),o().createElement(Ys,{ref:this.setBar},o().createElement(Ks,{$progress:d,$disabled:r})))}}]),n}(o().Component);function zs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}function $s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}i()(qs,"defaultProps",{currentValue:0,max:1,shouldUpdateWhileDragging:!1,shouldIgnoreDragStart:!1,disabled:!1,onUpdate:function(){}});var Qs=(0,d.zo)("div",(function(e){var t=e.$max,n=e.$styleProps;return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$s(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({display:t?"inline-block":"none",verticalAlign:"top",fontSize:"10px",whiteSpace:"nowrap",margin:"0 8px",fontFeatureSettings:'"tnum"'},void 0===n?{}:n)})),Xs=function(e){v()(n,e);var t=zs(n);function n(){return h()(this,n),t.apply(this,arguments)}return f()(n,[{key:"render",value:function(){var e=this.props,t=e.currentValue,n=e.max,r=e.$styleProps;return o().createElement(Qs,{$max:n,$styleProps:r},"-",n&&t?"".concat(Ms(Math.max(0,n-t))):Ms(0))}}]),n}(o().Component);function Js(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}i()(Xs,"defaultProps",{currentValue:0});var Zs=(0,d.zo)("button",(function(e){var t=e.$size,n=void 0===t?40:t,r=e.$styleProps,s=void 0===r?{}:r;return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Js(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Js(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({padding:0,border:"none",cursor:"pointer",background:"transparent",width:"".concat(n,"px"),height:"".concat(n,"px"),outline:"none"},s)}));function eo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var to=(0,d.zo)("svg",{width:"100%",height:"100%",filter:O}),no=function(e){v()(n,e);var t=eo(n);function n(){return h()(this,n),t.apply(this,arguments)}return f()(n,[{key:"render",value:function(){var e=this.props,t=e.onClick,n=e.$styleProps;return o().createElement(Zs,{onClick:t,title:ls.get("playback-control.skip-forward"),$styleProps:n},o().createElement(to,{viewBox:"16 16 32 32"},o().createElement("path",{d:"M38,22 C38,21.7248663 38.0978826,21.489419 38.2936508,21.2936508 C38.489419,21.0978826 38.7248663,21 39,21 L41,21 C41.2751337,21 41.510581,21.0978826 41.7063492,21.2936508 C41.9021174,21.489419 42,21.7248663 42,22 L42,42 C42,42.2751337 41.9021174,42.510581 41.7063492,42.7063492 C41.510581,42.9021174 41.2751337,43 41,43 L39,43 C38.7248663,43 38.489419,42.9021174 38.2936508,42.7063492 C38.0978826,42.510581 38,42.2751337 38,42 L38,33.7619048 L23.4920635,42.1269841 C23.1640195,42.3280433 22.833335,42.3306888 22.5,42.1349206 C22.166665,41.9391525 22,41.6507956 22,41.2698413 L22,22.7301587 C22,22.3492044 22.166665,22.0608475 22.5,21.8650794 C22.833335,21.6693112 23.1640195,21.6719567 23.4920635,21.8730159 L38,30.2380952 L38,22 Z",fill:"white"})))}}]),n}(o().PureComponent);function ro(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var io=(0,d.zo)("svg",{width:"100%",height:"100%",filter:O}),so=function(e){v()(n,e);var t=ro(n);function n(){return h()(this,n),t.apply(this,arguments)}return f()(n,[{key:"render",value:function(){var e=this.props,t=e.onClick,n=e.size,r=e.$styleProps;return o().createElement(Zs,{onClick:t,title:ls.get("playback-control.skip-back"),$size:n,$styleProps:r},o().createElement(io,{viewBox:"16 16 32 32"},o().createElement("path",{d:"M40.5079365,21.8730159 C40.8359805,21.6719567 41.166665,21.6693112 41.5,21.8650794 C41.833335,22.0608475 42,22.3492044 42,22.7301587 L42,41.2698413 C42,41.6507956 41.833335,41.9391525 41.5,42.1349206 C41.166665,42.3306888 40.8359805,42.3280433 40.5079365,42.1269841 L26,33.7619048 L26,42 C26,42.2751337 25.9021174,42.510581 25.7063492,42.7063492 C25.510581,42.9021174 25.2751337,43 25,43 L23,43 C22.7248663,43 22.489419,42.9021174 22.2936508,42.7063492 C22.0978826,42.510581 22,42.2751337 22,42 L22,22 C22,21.7248663 22.0978826,21.489419 22.2936508,21.2936508 C22.489419,21.0978826 22.7248663,21 23,21 L25,21 C25.2751337,21 25.510581,21.0978826 25.7063492,21.2936508 C25.9021174,21.489419 26,21.7248663 26,22 L26,30.2380952 L40.5079365,21.8730159 Z",fill:"white"})))}}]),n}(o().PureComponent);function oo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var ao=(0,d.zo)("svg",{width:"100%",height:"100%",filter:O}),co=function(e){v()(n,e);var t=oo(n);function n(){return h()(this,n),t.apply(this,arguments)}return f()(n,[{key:"render",value:function(){var e=this.props,t=e.onClick,n=e.$styleProps;return o().createElement(Zs,{onClick:t,title:ls.get("spe.playback-control.skip-backward-15"),$styleProps:n},o().createElement(ao,{viewBox:"0 0 32 32"},o().createElement("path",{d:"M2.0952381,14.8730159 C2.60317714,14.4920616 2.92063429,13.9947121 3.04761905,13.3809524 L4.53968254,13.3809524 L4.53968254,25.6666667 L2.87301587,25.6666667 L2.87301587,16.6984127 L0.158730159,16.6984127 L0.158730159,15.4920635 C0.941802857,15.4708994 1.58729905,15.2645522 2.0952381,14.8730159 Z M14.952381,18.7777778 C15.301589,19.1269859 15.5740731,19.555553 15.7698413,20.0634921 C15.9656094,20.5714311 16.0634921,21.1322721 16.0634921,21.7460317 C16.0634921,22.3174632 15.962964,22.8571403 15.7619048,23.3650794 C15.5608456,23.8624363 15.2698432,24.3015854 14.8888889,24.6825397 C14.5079346,25.0529119 14.0476217,25.3492052 13.5079365,25.5714286 C12.9576692,25.7830698 12.3439187,25.8888889 11.6666667,25.8888889 C11.052907,25.8888889 10.4894206,25.7910063 9.97619048,25.5952381 C9.4629604,25.3994699 9.0185204,25.1375678 8.64285714,24.8095238 C8.26719389,24.4814798 7.9656096,24.0978858 7.73809524,23.6587302 C7.51058087,23.2195745 7.37566159,22.7513252 7.33333333,22.2539683 L8.87301587,21.8730159 C8.90476206,22.222224 8.99470825,22.5529085 9.14285714,22.8650794 C9.29100603,23.1772502 9.48677127,23.4444433 9.73015873,23.6666667 C9.97354619,23.8994721 10.2539667,24.0793644 10.5714286,24.2063492 C10.8994725,24.333334 11.2645483,24.3968254 11.6666667,24.3968254 C12.0687851,24.3968254 12.4365063,24.333334 12.7698413,24.2063492 C13.1031763,24.0793644 13.3888877,23.8994721 13.6269841,23.6666667 C13.8650806,23.4338613 14.0502639,23.1534408 14.1825397,22.8253968 C14.3148155,22.4973529 14.3809524,22.14815 14.3809524,21.7777778 C14.3809524,21.3439132 14.31217,20.9629646 14.1746032,20.6349206 C14.0370363,20.3068767 13.8465621,20.0264562 13.6031746,19.7936508 C13.3597871,19.5608454 13.0740757,19.3835985 12.7460317,19.2619048 C12.4179878,19.140211 12.058203,19.0793651 11.6666667,19.0793651 C11.1481456,19.0793651 10.6772508,19.1878296 10.2539683,19.4047619 C9.83068571,19.6216942 9.48677381,19.8994692 9.22222222,20.2380952 L7.68253968,19.6666667 L9.01587302,13.3809524 L15.4920635,13.3809524 L15.4920635,14.9365079 L10.1746032,14.9365079 L9.38095238,18.6984127 C9.52910127,18.5290997 9.70899365,18.380953 9.92063492,18.2539683 C10.1322762,18.1269835 10.3492052,18.0211644 10.5714286,17.9365079 C10.804234,17.8412694 11.0423268,17.7777779 11.2857143,17.7460317 C11.5291017,17.7037035 11.7671946,17.6825397 12,17.6825397 C12.6031776,17.6825397 13.1587276,17.7777768 13.6666667,17.968254 C14.1640237,18.1587311 14.5925908,18.4285697 14.952381,18.7777778 Z M20,5.33333333 C21.4391606,5.33333333 22.8174537,5.60581738 24.1349206,6.15079365 C25.4523875,6.69576992 26.5872968,7.4312123 27.5396825,8.35714286 C28.4920683,9.28307341 29.2513199,10.3835915 29.8174603,11.6587302 C30.3836007,12.9338688 30.6666667,14.2698343 30.6666667,15.6666667 C30.6666667,17.063499 30.3836007,18.3994645 29.8174603,19.6746032 C29.2513199,20.9497418 28.4920683,22.0502599 27.5396825,22.9761905 C26.5872968,23.902121 25.4523875,24.6375634 24.1349206,25.1825397 C22.8174537,25.727516 21.4391606,26 20,26 L20,24.6666667 C21.6825481,24.6666667 23.2407336,24.2645543 24.6746032,23.4603175 C26.1084728,22.6560806 27.2433821,21.563499 28.0793651,20.1825397 C28.9153481,18.8015804 29.3333333,17.2963044 29.3333333,15.6666667 C29.3333333,14.0370289 28.9153481,12.5317529 28.0793651,11.1507937 C27.2433821,9.76983437 26.1084728,8.6772527 24.6746032,7.87301587 C23.2407336,7.06877905 21.6825481,6.66666667 20,6.66666667 L10.6666667,6.66666667 L10.6666667,9.66666667 L4.31746032,6 L10.6666667,2.33333333 L10.6666667,5.33333333 L20,5.33333333 Z",fill:"white"})))}}]),n}(o().PureComponent);function lo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var uo=(0,d.zo)("svg",{width:"100%",height:"100%",filter:O}),po=function(e){v()(n,e);var t=lo(n);function n(){return h()(this,n),t.apply(this,arguments)}return f()(n,[{key:"render",value:function(){var e=this.props,t=e.onClick,n=e.$styleProps;return o().createElement(Zs,{onClick:t,title:ls.get("playback-control.skip-forward-15"),$styleProps:n},o().createElement(uo,{viewBox:"0 0 32 32"},o().createElement("path",{d:"M12,6.66666667 C10.3174519,6.66666667 8.75926643,7.06877905 7.32539683,7.87301587 C5.89152722,8.6772527 4.75661794,9.76983437 3.92063492,11.1507937 C3.0846519,12.5317529 2.66666667,14.0370289 2.66666667,15.6666667 C2.66666667,17.2963044 3.0846519,18.8015804 3.92063492,20.1825397 C4.75661794,21.563499 5.89152722,22.6560806 7.32539683,23.4603175 C8.75926643,24.2645543 10.3174519,24.6666667 12,24.6666667 L12,26 C10.5608394,26 9.18254627,25.727516 7.86507937,25.1825397 C6.54761246,24.6375634 5.41270317,23.902121 4.46031746,22.9761905 C3.50793175,22.0502599 2.74868008,20.9497418 2.18253968,19.6746032 C1.61639929,18.3994645 1.33333333,17.063499 1.33333333,15.6666667 C1.33333333,14.2698343 1.61639929,12.9338688 2.18253968,11.6587302 C2.74868008,10.3835915 3.50793175,9.28307341 4.46031746,8.35714286 C5.41270317,7.4312123 6.54761246,6.69576992 7.86507937,6.15079365 C9.18254627,5.60581738 10.5608394,5.33333333 12,5.33333333 L21.3333333,5.33333333 L21.3333333,2.33333333 L27.6825397,6 L21.3333333,9.66666667 L21.3333333,6.66666667 L12,6.66666667 Z M13.7777778,15.8253968 C14.5714325,15.8042327 15.2222197,15.600531 15.7301587,15.2142857 C16.2380978,14.8280404 16.5555549,14.3280454 16.6825397,13.7142857 L18.1746032,13.7142857 L18.1746032,26 L16.5079365,26 L16.5079365,17.031746 L13.7777778,17.031746 L13.7777778,15.8253968 Z M29.3968254,20.3968254 C29.5978846,20.8941824 29.6984127,21.4550233 29.6984127,22.0793651 C29.6984127,22.6507965 29.5978846,23.1904737 29.3968254,23.6984127 C29.1957662,24.1957697 28.9047638,24.6322733 28.5238095,25.0079365 C28.1428552,25.3835998 27.6798969,25.6825386 27.1349206,25.9047619 C26.5899444,26.1269852 25.9788394,26.2380952 25.3015873,26.2380952 C24.6878276,26.2380952 24.1216957,26.1375671 23.6031746,25.9365079 C23.0952356,25.7460308 22.653441,25.4841287 22.2777778,25.1507937 C21.9021145,24.8174587 21.6005302,24.4312191 21.3730159,23.9920635 C21.1455015,23.5529079 21.0105822,23.0846586 20.968254,22.5873016 L22.5079365,22.2063492 C22.5396827,22.5555573 22.6269834,22.8862418 22.7698413,23.1984127 C22.9126991,23.5105836 23.1058189,23.7777767 23.3492063,24 C23.5925938,24.2222233 23.8756598,24.4021157 24.1984127,24.5396825 C24.5211656,24.6772494 24.8862413,24.7460317 25.2936508,24.7460317 C25.7010602,24.7460317 26.0714269,24.6798948 26.4047619,24.547619 C26.7380969,24.4153433 27.0211629,24.2328054 27.2539683,24 C27.4973557,23.7566125 27.682539,23.4761921 27.8095238,23.1587302 C27.9470906,22.8306862 28.015873,22.4814833 28.015873,22.1111111 C28.015873,21.6772465 27.9470906,21.2962979 27.8095238,20.968254 C27.671957,20.64021 27.4814827,20.3597895 27.2380952,20.1269841 C26.9947078,19.8941787 26.7089963,19.7169318 26.3809524,19.5952381 C26.0529084,19.4735444 25.6878327,19.4126984 25.2857143,19.4126984 C24.7671932,19.4126984 24.3015894,19.5185175 23.8888889,19.7301587 C23.4656063,19.9523821 23.1216944,20.2328025 22.8571429,20.5714286 L21.3015873,20 L22.6349206,13.7142857 L29.1269841,13.7142857 L29.1269841,15.2698413 L23.8095238,15.2698413 L23,19.031746 C23.1481489,18.862433 23.3280413,18.7142863 23.5396825,18.5873016 C23.7513238,18.4603168 23.9735438,18.3544978 24.2063492,18.2698413 C24.4285725,18.1851848 24.6613744,18.1216933 24.9047619,18.0793651 C25.1481494,18.0370368 25.3862422,18.015873 25.6190476,18.015873 C26.2328073,18.015873 26.7910028,18.1111102 27.2936508,18.3015873 C27.7962988,18.4920644 28.224866,18.761903 28.5793651,19.1111111 C28.9338642,19.4603192 29.2063483,19.8888863 29.3968254,20.3968254 Z",fill:"white"})))}}]),n}(o().PureComponent);function ho(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var _o=(0,d.zo)("div",{position:"absolute",bottom:0,width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",flexWrap:"nowrap",margin:"0 4px"}),fo=function(e){v()(n,e);var t=ho(n);function n(){var e;h()(this,n);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return e=t.call.apply(t,[this].concat(s)),i()(m()(e),"SKIP_TIME_MS",15e3),i()(m()(e),"handleUpdate",(function(t){e.props.player.seek(t)})),i()(m()(e),"handleSeekBackward",(function(){e.props.player.seekBackward(e.SKIP_TIME_MS)})),i()(m()(e),"handleSeekForward",(function(){e.props.player.seekForward(e.SKIP_TIME_MS)})),e}return f()(n,[{key:"render",value:function(){var e=this.props,t=e.trackLength,n=e.progress,r=e.onNext,s=e.onPrev,a=e.type,c=e.disabled,l="show"===a||"episode"===a,u=!l&&"track"!==a,d=i()({width:"16px",height:"16px",padding:"8px 4px",boxSizing:"content-box"},":last-child",{paddingRight:"8px"});return o().createElement(_o,{dir:"ltr"},u&&o().createElement(so,{onClick:s,$styleProps:d}),l&&o().createElement(co,{onClick:this.handleSeekBackward,$styleProps:d}),o().createElement(qs,{currentValue:n,max:t,onUpdate:this.handleUpdate,disabled:c,shouldIgnoreDragStart:!0,$styleProps:{margin:"0 0px"}}),u&&o().createElement(no,{onClick:r,$styleProps:d}),l&&o().createElement(po,{onClick:this.handleSeekForward,$styleProps:d}),o().createElement(Xs,{currentValue:n,max:t,$styleProps:{margin:"0 4px"}}))}}]),n}(o().PureComponent),go=(0,l.$j)((function(e){return{trackLength:ki(e),disabled:!Ai(e),player:Li(e),type:j(e),progress:e.progress}}),(function(e){return{onNext:function(){return e(Xi())},onPrev:function(){return e(Ji())}}}))(fo),mo=(0,d.zo)("div",{position:"relative",flex:100,minHeight:"80px",minWidth:"0"}),yo=function(){return o().createElement(mo,null,o().createElement(Ns,null),o().createElement(go,null))},vo={SHOW_SHARE:"SHOW_SHARE",COPY_EMBED_CODE:"COPY_EMBED_CODE",COPY_URL:"COPY_URL",HIDE_SHARE:"HIDE_SHARE"},Eo=vo,So=function(e){return e.share.visible},bo=function(e){return e.share.view},To=(n(756),(0,d.zo)((function(){return o().createElement("svg",{viewBox:"0 0 16 16"},o().createElement("title",null,ls.get("close_button_action")),o().createElement("polygon",{fill:"white",points:"14.354,2.353 13.646,1.646 8,7.293 2.353,1.646 1.646,2.353 7.293,8 1.646,13.646 2.353,14.354 8,8.707 13.646,14.354 14.354,13.646 8.707,8 \t"}))}),{width:"100%",height:"100%"}));function Co(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var Io=(0,d.zo)("div",(function(e){return{position:"absolute",top:0,left:0,width:"100%",height:"100%",boxSizing:"border-box",padding:"10px",backgroundColor:e.$small?"#000":"rgba(0, 0, 0, 0.9)",transitionProperty:"opacity",transitionDuration:"0.2s",opacity:e.$opacity,zIndex:1}})),Ro=(0,d.zo)("button",{position:"absolute",top:0,right:0,background:"transparent",width:"16px",border:"none",cursor:"pointer",outline:"none",padding:0,margin:"10px"}),Po=function(e){v()(n,e);var t=Co(n);function n(){var e;h()(this,n);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return e=t.call.apply(t,[this].concat(s)),i()(m()(e),"state",{opacity:0}),i()(m()(e),"handleKeydown",(function(t){"Escape"===t.key&&e.props.onClose()})),e}return f()(n,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keydown",this.handleKeydown),setTimeout((function(){return e.setState({opacity:1})}),10)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeydown)}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.small,r=e.onClose;return o().createElement(Io,{$small:n,$opacity:this.state.opacity},t,o().createElement(Ro,{onClick:r},o().createElement(To,null)))}}]),n}(o().PureComponent),Ao=function(e){return window.open("https://www.facebook.com/dialog/share?href=".concat(encodeURIComponent(e),"&redirect_uri=").concat(encodeURIComponent(e),"&hashtag=").concat(encodeURIComponent("#NowPlaying"),"&app_id=174829003346&display=page"),"","width=640,height=551")},Oo=function(e){var t=window.SpotifyEnvironment&&window.SpotifyEnvironment.isMobile;window.open("".concat(t?"fb-messenger://share/":"https://www.facebook.com/dialog/send","?link=").concat(encodeURIComponent(e),"&redirect_uri=").concat(encodeURIComponent(e),"&app_id=174829003346&display=page"),"","width=996,height=550")},ko=function(e){return window.open("https://twitter.com/intent/tweet?url=".concat(encodeURIComponent(e),"&hashtags=NowPlaying&related=spotify"),"","width=640,height=300")},Lo=function(e){return window.open("https://api.whatsapp.com/send?text=".concat(encodeURIComponent(e)),"")},wo=function(e){var t=document.createElement("input");t.value=e,t.style.position="absolute",t.style.left="-9999px",document.body.appendChild(t),t.select(),t.setSelectionRange(0,t.value.length),document.execCommand("copy"),document.body.removeChild(t)},Do=function(e){var t="<iframe "+'src="https://open.spotify.com/embed?uri='.concat(encodeURIComponent(e),'" ')+'width="300" height="380" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>',n=document.createElement("input");n.value=t,n.style.position="absolute",n.style.left="-9999px",document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n)};function No(e){var t,n='{"fonts/CircularSpUIAraOnly-Black.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Black.6d6a4c25.otf","fonts/CircularSpUIAraOnly-Black.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Black.05b31ded.woff","fonts/CircularSpUIAraOnly-Black.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Black.c32951f4.woff2","fonts/CircularSpUIAraOnly-Bold.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Bold.f97cb921.otf","fonts/CircularSpUIAraOnly-Bold.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Bold.9ddc7126.woff","fonts/CircularSpUIAraOnly-Bold.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Bold.317e96e5.woff2","fonts/CircularSpUIAraOnly-Book.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Book.f0effcd1.otf","fonts/CircularSpUIAraOnly-Book.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Book.3ad862e2.woff","fonts/CircularSpUIAraOnly-Book.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Book.aaab109b.woff2","fonts/CircularSpUIAraOnly-Light.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Light.f0833f3b.otf","fonts/CircularSpUIAraOnly-Light.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Light.5c7ed8d8.woff","fonts/CircularSpUIAraOnly-Light.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Light.dde45e52.woff2","fonts/CircularSpUICyrOnly-Black.otf":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Black.50cd1ca9.otf","fonts/CircularSpUICyrOnly-Black.woff":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Black.7536a73f.woff","fonts/CircularSpUICyrOnly-Black.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Black.f5526fc4.woff2","fonts/CircularSpUICyrOnly-Bold.otf":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Bold.67641b90.otf","fonts/CircularSpUICyrOnly-Bold.woff":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Bold.909126fc.woff","fonts/CircularSpUICyrOnly-Bold.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Bold.30dc9fb2.woff2","fonts/CircularSpUICyrOnly-Book.otf":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Book.15af6ebe.otf","fonts/CircularSpUICyrOnly-Book.woff":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Book.918c53b8.woff","fonts/CircularSpUICyrOnly-Book.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Book.6a858994.woff2","fonts/CircularSpUICyrOnly-Light.otf":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Light.b10eb959.otf","fonts/CircularSpUICyrOnly-Light.woff":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Light.034997d0.woff","fonts/CircularSpUICyrOnly-Light.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Light.55fa9f4a.woff2","fonts/CircularSpUIHbrOnly-Black.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Black.11abebe4.otf","fonts/CircularSpUIHbrOnly-Black.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Black.0a11e734.woff","fonts/CircularSpUIHbrOnly-Black.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Black.217fb21f.woff2","fonts/CircularSpUIHbrOnly-Bold.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Bold.57b36278.otf","fonts/CircularSpUIHbrOnly-Bold.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Bold.9f406804.woff","fonts/CircularSpUIHbrOnly-Bold.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Bold.ef043f44.woff2","fonts/CircularSpUIHbrOnly-Book.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Book.fae4aece.otf","fonts/CircularSpUIHbrOnly-Book.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Book.ad2b13cd.woff","fonts/CircularSpUIHbrOnly-Book.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Book.cb36b6ec.woff2","fonts/CircularSpUIHbrOnly-Light.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Light.2e1df62a.otf","fonts/CircularSpUIHbrOnly-Light.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Light.2128eeac.woff","fonts/CircularSpUIHbrOnly-Light.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Light.4884da16.woff2","fonts/CircularSpUIv3T-Black.ttf":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Black.ce8ef887.ttf","fonts/CircularSpUIv3T-Black.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Black.effa986f.woff","fonts/CircularSpUIv3T-Black.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Black.c21e63c5.woff2","fonts/CircularSpUIv3T-Bold.ttf":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Bold.7eb7d0f7.ttf","fonts/CircularSpUIv3T-Bold.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Bold.10e93738.woff","fonts/CircularSpUIv3T-Bold.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Bold.8d0a45cc.woff2","fonts/CircularSpUIv3T-Book.ttf":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Book.a357677a.ttf","fonts/CircularSpUIv3T-Book.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Book.ea8d19db.woff","fonts/CircularSpUIv3T-Book.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Book.3466e0ec.woff2","fonts/CircularSpUIv3T-Light.ttf":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Light.89e4be2e.ttf","fonts/CircularSpUIv3T-Light.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Light.2a78c017.woff","fonts/CircularSpUIv3T-Light.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Light.afd9ab26.woff2","fonts/spoticon_regular_2.ttf":"https://open.scdn.co/cdn/fonts/spoticon_regular_2.127670b5.ttf","fonts/spoticon_regular_2.woff":"https://open.scdn.co/cdn/fonts/spoticon_regular_2.ff4c6091.woff","fonts/spoticon_regular_2.woff2":"https://open.scdn.co/cdn/fonts/spoticon_regular_2.d319d911.woff2","generated/manifest-mobile-web-player.json":"https://open.scdn.co/cdn/generated/manifest-mobile-web-player.2aef628f.json","generated/manifest-web-player.json":"https://open.scdn.co/cdn/generated/manifest-web-player.038c3337.json","generated/opensearch.xml":"https://open.scdn.co/cdn/generated/opensearch.abfbfc66.xml","images/checkmark.png":"https://open.scdn.co/cdn/images/checkmark.389faa13.png","images/concert-hub-fb-card.png":"https://open.scdn.co/cdn/images/concert-hub-fb-card.5072379c.png","images/concert-hub-header.png":"https://open.scdn.co/cdn/images/concert-hub-header.56bcad9b.png","images/concert-hub-iphone-de.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-de.b6f99e33.png","images/concert-hub-iphone-el.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-el.5672149c.png","images/concert-hub-iphone-en.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-en.6eda306a.png","images/concert-hub-iphone-es_419.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-es_419.cefd672a.png","images/concert-hub-iphone-es.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-es.cefd672a.png","images/concert-hub-iphone-fi.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-fi.52e8d625.png","images/concert-hub-iphone-fr_CA.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-fr_CA.93b897cb.png","images/concert-hub-iphone-fr.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-fr.336e7db1.png","images/concert-hub-iphone-hu.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-hu.5eba9191.png","images/concert-hub-iphone-id.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-id.87ecf560.png","images/concert-hub-iphone-it.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-it.18450a29.png","images/concert-hub-iphone-ja.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-ja.6eda306a.png","images/concert-hub-iphone-ms.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-ms.83140310.png","images/concert-hub-iphone-nl.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-nl.cb3a5038.png","images/concert-hub-iphone-pl.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-pl.45abd89b.png","images/concert-hub-iphone-pt_BR.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-pt_BR.e932ef02.png","images/concert-hub-iphone-sv.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-sv.5e512289.png","images/concert-hub-iphone-tr.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-tr.a017f03c.png","images/concert-hub-iphone-zh_TW.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-zh_TW.6eda306a.png","images/concert-hub-twitter-card.png":"https://open.scdn.co/cdn/images/concert-hub-twitter-card.71f6a06d.png","images/connect_header@1x.png":"https://open.scdn.co/cdn/images/connect_header@1x.ecc6912d.png","images/connect-to-devices-white.svg":"https://open.scdn.co/cdn/images/connect-to-devices-white.69d4229a.svg","images/desktop-auth-check.svg":"https://open.scdn.co/cdn/images/desktop-auth-check.65be3bbc.svg","images/desktop-auth-error.svg":"https://open.scdn.co/cdn/images/desktop-auth-error.b82f823b.svg","images/devices/android.png":"https://open.scdn.co/cdn/images/devices/android.460a5815.png","images/devices/ios.png":"https://open.scdn.co/cdn/images/devices/ios.535e1468.png","images/devices/mac-web.png":"https://open.scdn.co/cdn/images/devices/mac-web.71c1af1f.png","images/devices/mac.png":"https://open.scdn.co/cdn/images/devices/mac.80dcea83.png","images/devices/windowsphone.png":"https://open.scdn.co/cdn/images/devices/windowsphone.350c5a17.png","images/embed-podcast/upsell-background.png":"https://open.scdn.co/cdn/images/embed-podcast/upsell-background.00c81565.png","images/embed/copy-32_circle_grey_outline_bg.svg":"https://open.scdn.co/cdn/images/embed/copy-32_circle_grey_outline_bg.0c6130eb.svg","images/embed/embed-code-32_circle_grey_outline_bg.svg":"https://open.scdn.co/cdn/images/embed/embed-code-32_circle_grey_outline_bg.b40a255f.svg","images/embed/fb_colour.svg":"https://open.scdn.co/cdn/images/embed/fb_colour.13fa515f.svg","images/embed/messenger_colour.svg":"https://open.scdn.co/cdn/images/embed/messenger_colour.8f4836ec.svg","images/embed/twitter_colour.svg":"https://open.scdn.co/cdn/images/embed/twitter_colour.456d46db.svg","images/embed/whatsapp.svg":"https://open.scdn.co/cdn/images/embed/whatsapp.e33bfab4.svg","images/emi.png":"https://open.scdn.co/cdn/images/emi.c7e51c1a.png","images/employee-podcasts-modal-art.png":"https://open.scdn.co/cdn/images/employee-podcasts-modal-art.956e5f5e.png","images/equaliser-animated-green.gif":"https://open.scdn.co/cdn/images/equaliser-animated-green.73b73928.gif","images/equaliser-green.svg":"https://open.scdn.co/cdn/images/equaliser-green.1184ed87.svg","images/favicon.ico":"https://open.scdn.co/cdn/images/favicon.5cb2bd30.ico","images/favicon.png":"https://open.scdn.co/cdn/images/favicon.0c211e2e.png","images/favicon16.png":"https://open.scdn.co/cdn/images/favicon16.19fc3918.png","images/favicon32.png":"https://open.scdn.co/cdn/images/favicon32.a19b4f5b.png","images/focused_stroy_play.png":"https://open.scdn.co/cdn/images/focused_stroy_play.c908b733.png","images/follow/avatar-placeholder.png":"https://open.scdn.co/cdn/images/follow/avatar-placeholder.2f817d4a.png","images/follow/sprite.gif":"https://open.scdn.co/cdn/images/follow/sprite.e282a709.gif","images/follow/sprite@1.png":"https://open.scdn.co/cdn/images/follow/sprite@1.b994540b.png","images/hifi-button-off.svg":"https://open.scdn.co/cdn/images/hifi-button-off.87461500.svg","images/hifi-button-on.svg":"https://open.scdn.co/cdn/images/hifi-button-on.48a2de90.svg","images/hifi.svg":"https://open.scdn.co/cdn/images/hifi.0526a5b1.svg","images/home-icon.svg":"https://open.scdn.co/cdn/images/home-icon.ba66757a.svg","images/icons/Spotify_1024.png":"https://open.scdn.co/cdn/images/icons/Spotify_1024.d6467a14.png","images/icons/Spotify_128.png":"https://open.scdn.co/cdn/images/icons/Spotify_128.c9ce2f2e.png","images/icons/Spotify_16.png":"https://open.scdn.co/cdn/images/icons/Spotify_16.aa3775a0.png","images/icons/Spotify_256.png":"https://open.scdn.co/cdn/images/icons/Spotify_256.c8416b60.png","images/icons/Spotify_32.png":"https://open.scdn.co/cdn/images/icons/Spotify_32.492cdebf.png","images/icons/Spotify_512.png":"https://open.scdn.co/cdn/images/icons/Spotify_512.49a0bf03.png","images/icons/Spotify_64.png":"https://open.scdn.co/cdn/images/icons/Spotify_64.47bcd979.png","images/icons/Spotify_MWP_192.png":"https://open.scdn.co/cdn/images/icons/Spotify_MWP_192.c70b9055.png","images/icons/Spotify_MWP_512.png":"https://open.scdn.co/cdn/images/icons/Spotify_MWP_512.591cfa88.png","images/improved-modal-bg.jpg":"https://open.scdn.co/cdn/images/improved-modal-bg.23e5dcb1.jpg","images/login-background.jpg":"https://open.scdn.co/cdn/images/login-background.078204fe.jpg","images/login-signup-burst.svg":"https://open.scdn.co/cdn/images/login-signup-burst.5f6a6521.svg","images/logo-complete-black.svg":"https://open.scdn.co/cdn/images/logo-complete-black.573d8227.svg","images/logo-white-2x.png":"https://open.scdn.co/cdn/images/logo-white-2x.ef36ed81.png","images/merlin.png":"https://open.scdn.co/cdn/images/merlin.cd7e72d1.png","images/mid-year.png":"https://open.scdn.co/cdn/images/mid-year.9e2ead8f.png","images/moviebuff.png":"https://open.scdn.co/cdn/images/moviebuff.65e80213.png","images/og-image.png":"https://open.scdn.co/cdn/images/og-image.64b84348.png","images/orchard.png":"https://open.scdn.co/cdn/images/orchard.677c5ae0.png","images/rovi.png":"https://open.scdn.co/cdn/images/rovi.7b503678.png","images/s2l-desktopui-ltr.png":"https://open.scdn.co/cdn/images/s2l-desktopui-ltr.3024b050.png","images/s2l-desktopui-rtl.png":"https://open.scdn.co/cdn/images/s2l-desktopui-rtl.a9690daf.png","images/s2l-mobileui.png":"https://open.scdn.co/cdn/images/s2l-mobileui.9fc9d151.png","images/sony.png":"https://open.scdn.co/cdn/images/sony.7e5692e6.png","images/spotifylogo.svg":"https://open.scdn.co/cdn/images/spotifylogo.a884cca3.svg","images/station-header-wave.svg":"https://open.scdn.co/cdn/images/station-header-wave.0f3784ea.svg","images/station-wave.svg":"https://open.scdn.co/cdn/images/station-wave.2b7b882c.svg","images/sw_saber_ahsoka1.png":"https://open.scdn.co/cdn/images/sw_saber_ahsoka1.5495e812.png","images/sw_saber_anakin.png":"https://open.scdn.co/cdn/images/sw_saber_anakin.a7ba22d2.png","images/sw_saber_leia.png":"https://open.scdn.co/cdn/images/sw_saber_leia.1146243b.png","images/sw_saber_luke.png":"https://open.scdn.co/cdn/images/sw_saber_luke.e4e10033.png","images/sw_saber_mace.png":"https://open.scdn.co/cdn/images/sw_saber_mace.1ba83c7d.png","images/sw_saber_rey.png":"https://open.scdn.co/cdn/images/sw_saber_rey.994789b5.png","images/sw_saber_vader.png":"https://open.scdn.co/cdn/images/sw_saber_vader.070f862b.png","images/touch-icon-114.png":"https://open.scdn.co/cdn/images/touch-icon-114.0d424df2.png","images/touch-icon-144.png":"https://open.scdn.co/cdn/images/touch-icon-144.36faaf96.png","images/touch-icon-57.png":"https://open.scdn.co/cdn/images/touch-icon-57.5460f415.png","images/touch-icon-72.png":"https://open.scdn.co/cdn/images/touch-icon-72.cffecbdb.png","images/tracklist-placeholder.png":"https://open.scdn.co/cdn/images/tracklist-placeholder.59aa68d8.png","images/tracklist-row-episode-fallback.svg":"https://open.scdn.co/cdn/images/tracklist-row-episode-fallback.e8ae3577.svg","images/tracklist-row-song-fallback.svg":"https://open.scdn.co/cdn/images/tracklist-row-song-fallback.4db3ccfe.svg","images/tracklist-row-video-fallback.svg":"https://open.scdn.co/cdn/images/tracklist-row-video-fallback.954459da.svg","images/universal.png":"https://open.scdn.co/cdn/images/universal.3ceb95fd.png","images/vinyl-bottom-layer.svg":"https://open.scdn.co/cdn/images/vinyl-bottom-layer.82d9f6ef.svg","images/vinyl-top-layer.svg":"https://open.scdn.co/cdn/images/vinyl-top-layer.b56c3ccf.svg","images/warner.png":"https://open.scdn.co/cdn/images/warner.a5039776.png","images/zara-larsson-singles.png":"https://open.scdn.co/cdn/images/zara-larsson-singles.59dbba9e.png","js/fb.js":"https://open.scdn.co/cdn/js/fb.83cf1e53.js","js/gtag.js":"https://open.scdn.co/cdn/js/gtag.343176db.js","js/gtm.js":"https://open.scdn.co/cdn/js/gtm.6d498f08.js","js/retargeting-pixels.js":"https://open.scdn.co/cdn/js/retargeting-pixels.1fa1ceda.js","js/urlRedirect.js":"https://open.scdn.co/cdn/js/urlRedirect.156df566.js","js/urlScheme.js":"https://open.scdn.co/cdn/js/urlScheme.f1e6e8b6.js"}';try{t=JSON.parse(n)}catch(r){throw new Error("Invalid CDN_FILE_URLS environment variable.")}if(!t[e])throw new Error("`".concat(e,"` is not available in CDN_FILE_URLS."));return t[e]}function Uo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var Mo=function(e){switch(e){case"facebook":return"url('".concat(No("images/embed/fb_colour.svg"),"')");case"messenger":return"url('".concat(No("images/embed/messenger_colour.svg"),"')");case"twitter":return"url('".concat(No("images/embed/twitter_colour.svg"),"')");case"whatsapp":return"url('".concat(No("images/embed/whatsapp.svg"),"')");case"link":return"url('".concat(No("images/embed/copy-32_circle_grey_outline_bg.svg"),"')");case"embed":return"url('".concat(No("images/embed/embed-code-32_circle_grey_outline_bg.svg"),"')");default:return"transparent"}},Bo=(0,d.zo)("div",{position:"relative",height:"100%",textAlign:"center"}),xo=(0,d.zo)("div",{fontSize:"14px",fontWeight:L,lineHeight:"16px",marginTop:"2px"}),Fo=(0,d.zo)("div",{display:"inline-flex",width:"100%",maxWidth:"220px",justifyContent:"space-around",whiteSpace:"nowrap",margin:"12px auto 0 auto"}),jo=(0,d.zo)("button",(function(e){var t=e.$icon;return{backgroundImage:Mo(t),backgroundColor:"transparent",backgroundRepeat:"no-repeat",width:"25px",height:"25px",border:"0",cursor:"pointer",outline:"none",display:"inline-block"}})),Yo=function(e){v()(n,e);var t=Uo(n);function n(){var e;h()(this,n);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return e=t.call.apply(t,[this].concat(s)),i()(m()(e),"handleShareOnFacebook",(function(){Ao(e.props.url)})),i()(m()(e),"handleShareOnMessenger",(function(){Oo(e.props.url)})),i()(m()(e),"handleShareOnTwitter",(function(){ko(e.props.url)})),i()(m()(e),"handleShareOnWhatsApp",(function(){Lo(e.props.url)})),i()(m()(e),"handleCopyURL",(function(){wo(e.props.url),e.props.copyURL(e.props.url)})),i()(m()(e),"handleCopyEmbedCode",(function(){Do(e.props.uri),e.props.copyEmbedCode(e.props.uri)})),e}return f()(n,[{key:"render",value:function(){var e=this.props.onClose;return o().createElement(Po,{onClose:e},o().createElement(Bo,null,o().createElement(xo,null,ls.get("embed_share")),o().createElement(Fo,null,o().createElement(jo,{title:ls.get("embed_share_facebook"),$icon:"facebook",onClick:this.handleShareOnFacebook}),o().createElement(jo,{title:ls.get("embed_share_messenger"),$icon:"messenger",onClick:this.handleShareOnMessenger}),o().createElement(jo,{title:ls.get("embed_share_twitter"),$icon:"twitter",onClick:this.handleShareOnTwitter}),o().createElement(jo,{title:ls.get("embed_share_whatsapp"),$icon:"whatsapp",onClick:this.handleShareOnWhatsApp}),o().createElement(jo,{title:ls.get("embed_share_link"),$icon:"link",onClick:this.handleCopyURL}),o().createElement(jo,{title:ls.get("embed_share_embed"),$icon:"embed",onClick:this.handleCopyEmbedCode}))))}}]),n}(o().PureComponent);function Ko(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}i()(Yo,"defaultProps",{isVisible:!1});var Ho=(0,d.zo)("div",{position:"relative",display:"flex",height:"100%",justifyContent:"center",alignItems:"center"}),Vo=(0,d.zo)("div",{fontSize:"14px",fontWeight:L,lineHeight:"16px",margin:"auto",textAlign:"center"}),Go=function(e){v()(n,e);var t=Ko(n);function n(){return h()(this,n),t.apply(this,arguments)}return f()(n,[{key:"render",value:function(){var e=this.props.onClose;return o().createElement(Po,{onClose:e},o().createElement(Ho,null,o().createElement(Vo,null,ls.get("embed_success_share_link"))))}}]),n}(o().PureComponent);function Wo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wo(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var zo="SHARE",$o="COPY_CONFIRMATION",Qo={visible:!1,view:void 0},Xo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qo,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Eo.SHOW_SHARE:return qo(qo({},e),{},{visible:!0,view:zo});case Eo.COPY_URL:case Eo.COPY_EMBED_CODE:return qo(qo({},e),{},{visible:!0,view:$o});case Eo.HIDE_SHARE:return qo({},Qo);default:return e}};function Jo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var Zo=function(e){v()(n,e);var t=Jo(n);function n(){return h()(this,n),t.apply(this,arguments)}return f()(n,[{key:"render",value:function(){return this.props.viewType===$o?o().createElement(Go,this.props):o().createElement(Yo,this.props)}}]),n}(o().PureComponent),ea=(0,l.$j)((function(e){var t=F(e).uri;return{uri:t,url:N(t),viewType:bo(e)}}),(function(e){return{copyURL:function(t){return e({type:vo.COPY_URL})},copyEmbedCode:function(t){return e({type:vo.COPY_EMBED_CODE})},onClose:function(){return e({type:vo.HIDE_SHARE})}}}))(Zo),ta=function(e){return e.modal.visible},na=function(e){return ta(e)&&!G(e)},ra=function(e){return ta(e)&&G(e)},ia=function(e){return e.modal.type},sa=function(e){var t=e.session;return!(!t.accessToken||t.isAnonymous)},oa="MOBILE",aa="DESKTOP",ca=function(e){return e.platform.isMobile?oa:aa};function la(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var ua=(0,d.zo)("button",(function(e){var t=e.$small,n=e.$primary;return{display:"inline-block",boxSizing:"border-box",border:0,cursor:"pointer",outline:"none",textAlign:"center",background:t||!n?"transparent":C.ekl,padding:t||!n?0:"12px 40px",borderRadius:t||!n?"":"20px",color:t&&n?C.ekl:C.ixZ}})),da=(0,d.zo)("span",(function(e){var t=e.$small;return{position:"relative",lineHeight:"16px",fontWeight:L,textTransform:"uppercase",whiteSpace:"nowrap",fontSize:t?"10px":"12px",letterSpacing:t?"2px":"1.7px",marginRight:t?"-2px":"-3px",fontFamily:k}})),pa=function(e){v()(n,e);var t=la(n);function n(){return h()(this,n),t.apply(this,arguments)}return f()(n,[{key:"render",value:function(){var e=this.props,t=e.small,n=e.primary,r=e.onClick,i=e.children;return o().createElement(ua,{$small:t,$primary:n,onClick:r},o().createElement(da,{$small:t},i))}}]),n}(o().PureComponent);function ha(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var _a=(0,d.zo)("div",(function(e){var t=e.$small;return{display:"flex",height:"100%",width:t?"100%":"75%",margin:"0 auto",justifyContent:t?"space-around":"center",flexDirection:"column",boxSizing:"border-box"}})),fa=(0,d.zo)("div",(function(e){var t=e.$small;return{fontWeight:L,textAlign:"center",fontSize:t?"14px":"20px",lineHeight:t?"16px":"24px"}})),ga=(0,d.zo)("ul",(function(e){return{margin:e.$small?0:"10px 0 0",textAlign:"center",listStyleType:"none",padding:0}})),ma=(0,d.zo)("li",(function(e){var t=e.$small;return{display:t?"inline-block":"",margin:t?"0 10px":"16px 0 0"}})),ya=function(e){v()(n,e);var t=ha(n);function n(){return h()(this,n),t.apply(this,arguments)}return f()(n,[{key:"render",value:function(){var e=this.props,t=e.header,n=e.buttons,r=e.onClose,i=e.small,s=void 0!==i&&i;return o().createElement(Po,{onClose:r,small:s},o().createElement(_a,{$small:s},o().createElement(fa,{$small:s},t),o().createElement(ga,{$small:s},n.map((function(e,t){var n=e.label,r=e.onClick,i=e.primary;return o().createElement(ma,{key:"modal-button-".concat(t),$small:s},o().createElement(pa,{onClick:r,primary:i,small:s},n))})))))}}]),n}(o().PureComponent);function va(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var Ea,Sa=(0,d.zo)("span",{whiteSpace:"nowrap"}),ba=function(e){v()(n,e);var t=va(n);function n(){return h()(this,n),t.apply(this,arguments)}return f()(n,[{key:"render",value:function(){var e={line_break:"<br />",begin_highlight:'<span style="color: '.concat(C.ekl,'">'),end_highlight:"</span>"},t="";switch(this.props.resourceType){case"track":t=ls.get("embed_listen_to_full_track",e);break;case"album":t=ls.get("embed_listen_to_full_album",e);break;case"playlist":t=ls.get("embed_listen_to_full_playlist",e);break;case"artist":t=ls.get("embed_listen_to_full_artist",e);break;case"show":t=ls.get("embed_listen_to_full_show",e);break;case"episode":t=ls.get("embed_listen_to_full_episode",e)}return o().createElement(Sa,{dangerouslySetInnerHTML:{__html:t}})}}]),n}(o().PureComponent),Ta=function(e){return e.modalType===Mi?e.isEpisodeAvailableInCountry?ls.get("embed_episode_preview_not_available"):ls.get("embed_track_not_available"):e.preferredPlatform===oa?ls.get("upsell_track_message"):o().createElement(ba,{resourceType:e.resourceType})},Ca=function(e,t,n){return{label:e,onClick:t,primary:n}},Ia=function(e){var t=e.stateProps,n=e.dispatchProps;return t.preferredPlatform===oa?[Ca(ls.get("get_spotify"),n.getInSpotifyApp,!0),Ca(ls.get("play_on_spotify"),n.playInSpotifyApp)]:[Ca(ls.get("play_on_spotify"),n.playInSpotifyApp,!0),!t.isLoggedIn&&Ca(ls.get("embed_login"),n.clickLogin)].filter(Boolean)},Ra={hideModal:function(){return{type:Fi.HIDE_MODAL}},clickLogin:function(){return function(e,t){var n,r=(n=F(t()).uri,"https://accounts.spotify.com/login?utm_source=".concat(w,"&utm_medium=&utm_campaign=&continue=").concat(encodeURIComponent(N(n))));window.open(r,"_blank"),e({type:Fi.CLICK_LOGIN})}},clickSignup:function(){return function(e,t){var n,r=(n=F(t()).uri,"https://www.spotify.com/signup/?creation_flow=embed&utm_source=".concat(w,"&utm_medium=&utm_campaign=&forward_url=").concat(encodeURIComponent(N(n))));window.open(r,"_blank"),e({type:Fi.CLICK_SIGNUP})}},getInSpotifyApp:function(){return function(e,t){var n=t(),r=n.platform.isMobile?"_top":"_blank";window.open(function(e){return U(e,"fallback=getapp&signupPrompt=1")}(n),r),e({type:qi.GET_IN_APP})}},playInSpotifyApp:function(){return function(e,t){var n=t();e(es());var r=n.platform.isMobile?"_top":"_blank";window.open(U(n),r),e({type:qi.PLAY_IN_APP})}}},Pa=(0,l.$j)((function(e){return{modalType:ia(e),preferredPlatform:ca(e),isLoggedIn:sa(e),isEpisodeAvailableInCountry:wi(e),resourceType:j(e)}}),Ra,(function(e,t,n){return{small:"top"===n.area,onClose:t.hideModal,header:Ta(e),buttons:Ia({stateProps:e,dispatchProps:t})}}))(ya),Aa=(0,d.zo)("div",(Ea={},i()(Ea,R,{height:"18px",width:"18px"}),i()(Ea,P,{height:"25px",width:"25px"}),Ea)),Oa={filter:"drop-shadow(0 0 2px rgba(0, 0, 0, 0.2))"},ka=function(){return o().createElement(Aa,null,o().createElement("svg",{viewBox:"0 0 64 64",style:Oa},o().createElement("title",null,"Spotify Logo"),o().createElement("path",{fill:C.ixZ,d:"M50.9288482,28.3686995 C40.6139223,22.2429099 23.5996824,21.6796628 13.7528525,24.668235 C12.1712611,25.1477974 10.4991074,24.2551616 10.020312,22.674325 C9.54075242,21.0919599 10.4326187,19.4209426 12.0153564,18.9402338 C23.3188247,15.5091649 42.1091547,16.1717636 53.9838913,23.2207587 C55.4065211,24.0648651 55.8727065,25.9021053 55.0297516,27.3220687 C54.1860323,28.7439428 52.3476568,29.213188 50.9288482,28.3686995 M50.5910548,37.4417921 C49.8677032,38.6160515 48.3323482,38.9840345 47.1592422,38.2633534 C38.5600315,32.9774668 25.4464645,31.4459238 15.2725406,34.5342297 C13.953465,34.9331646 12.5598763,34.1887919 12.1594154,32.8720012 C11.7616293,31.5529179 12.5056154,30.1616135 13.8227803,29.7607681 C25.4453181,26.2337867 39.8932454,27.9418698 49.7702628,34.0118696 C50.9429866,34.7340793 51.3121138,36.2702077 50.5910548,37.4417921 M46.6754793,46.1553085 C46.1003899,47.0983843 44.8726409,47.3937643 43.9330097,46.8190535 C36.4186355,42.2263353 26.9604208,41.1892576 15.8216459,43.7334225 C14.748273,43.9798909 13.6787213,43.3069749 13.4337829,42.2335956 C13.1876981,41.1605985 13.8579352,40.0906583 14.9336008,39.8457184 C27.1232036,37.0589064 37.5791315,38.2583858 46.0140309,43.4124404 C46.9544263,43.986769 47.2505687,45.2152896 46.6754793,46.1553085 M31.9998089,0 C14.3271776,0 0,14.3268811 0,31.9996179 C0,49.6742653 14.3271776,64 31.9998089,64 C49.6732045,64 64,49.6742653 64,31.9996179 C64,14.3268811 49.6732045,0 31.9998089,0"})))},La=(0,d.zo)((function(){return o().createElement("svg",{viewBox:"0 0 16 16",style:{filter:O}},o().createElement("path",{fill:"white",d:"M11.6,9.81c-0.831,0-1.561,0.409-2.016,1.033L4.906,8.142C4.961,7.936,5,7.723,5,7.499c0-0.232-0.042-0.452-0.101-0.665 l4.67-2.696c0.454,0.635,1.192,1.052,2.031,1.052c1.381,0,2.5-1.119,2.5-2.5c0-1.38-1.119-2.5-2.5-2.5c-1.381,0-2.5,1.12-2.5,2.5 c0,0.182,0.022,0.359,0.059,0.53L4.442,5.943C3.984,5.372,3.289,4.999,2.5,4.999c-1.381,0-2.5,1.12-2.5,2.5C0,8.88,1.119,10,2.5,10 c0.798,0,1.5-0.38,1.957-0.962l4.706,2.717l0.007-0.012C9.128,11.926,9.1,12.114,9.1,12.31c0,1.381,1.119,2.5,2.5,2.5 c1.381,0,2.5-1.119,2.5-2.5C14.1,10.929,12.981,9.81,11.6,9.81z M11.6,1.189c0.827,0,1.5,0.673,1.5,1.5c0,0.827-0.673,1.5-1.5,1.5 c-0.827,0-1.5-0.673-1.5-1.5C10.1,1.862,10.773,1.189,11.6,1.189z M2.5,9C1.673,9,1,8.327,1,7.499c0-0.827,0.673-1.5,1.5-1.5 S4,6.672,4,7.499C4,8.327,3.327,9,2.5,9z M11.6,13.81c-0.827,0-1.5-0.673-1.5-1.5c0-0.827,0.673-1.5,1.5-1.5 c0.827,0,1.5,0.673,1.5,1.5C13.1,13.137,12.427,13.81,11.6,13.81z"}))}),{width:"100%",height:"100%"});function wa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var Da=function(e){v()(n,e);var t=wa(n);function n(){return h()(this,n),t.apply(this,arguments)}return f()(n,[{key:"render",value:function(){var e=this.props,t=e.onShare,n=e.$styleProps;return o().createElement(Zs,{onClick:t,title:ls.get("embed_share"),$styleProps:n},o().createElement(La,null))}}]),n}(o().Component),Na={CLICK_METADATA:"CLICK_METADATA"};function Ua(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var Ma,Ba=(0,d.zo)("div",{display:"flex",justifyContent:"space-between",flexDirection:"column",alignItems:"center"}),xa={width:"16px",height:"16px",padding:"10px",boxSizing:"content-box"},Fa=(0,d.zo)("div",{display:"flex"}),ja=function(e){v()(n,e);var t=Ua(n);function n(){return h()(this,n),t.apply(this,arguments)}return f()(n,[{key:"render",value:function(){var e=this.props,t=e.showShareModal,n=e.showModal,r=e.onShare,i=e.onClickLogo,s=this.props.isLegacy?yo:Is;return o().createElement(Fa,null,t&&!n&&o().createElement(ea,null),n&&o().createElement(Pa,{area:"top"}),o().createElement(s,null),o().createElement(Ba,null,o().createElement(Zs,{onClick:i,$styleProps:xa},o().createElement(ka,null)),o().createElement(Da,{onShare:r,size:32,$styleProps:xa})))}}]),n}(o().Component),Ya=(0,l.$j)((function(e){return{isLegacy:V(e),showShareModal:So(e),showModal:na(e)}}),(function(e){return{onShare:function(){return e({type:vo.SHOW_SHARE})},onClickLogo:function(){return e((function(e,t){var n=t(),r=n.platform.isMobile?"_top":"_blank";window.open(U(n),r),e({type:Na.CLICK_METADATA})}))}}}))(ja);function Ka(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var Ha=(0,d.zo)("div",{display:"flex",flexDirection:"row",position:"relative",textShadow:"0 0 2px rgba(0, 0, 0, 0.4)"}),Va=(0,d.zo)("div",(Ma={position:"relative"},i()(Ma,R,{height:"80px",width:"80px"}),i()(Ma,P,{flex:1,maxHeight:"33.3333vh",maxWidth:"33.3333vh",minHeight:"161px",minWidth:"161px"}),Ma)),Ga=(0,d.zo)("div",{position:"relative",flex:2,minWidth:"66.6666vw"}),Wa=function(e){v()(n,e);var t=Ka(n);function n(){return h()(this,n),t.apply(this,arguments)}return f()(n,[{key:"render",value:function(){var e=this.props.hasBigCoverArt;return o().createElement(Ha,null,o().createElement(Va,null,o().createElement(Cs,{noCoverArt:e})),o().createElement(Ga,null,o().createElement(Ya,null)))}}]),n}(o().Component),qa=(0,l.$j)((function(e){return{hasBigCoverArt:q(e)}}))(Wa),za=function(e){var t,n=e.volume;return t=0===n?o().createElement("path",{d:"M0,5v6h2.804L8,14V2L2.804,5H0z M7,3.732v8.536L3.072,10H1V6h2.072L7,3.732z M15.623,5.853l-0.707-0.707l-2.147,2.147 l-2.146-2.147L9.916,5.853L12.062,8l-2.146,2.146l0.707,0.707l2.146-2.147l2.147,2.147l0.707-0.707L13.477,8L15.623,5.853z"}):n<1/3?o().createElement("path",{d:"M10.699,5.18l-0.657,0.77C10.548,6.486,10.863,7.205,10.863,8s-0.316,1.514-0.822,2.051l0.657,0.769 c0.72-0.723,1.165-1.72,1.165-2.82S11.418,5.903,10.699,5.18z M0,5v6h2.804L8,14V2L2.804,5H0z M7,3.732v8.536L3.072,10H1V6h2.072 L7,3.732z"}):n<2/3?o().createElement("path",{d:"M0,5v6h2.804L8,14V2L2.804,5H0z M7,3.732v8.536L3.072,10H1V6h2.072L7,3.732z M11.863,8c0,1.403-0.585,2.668-1.519,3.577 l0.653,0.764C12.145,11.248,12.863,9.71,12.863,8c0-1.709-0.718-3.248-1.866-4.341l-0.653,0.764 C11.279,5.332,11.863,6.597,11.863,8z"}):o().createElement("path",{d:"M12.945,1.379l-0.652,0.763c1.577,1.462,2.57,3.544,2.57,5.858s-0.994,4.396-2.57,5.858l0.651,0.763 c1.79-1.645,2.919-3.998,2.919-6.621S14.735,3.024,12.945,1.379z M10.673,4.039l-0.651,0.763C10.849,5.617,11.363,6.749,11.363,8 s-0.515,2.382-1.342,3.199l0.651,0.763c1.04-1,1.691-2.404,1.691-3.961S11.713,5.039,10.673,4.039z M0,5v6h2.804L8,14V2L2.804,5H0z M7,3.732v8.536L3.072,10H1V6h2.072L7,3.732z"}),o().createElement("svg",{viewBox:"0 0 16 16"},o().createElement("title",null,"Volume"),t)};za.defaultProps={volume:1};var $a=(0,d.zo)(za,{width:"100%",height:"100%"});function Qa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var Xa="19px",Ja="".concat(38,"px"),Za="14px",ec=(0,d.zo)("tr",(function(e){var t=e.$isCurrentTrack,n=e.$isPlayable;return i()({color:t?C.By7:C.ixZ,lineHeight:Xa,cursor:"pointer",verticalAlign:"top",userSelect:"none",opacity:n?1:A},":hover",{backgroundColor:n?"rgba(255, 255, 255, 0.2)":"none"})})),tc=(0,d.zo)("td",(function(e){var t=e.$isCurrentTrack;return{color:C.ixZ,padding:"6px 8px 6px 16px",fontFeatureSettings:'"tnum"',width:"1%",minWidth:Za,opacity:t?1:A}})),nc=(0,d.zo)("td",(function(e){var t=e.$isCurrentTrack;return{color:t?C.By7:C.ixZ,textAlign:"right",padding:"6px 16px 6px 8px",fontFeatureSettings:'"tnum"',fontWeight:t?L:"unset",opacity:t?1:A,width:"1%"}})),rc=(0,d.zo)("td",{position:"relative",padding:"6px 0"}),ic=(0,d.zo)("div",(function(e){return{position:"relative",height:e.$hasSubtitle?Ja:Xa,width:"100%"}})),sc=(0,d.zo)("div",(function(e){var t=e.$isCurrentTrack;return{position:"absolute",top:0,height:Xa,width:"100%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontWeight:t?L:"unset"}})),oc=(0,d.zo)("div",{position:"absolute",top:Xa,height:Xa,width:"100%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:C.ixZ,opacity:A}),ac=(0,d.zo)("div",{position:"absolute",width:Za,height:Za,paddingTop:"2px",fill:C.By7}),cc=function(e){v()(n,e);var t=Qa(n);function n(){var e;h()(this,n);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return e=t.call.apply(t,[this].concat(s)),i()(m()(e),"handleRowClick",(function(){var t=e.props;(0,t.onTrackClick)(t.index)})),e}return f()(n,[{key:"render",value:function(){var e=this.props,t=e.number,n=e.title,r=e.subtitle,i=e.duration,s=e.isCurrentTrack,a=e.isPlayable;return o().createElement(ec,{$isCurrentTrack:s,$isPlayable:a,onClick:this.handleRowClick},o().createElement(tc,{$isCurrentTrack:s},s?o().createElement(ac,null,o().createElement($a,null)):t),o().createElement(rc,null,o().createElement(ic,{$hasSubtitle:!!r},o().createElement(sc,{$isCurrentTrack:s},o().createElement("span",{dir:"auto"},n)),r&&o().createElement(oc,null,o().createElement("span",{dir:"auto"},r)))),o().createElement(nc,{$isCurrentTrack:s},Ms(i)))}}]),n}(o().Component);function lc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}i()(cc,"defaultProps",{onTrackClick:function(){},isCurrentTrack:!1});var uc=(0,d.zo)("table",{position:"relative",borderCollapse:"collapse",width:"100%"}),dc=function(e){v()(n,e);var t=lc(n);function n(){return h()(this,n),t.apply(this,arguments)}return f()(n,[{key:"render",value:function(){var e=this.props,t=e.isLoggedIn,n=e.tracks,r=e.onTrackClick,i=e.currentTrackUri,s=e.isPlaylist;if(!n||n.length<1)return null;var a=function(e){return"episode"===e.type},c=function(e){return!(!t||!a(e))||e.is_playable},l=function(e){if(s)return a(e)?e.show.name:e.artists.map((function(e){return e.name})).join(ls.getSeparator())};return o().createElement(uc,null,o().createElement("tbody",null,n.map((function(e,t){return o().createElement(cc,{index:t,number:t+1,title:e.name,subtitle:l(e),duration:e.duration_ms,onTrackClick:r,isCurrentTrack:i===e.uri,isPlayable:c(e),key:"".concat(t,"-").concat(e.uri)})}))))}}]),n}(o().PureComponent),pc=(0,l.$j)((function(e){return{tracks:Y(e),currentTrackUri:e.playback.trackUri,isPlaylist:"playlist"===j(e),isLoggedIn:sa(e)}}),(function(e){return{onTrackClick:function(t){return e(ts(t))}}}))(dc);function hc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var _c=(0,d.zo)("div",{position:"relative",backgroundColor:"rgba(0, 0, 0, 0.4)",flex:1,overflowY:"hidden"}),fc=(0,d.zo)("div",(function(e){return{overflowY:e.$scrolling?"auto":"hidden",height:"100%"}})),gc=(0,d.zo)("div",{position:"relative",width:"100%",height:"100%",boxSizing:"border-box",padding:"8px"}),mc=function(){return o().createElement(gc,null,o().createElement(Cs,{noButton:!0,top:!0}))},yc=function(e){v()(n,e);var t=hc(n);function n(){return h()(this,n),t.apply(this,arguments)}return f()(n,[{key:"render",value:function(){var e=this.props,t=e.showModal,n=e.hasBottomSection,r=e.hasBigCoverArt;if(!n)return o().createElement(_c,null);var i=r?o().createElement(mc,null):o().createElement(pc,null),s=!r&&!t;return o().createElement(_c,null,o().createElement(fc,{$scrolling:s},i),t&&o().createElement(Pa,{area:"bottom"}))}}]),n}(o().PureComponent),vc=(0,l.$j)((function(e){return{hasBigCoverArt:q(e),hasBottomSection:G(e),showModal:ra(e)}}))(yc);function Ec(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var Sc=(0,d.zo)("div",(function(e){var t=e.$backgroundColor;return{color:C.ixZ,backgroundColor:t,fontFamily:k,position:"relative",display:"flex",flexDirection:"column",height:"100vh",fontWeight:"200",fontSize:"14px",lineHeight:"19px"}})),bc=(0,d.zo)("div",{position:"absolute",top:0,right:0,bottom:0,left:0,background:"linear-gradient(to bottom, rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.8))",display:"flex",flexDirection:"column"}),Tc=function(e){v()(n,e);var t=Ec(n);function n(){var e;h()(this,n);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return e=t.call.apply(t,[this].concat(s)),i()(m()(e),"onMouseEnter",(function(){document.removeEventListener("mouseenter",e.onMouseEnter),e.props.player.initialize()})),e}return f()(n,[{key:"componentDidMount",value:function(){this.props.onMount(),document.addEventListener("mouseenter",this.onMouseEnter)}},{key:"render",value:function(){var e=this.props.resource;return o().createElement(Sc,{$backgroundColor:e.dominantColor},o().createElement(bc,null,o().createElement(qa,null),o().createElement(vc,null)))}}]),n}(o().Component),Cc="MOUNTED",Ic={onMount:function(){return{type:Cc}}},Rc=(0,l.$j)((function(e){return{resource:F(e),player:Li(e)}}),Ic)(Tc),Pc=n(906),Ac=n(5870),Oc={},kc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Oc,t=arguments.length>1?arguments[1]:void 0;return t.type,e};function Lc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Lc(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Dc={isPlaying:!1,isPaused:!1},Nc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Dc,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case zi.PLAY:return wc(wc({},e),{},{isPlaying:!0,isPaused:!1});case zi.PAUSE:return wc(wc({},e),{},{isPlaying:!1,isPaused:!0});case zi.TRACK_CHANGE:return wc(wc({},e),{},{trackUri:t.uri});case zi.RESET:return Dc;default:return e}},Uc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case zi.PROGRESS_UPDATE:return t.progress||0;case zi.TRACK_CHANGE:return 0;default:return e}},Mc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e},Bc=Ii("enableLogin")?{accessToken:Ii("accessToken"),accessTokenExpirationTimestampMs:Ii("accessTokenExpirationTimestampMs"),loggedIn:!Ii("isAnonymous"),premiumOnlyMarket:Ii("premiumOnlyMarket")}:{},xc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Bc;return e},Fc={RESIZE_VIEWPORT:"RESIZE_VIEWPORT"},jc=Fc;function Yc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Kc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yc(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Hc={width:window.innerWidth,height:window.innerHeight},Vc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Hc,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case jc.RESIZE_VIEWPORT:return Kc(Kc({},e),{},{width:t.width,height:t.height});default:return e}},Gc={SET_PLAYBACK_TO_PREVIEW:"SET_PLAYBACK_TO_PREVIEW"},Wc=Gc;function qc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qc(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $c={isMobile:Ii("isMobile"),isSafari:navigator.vendor.toLowerCase().indexOf("apple")>=0,hasSpotifyMobile:Ii("isSpotified"),forcePreview:!1},Qc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$c,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case Wc.SET_PLAYBACK_TO_PREVIEW:return zc(zc({},e),{},{forcePreview:!0});default:return e}},Xc=n(310),Jc=n(1995),Zc=n(4430),el=n(7496),tl=null;function nl(){if(null===tl)throw new Error("Missing `instance`. Have you called `setEventSenderInstance` yet?");return tl}function rl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function il(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rl(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var sl,ol,al=!1,cl=function(e){al=e},ll=n(5983),ul=n(5458),dl=function(){return"undefined"==typeof window||void 0===window.gtag||void 0===window.google_tag_manager},pl=function(e,t,n){return function(e,t,n){dl()||window.gtag("event",t,{event_category:e,event_label:n})}(e,t,n)},hl=[zi.PROGRESS_UPDATE],_l=function(e){return function(t){return function(n){var r=e.getState().resource;if(!r)return t(n);var i,s=r.toString(),o=s.split(":"),a=te()(o,2)[1];return n.type===Cc?(i={page:a,type:"enter",view_uri:s,referrer:document.referrer},nl().send(al?(0,Zc.t)(i):(0,Xc.v)(il({sp_cid:Ci("config",{}).correlationId},i)))):-1===hl.indexOf(n.type)&&(pl("action",n.type),function(e){nl().send(al?(0,el.w)(e):(0,Jc.p)(il({sp_cid:Ci("config",{}).correlationId},e)))}({page:a,action_type:String(n.type).toLowerCase(),view_uri:s})),t(n)}}},fl=n(3854),gl=n.n(fl),ml=(n(6446),n(2046)),yl=n(1504),vl=n.n(yl),El=n(7135),Sl=n.n(El);n(938);function bl(e){return Tl.apply(this,arguments)}function Tl(){return(Tl=vl()(Sl().mark((function e(t){return Sl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(sl){e.next=2;break}throw new Error("Invalid call to sendMetric before initSemanticMetrics.");case 2:return e.abrupt("return",sl(t));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Cl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Il(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cl(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Rl=function(){function e(){h()(this,e),i()(this,"_accessToken",void 0),i()(this,"_market",void 0),i()(this,"_headers",void 0),i()(this,"_globalRequestHeaders",void 0),i()(this,"_shouldSendMarket",void 0),i()(this,"_shouldSendGlobalHeaders",void 0),i()(this,"_locale",void 0),i()(this,"_shouldSendLocale",void 0),i()(this,"_shouldSendAuthorization",void 0),i()(this,"_host",void 0),i()(this,"path",void 0),i()(this,"responseType",void 0),i()(this,"queryParameters",void 0),i()(this,"_method",void 0),i()(this,"jsonContentType",void 0),i()(this,"body",void 0),i()(this,"_endpointIdentifier",void 0),i()(this,"_startTimestamp",void 0),i()(this,"_includeCredentials",void 0),this._accessToken=null,this._market="",this._headers=[],this._globalRequestHeaders=[],this._shouldSendMarket=!0,this._shouldSendGlobalHeaders=!0,this._locale=null,this._shouldSendLocale=!1,this._shouldSendAuthorization=!0,this._host="",this.path="",this.responseType="json",this.queryParameters=void 0,this._method="GET",this.jsonContentType=!1,this.body=null,this._endpointIdentifier=null,this._startTimestamp=null,this._includeCredentials=!1}var t;return f()(e,[{key:"getRequestImplementation",value:function(){return ol}},{key:"accessToken",set:function(e){this._accessToken=e}},{key:"market",get:function(){return this._market},set:function(e){this._market=e}},{key:"locale",get:function(){return this._locale},set:function(e){this._locale=e}},{key:"globalRequestHeaders",get:function(){return this._globalRequestHeaders},set:function(e){this._globalRequestHeaders=e}},{key:"startTimestamp",get:function(){return this._startTimestamp}},{key:"host",get:function(){return this._host}},{key:"method",get:function(){return this._method}},{key:"endpointIdentifier",get:function(){return this._endpointIdentifier}},{key:"withHost",value:function(e){return this._host=e,this}},{key:"withPath",value:function(e){return this.path=e,this}},{key:"withResponseType",value:function(e){return this.responseType=e,this}},{key:"withEndpointIdentifier",value:function(e){return this._endpointIdentifier=e,this}},{key:"withQueryParameters",value:function(e){return this.queryParameters=e,this}},{key:"withBody",value:function(e){return this.body=e,this}},{key:"withMethod",value:function(e){return this._method=e,this}},{key:"withoutMarket",value:function(){return this._shouldSendMarket=!1,this}},{key:"withoutGlobalHeaders",value:function(){return this._shouldSendGlobalHeaders=!1,this}},{key:"withoutAuthorization",value:function(){return this._shouldSendAuthorization=!1,this}},{key:"withLocale",value:function(e){return this._shouldSendLocale=!0,e&&(this._locale=e),this}},{key:"withJsonContentType",value:function(){return this.jsonContentType=!0,this}},{key:"withHeaders",value:function(e){return this._headers=e,this}},{key:"withCredentials",value:function(){return this._includeCredentials=!0,this}},{key:"onBeforeSend",value:function(e){}},{key:"onAfterSend",value:function(e){}},{key:"send",value:(t=vl()(Sl().mark((function e(){var t,n,r,i=this;return Sl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=new ol(this.method,"".concat(this._host).concat(this.path),this._shouldSendAuthorization),this._shouldSendMarket&&this.market&&(this.queryParameters=Il(Il({},this.queryParameters),{},{market:this.market})),this._shouldSendLocale&&this.locale&&(this.queryParameters=Il(Il({},this.queryParameters),{},{locale:this.locale})),this.locale&&t.addHeader("Accept-Language",this.locale),t.withQueryParameters(this.queryParameters),t.withResponseType(this.responseType),this._shouldSendAuthorization&&this._accessToken&&t.addHeader("Authorization","Bearer ".concat(this._accessToken)),t.addHeader("Accept","application/json"),this._includeCredentials&&t.includeCredentials(),this._shouldSendGlobalHeaders&&this._globalRequestHeaders.length>0&&this._globalRequestHeaders.forEach((function(e){var n=te()(e,2),r=n[0],i=n[1];t.addHeader(r,i)})),n=0;n<this._headers.length;n++)r=this._headers[n],t.addHeader(r.key,r.value);this.jsonContentType&&t.addHeader("Content-Type","application/json;charset=UTF-8"),this.body&&t.withPostData(this.body),e.prev=13,this.onBeforeSend(t),e.next=20;break;case 17:return e.prev=17,e.t0=e.catch(13),e.abrupt("return",Promise.reject(e.t0));case 20:return this._startTimestamp=Date.now(),e.abrupt("return",t.send().then((function(e){return i.onAfterSend(),e})).catch((function(e){throw i.onAfterSend(e),e})));case 22:case"end":return e.stop()}}),e,this,[[13,17]])}))),function(){return t.apply(this,arguments)})}],[{key:"setRequestImplementation",value:function(e){ol=e}}]),e}(),Pl=(n(684),function(){function e(t,n,r){return h()(this,e),i()(this,"method",void 0),i()(this,"url",void 0),i()(this,"postData",void 0),i()(this,"queryParameters",void 0),i()(this,"responseType",void 0),i()(this,"_headers",void 0),i()(this,"_authorize",void 0),i()(this,"_includeCredentials",void 0),this.method=t,this.url=n,this.postData=null,this.queryParameters=void 0,this.responseType="json",this._headers={},this._authorize=r,this._includeCredentials=!1,this}var t;return f()(e,[{key:"withQueryParameters",value:function(e){this.queryParameters=e}},{key:"withPostData",value:function(e){this.postData=e}},{key:"withResponseType",value:function(e){this.responseType=e}},{key:"addHeader",value:function(e,t){return this._headers[e]=t,this}},{key:"includeCredentials",value:function(){return this._includeCredentials=!0,this}},{key:"send",value:(t=vl()(Sl().mark((function e(){var t,n,r,i,s;return Sl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=li(),n=new URLSearchParams(this.queryParameters).toString(),r="".concat(this.url).concat(n?"?".concat(n):""),i={method:this.method,responseType:this.responseType,headers:this._headers,authorize:this._authorize,rejectNotOk:!0},this._includeCredentials&&(i.credentials="include"),this.postData&&(null!==(s=this._headers["Content-Type"])&&void 0!==s&&s.startsWith("application/json;charset=UTF-8")?i.payload=JSON.stringify(this.postData):i.payload=this.postData),e.abrupt("return",t.request(r,i).then((function(e){return e})).catch((function(e){throw e})));case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}());function Al(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}function Ol(e){return"".concat(e.method,"::").concat(e.host).concat(e.path,"::").concat(JSON.stringify(e.queryParameters))}function kl(e,t,n){try{bl({metric_type:ml.MetricTypes.COUNTER,what:"request-rate",value:1,tags:{endpoint:e,statusCode:t,isFatal:n}}).catch((function(){return{}}))}catch(r){}}var Ll=function(e){v()(n,e);var t=Al(n);function n(e){var r;return h()(this,n),r=t.call(this,e),i()(m()(r),"pendingRequests",void 0),r.pendingRequests=new Set,r}return f()(n,[{key:"resetPendingRequests",value:function(){this.pendingRequests=new Set}},{key:"build",value:function(){var e,t=this,r=gl()(T()(n.prototype),"build",this).call(this);return r.onBeforeSend=function(){if(e=Ol(r),t.pendingRequests.has(e)){var n=new Error("DUPLICATE_REQUEST_ERROR: Already sent this request (".concat(e,")"));throw n.name="DUPLICATE_REQUEST_ERROR",n}"GET"===r.method.toUpperCase()&&t.pendingRequests.add(e)},r.onAfterSend=function(n){e=Ol(r);var i="unknown",s=!1;if(null!==r.endpointIdentifier&&(s=!0,i="".concat(r.method," ").concat(r.host||window.location.origin,"::").concat(r.endpointIdentifier)),n)throw s&&kl(i,JSON.stringify(n.status||0),JSON.stringify(0===(r.endpointIdentifier||"").indexOf("/me"))),t.pendingRequests.delete(e),new Error("Request responsed with ".concat(n.status));if(s){kl(i,"200","false");var o=Date.now()-(r.startTimestamp||0);!function(e,t,n){try{bl({metric_type:ml.MetricTypes.TIMER,what:"request-duration",value:n,tags:{endpoint:e,statusCode:t}}).catch((function(){return{}}))}catch(r){}}(i,"200",ml.Time.fromMillis(o).asNanos())}t.pendingRequests.delete(e)},r}}]),n}(function(){function e(t){h()(this,e),i()(this,"_accessToken",void 0),i()(this,"_market",void 0),i()(this,"_locale",void 0),i()(this,"_globalRequestHeaders",void 0),i()(this,"_RequestImplementation",void 0),this._accessToken=null,this._market="",this._locale="",this._globalRequestHeaders=[],this._RequestImplementation=t||Pl}return f()(e,[{key:"accessToken",get:function(){return this._accessToken},set:function(e){this._accessToken=e}},{key:"globalRequestHeaders",get:function(){return this._globalRequestHeaders},set:function(e){this._globalRequestHeaders=e}},{key:"market",get:function(){return this._market},set:function(e){this._market=e}},{key:"locale",get:function(){return this._locale},set:function(e){this._locale=e}},{key:"resetPendingRequests",value:function(){}},{key:"build",value:function(){Rl.setRequestImplementation(this._RequestImplementation);var e=new Rl;return e.accessToken=this._accessToken,e.market=this.market,e.locale=this.locale,e.globalRequestHeaders=this.globalRequestHeaders,e}}]),e}()),wl=n(2403),Dl=n(7885),Nl=n.n(Dl),Ul=n(473),Ml=n.n(Ul);function Bl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var xl=function(e){v()(n,e);var t=Bl(n);function n(e){var r;h()(this,n);var s=e.message,o=e.url,a=e.method,c=e.status;return r=t.call(this,s),i()(m()(r),"name",void 0),i()(m()(r),"requestUrl",void 0),i()(m()(r),"requestMethod",void 0),i()(m()(r),"status",void 0),r.name="HttpError",r.requestUrl=o,r.requestMethod=a,r.status=c,r}return f()(n,null,[{key:"fromResponse",value:function(e,t){return new n({message:e.statusText,url:e.url,method:t,status:e.status})}}]),n}(le()(Error)),Fl=function(e){v()(n,e);var t=Bl(n);function n(e){var r;h()(this,n);var s=e.timeout,o=e.url,a=e.method;return r=t.call(this,{message:"".concat(a.toUpperCase()," ").concat(o," timed out (").concat(s,"ms)"),url:o,method:a,status:503}),i()(m()(r),"name",void 0),i()(m()(r),"timeout",void 0),r.name="RequestTimeoutError",r.timeout=s,r}return n}(xl);function jl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jl(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Kl=Nl()(wl.fetch);function Hl(e){return e&&void 0!==e.retries&&e.retries>0?Kl:wl.fetch}function Vl(e,t){return Gl.apply(this,arguments)}function Gl(){return(Gl=vl()(Sl().mark((function e(t,n){var r,i,s,o,a,c=arguments;return Sl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.length>2&&void 0!==c[2]?c[2]:1e4,i=new(Ml()),s=i.signal,o=setTimeout((function(){return i.abort()}),r),a=Hl(n),e.abrupt("return",a(t,Yl(Yl({},n),{},{signal:s})).then((function(e){return clearTimeout(o),e})).catch((function(e){var i;if("AbortError"===e.name)throw new Fl({timeout:r,url:t,method:null!==(i=null==n?void 0:n.method)&&void 0!==i?i:"get"});throw clearTimeout(o),e})));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Wl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ql(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wl(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var zl=function(){function e(t,n){return h()(this,e),i()(this,"method",void 0),i()(this,"url",void 0),i()(this,"postData",void 0),i()(this,"queryParameters",void 0),i()(this,"responseType",void 0),i()(this,"_headers",void 0),i()(this,"_includeCredentials",void 0),this.method=t,this.url=n,this.postData=null,this.queryParameters=void 0,this.responseType="json",this._headers={},this._includeCredentials=!1,this}var t;return f()(e,[{key:"withQueryParameters",value:function(e){this.queryParameters=e}},{key:"withResponseType",value:function(e){this.responseType=e}},{key:"withPostData",value:function(e){this.postData=e}},{key:"addHeader",value:function(e,t){return this._headers[e]=t,this}},{key:"includeCredentials",value:function(){return this._includeCredentials=!0,this}},{key:"send",value:(t=vl()(Sl().mark((function e(){var t,n,r,i=this;return Sl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.postData&&(t=null!==(n=this._headers["Content-Type"])&&void 0!==n&&n.startsWith("application/json;charset=UTF-8")?JSON.stringify(this.postData):this.postData),r=new URLSearchParams(this.queryParameters).toString(),e.abrupt("return",Vl("".concat(this.url).concat(r?"?".concat(r):""),{method:this.method,body:t,credentials:this._includeCredentials?"include":void 0,headers:ql({"User-Agent":{NODE_ENV:"production",DEBUG_EVENT_SENDER:!1,DEBUG_SEMANTIC_METRICS:void 0,CDN_FILE_URLS:'{"fonts/CircularSpUIAraOnly-Black.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Black.6d6a4c25.otf","fonts/CircularSpUIAraOnly-Black.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Black.05b31ded.woff","fonts/CircularSpUIAraOnly-Black.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Black.c32951f4.woff2","fonts/CircularSpUIAraOnly-Bold.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Bold.f97cb921.otf","fonts/CircularSpUIAraOnly-Bold.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Bold.9ddc7126.woff","fonts/CircularSpUIAraOnly-Bold.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Bold.317e96e5.woff2","fonts/CircularSpUIAraOnly-Book.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Book.f0effcd1.otf","fonts/CircularSpUIAraOnly-Book.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Book.3ad862e2.woff","fonts/CircularSpUIAraOnly-Book.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Book.aaab109b.woff2","fonts/CircularSpUIAraOnly-Light.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Light.f0833f3b.otf","fonts/CircularSpUIAraOnly-Light.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Light.5c7ed8d8.woff","fonts/CircularSpUIAraOnly-Light.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Light.dde45e52.woff2","fonts/CircularSpUICyrOnly-Black.otf":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Black.50cd1ca9.otf","fonts/CircularSpUICyrOnly-Black.woff":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Black.7536a73f.woff","fonts/CircularSpUICyrOnly-Black.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Black.f5526fc4.woff2","fonts/CircularSpUICyrOnly-Bold.otf":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Bold.67641b90.otf","fonts/CircularSpUICyrOnly-Bold.woff":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Bold.909126fc.woff","fonts/CircularSpUICyrOnly-Bold.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Bold.30dc9fb2.woff2","fonts/CircularSpUICyrOnly-Book.otf":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Book.15af6ebe.otf","fonts/CircularSpUICyrOnly-Book.woff":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Book.918c53b8.woff","fonts/CircularSpUICyrOnly-Book.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Book.6a858994.woff2","fonts/CircularSpUICyrOnly-Light.otf":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Light.b10eb959.otf","fonts/CircularSpUICyrOnly-Light.woff":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Light.034997d0.woff","fonts/CircularSpUICyrOnly-Light.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Light.55fa9f4a.woff2","fonts/CircularSpUIHbrOnly-Black.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Black.11abebe4.otf","fonts/CircularSpUIHbrOnly-Black.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Black.0a11e734.woff","fonts/CircularSpUIHbrOnly-Black.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Black.217fb21f.woff2","fonts/CircularSpUIHbrOnly-Bold.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Bold.57b36278.otf","fonts/CircularSpUIHbrOnly-Bold.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Bold.9f406804.woff","fonts/CircularSpUIHbrOnly-Bold.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Bold.ef043f44.woff2","fonts/CircularSpUIHbrOnly-Book.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Book.fae4aece.otf","fonts/CircularSpUIHbrOnly-Book.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Book.ad2b13cd.woff","fonts/CircularSpUIHbrOnly-Book.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Book.cb36b6ec.woff2","fonts/CircularSpUIHbrOnly-Light.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Light.2e1df62a.otf","fonts/CircularSpUIHbrOnly-Light.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Light.2128eeac.woff","fonts/CircularSpUIHbrOnly-Light.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Light.4884da16.woff2","fonts/CircularSpUIv3T-Black.ttf":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Black.ce8ef887.ttf","fonts/CircularSpUIv3T-Black.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Black.effa986f.woff","fonts/CircularSpUIv3T-Black.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Black.c21e63c5.woff2","fonts/CircularSpUIv3T-Bold.ttf":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Bold.7eb7d0f7.ttf","fonts/CircularSpUIv3T-Bold.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Bold.10e93738.woff","fonts/CircularSpUIv3T-Bold.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Bold.8d0a45cc.woff2","fonts/CircularSpUIv3T-Book.ttf":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Book.a357677a.ttf","fonts/CircularSpUIv3T-Book.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Book.ea8d19db.woff","fonts/CircularSpUIv3T-Book.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Book.3466e0ec.woff2","fonts/CircularSpUIv3T-Light.ttf":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Light.89e4be2e.ttf","fonts/CircularSpUIv3T-Light.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Light.2a78c017.woff","fonts/CircularSpUIv3T-Light.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Light.afd9ab26.woff2","fonts/spoticon_regular_2.ttf":"https://open.scdn.co/cdn/fonts/spoticon_regular_2.127670b5.ttf","fonts/spoticon_regular_2.woff":"https://open.scdn.co/cdn/fonts/spoticon_regular_2.ff4c6091.woff","fonts/spoticon_regular_2.woff2":"https://open.scdn.co/cdn/fonts/spoticon_regular_2.d319d911.woff2","generated/manifest-mobile-web-player.json":"https://open.scdn.co/cdn/generated/manifest-mobile-web-player.2aef628f.json","generated/manifest-web-player.json":"https://open.scdn.co/cdn/generated/manifest-web-player.038c3337.json","generated/opensearch.xml":"https://open.scdn.co/cdn/generated/opensearch.abfbfc66.xml","images/checkmark.png":"https://open.scdn.co/cdn/images/checkmark.389faa13.png","images/concert-hub-fb-card.png":"https://open.scdn.co/cdn/images/concert-hub-fb-card.5072379c.png","images/concert-hub-header.png":"https://open.scdn.co/cdn/images/concert-hub-header.56bcad9b.png","images/concert-hub-iphone-de.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-de.b6f99e33.png","images/concert-hub-iphone-el.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-el.5672149c.png","images/concert-hub-iphone-en.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-en.6eda306a.png","images/concert-hub-iphone-es_419.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-es_419.cefd672a.png","images/concert-hub-iphone-es.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-es.cefd672a.png","images/concert-hub-iphone-fi.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-fi.52e8d625.png","images/concert-hub-iphone-fr_CA.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-fr_CA.93b897cb.png","images/concert-hub-iphone-fr.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-fr.336e7db1.png","images/concert-hub-iphone-hu.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-hu.5eba9191.png","images/concert-hub-iphone-id.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-id.87ecf560.png","images/concert-hub-iphone-it.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-it.18450a29.png","images/concert-hub-iphone-ja.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-ja.6eda306a.png","images/concert-hub-iphone-ms.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-ms.83140310.png","images/concert-hub-iphone-nl.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-nl.cb3a5038.png","images/concert-hub-iphone-pl.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-pl.45abd89b.png","images/concert-hub-iphone-pt_BR.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-pt_BR.e932ef02.png","images/concert-hub-iphone-sv.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-sv.5e512289.png","images/concert-hub-iphone-tr.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-tr.a017f03c.png","images/concert-hub-iphone-zh_TW.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-zh_TW.6eda306a.png","images/concert-hub-twitter-card.png":"https://open.scdn.co/cdn/images/concert-hub-twitter-card.71f6a06d.png","images/connect_header@1x.png":"https://open.scdn.co/cdn/images/connect_header@1x.ecc6912d.png","images/connect-to-devices-white.svg":"https://open.scdn.co/cdn/images/connect-to-devices-white.69d4229a.svg","images/desktop-auth-check.svg":"https://open.scdn.co/cdn/images/desktop-auth-check.65be3bbc.svg","images/desktop-auth-error.svg":"https://open.scdn.co/cdn/images/desktop-auth-error.b82f823b.svg","images/devices/android.png":"https://open.scdn.co/cdn/images/devices/android.460a5815.png","images/devices/ios.png":"https://open.scdn.co/cdn/images/devices/ios.535e1468.png","images/devices/mac-web.png":"https://open.scdn.co/cdn/images/devices/mac-web.71c1af1f.png","images/devices/mac.png":"https://open.scdn.co/cdn/images/devices/mac.80dcea83.png","images/devices/windowsphone.png":"https://open.scdn.co/cdn/images/devices/windowsphone.350c5a17.png","images/embed-podcast/upsell-background.png":"https://open.scdn.co/cdn/images/embed-podcast/upsell-background.00c81565.png","images/embed/copy-32_circle_grey_outline_bg.svg":"https://open.scdn.co/cdn/images/embed/copy-32_circle_grey_outline_bg.0c6130eb.svg","images/embed/embed-code-32_circle_grey_outline_bg.svg":"https://open.scdn.co/cdn/images/embed/embed-code-32_circle_grey_outline_bg.b40a255f.svg","images/embed/fb_colour.svg":"https://open.scdn.co/cdn/images/embed/fb_colour.13fa515f.svg","images/embed/messenger_colour.svg":"https://open.scdn.co/cdn/images/embed/messenger_colour.8f4836ec.svg","images/embed/twitter_colour.svg":"https://open.scdn.co/cdn/images/embed/twitter_colour.456d46db.svg","images/embed/whatsapp.svg":"https://open.scdn.co/cdn/images/embed/whatsapp.e33bfab4.svg","images/emi.png":"https://open.scdn.co/cdn/images/emi.c7e51c1a.png","images/employee-podcasts-modal-art.png":"https://open.scdn.co/cdn/images/employee-podcasts-modal-art.956e5f5e.png","images/equaliser-animated-green.gif":"https://open.scdn.co/cdn/images/equaliser-animated-green.73b73928.gif","images/equaliser-green.svg":"https://open.scdn.co/cdn/images/equaliser-green.1184ed87.svg","images/favicon.ico":"https://open.scdn.co/cdn/images/favicon.5cb2bd30.ico","images/favicon.png":"https://open.scdn.co/cdn/images/favicon.0c211e2e.png","images/favicon16.png":"https://open.scdn.co/cdn/images/favicon16.19fc3918.png","images/favicon32.png":"https://open.scdn.co/cdn/images/favicon32.a19b4f5b.png","images/focused_stroy_play.png":"https://open.scdn.co/cdn/images/focused_stroy_play.c908b733.png","images/follow/avatar-placeholder.png":"https://open.scdn.co/cdn/images/follow/avatar-placeholder.2f817d4a.png","images/follow/sprite.gif":"https://open.scdn.co/cdn/images/follow/sprite.e282a709.gif","images/follow/sprite@1.png":"https://open.scdn.co/cdn/images/follow/sprite@1.b994540b.png","images/hifi-button-off.svg":"https://open.scdn.co/cdn/images/hifi-button-off.87461500.svg","images/hifi-button-on.svg":"https://open.scdn.co/cdn/images/hifi-button-on.48a2de90.svg","images/hifi.svg":"https://open.scdn.co/cdn/images/hifi.0526a5b1.svg","images/home-icon.svg":"https://open.scdn.co/cdn/images/home-icon.ba66757a.svg","images/icons/Spotify_1024.png":"https://open.scdn.co/cdn/images/icons/Spotify_1024.d6467a14.png","images/icons/Spotify_128.png":"https://open.scdn.co/cdn/images/icons/Spotify_128.c9ce2f2e.png","images/icons/Spotify_16.png":"https://open.scdn.co/cdn/images/icons/Spotify_16.aa3775a0.png","images/icons/Spotify_256.png":"https://open.scdn.co/cdn/images/icons/Spotify_256.c8416b60.png","images/icons/Spotify_32.png":"https://open.scdn.co/cdn/images/icons/Spotify_32.492cdebf.png","images/icons/Spotify_512.png":"https://open.scdn.co/cdn/images/icons/Spotify_512.49a0bf03.png","images/icons/Spotify_64.png":"https://open.scdn.co/cdn/images/icons/Spotify_64.47bcd979.png","images/icons/Spotify_MWP_192.png":"https://open.scdn.co/cdn/images/icons/Spotify_MWP_192.c70b9055.png","images/icons/Spotify_MWP_512.png":"https://open.scdn.co/cdn/images/icons/Spotify_MWP_512.591cfa88.png","images/improved-modal-bg.jpg":"https://open.scdn.co/cdn/images/improved-modal-bg.23e5dcb1.jpg","images/login-background.jpg":"https://open.scdn.co/cdn/images/login-background.078204fe.jpg","images/login-signup-burst.svg":"https://open.scdn.co/cdn/images/login-signup-burst.5f6a6521.svg","images/logo-complete-black.svg":"https://open.scdn.co/cdn/images/logo-complete-black.573d8227.svg","images/logo-white-2x.png":"https://open.scdn.co/cdn/images/logo-white-2x.ef36ed81.png","images/merlin.png":"https://open.scdn.co/cdn/images/merlin.cd7e72d1.png","images/mid-year.png":"https://open.scdn.co/cdn/images/mid-year.9e2ead8f.png","images/moviebuff.png":"https://open.scdn.co/cdn/images/moviebuff.65e80213.png","images/og-image.png":"https://open.scdn.co/cdn/images/og-image.64b84348.png","images/orchard.png":"https://open.scdn.co/cdn/images/orchard.677c5ae0.png","images/rovi.png":"https://open.scdn.co/cdn/images/rovi.7b503678.png","images/s2l-desktopui-ltr.png":"https://open.scdn.co/cdn/images/s2l-desktopui-ltr.3024b050.png","images/s2l-desktopui-rtl.png":"https://open.scdn.co/cdn/images/s2l-desktopui-rtl.a9690daf.png","images/s2l-mobileui.png":"https://open.scdn.co/cdn/images/s2l-mobileui.9fc9d151.png","images/sony.png":"https://open.scdn.co/cdn/images/sony.7e5692e6.png","images/spotifylogo.svg":"https://open.scdn.co/cdn/images/spotifylogo.a884cca3.svg","images/station-header-wave.svg":"https://open.scdn.co/cdn/images/station-header-wave.0f3784ea.svg","images/station-wave.svg":"https://open.scdn.co/cdn/images/station-wave.2b7b882c.svg","images/sw_saber_ahsoka1.png":"https://open.scdn.co/cdn/images/sw_saber_ahsoka1.5495e812.png","images/sw_saber_anakin.png":"https://open.scdn.co/cdn/images/sw_saber_anakin.a7ba22d2.png","images/sw_saber_leia.png":"https://open.scdn.co/cdn/images/sw_saber_leia.1146243b.png","images/sw_saber_luke.png":"https://open.scdn.co/cdn/images/sw_saber_luke.e4e10033.png","images/sw_saber_mace.png":"https://open.scdn.co/cdn/images/sw_saber_mace.1ba83c7d.png","images/sw_saber_rey.png":"https://open.scdn.co/cdn/images/sw_saber_rey.994789b5.png","images/sw_saber_vader.png":"https://open.scdn.co/cdn/images/sw_saber_vader.070f862b.png","images/touch-icon-114.png":"https://open.scdn.co/cdn/images/touch-icon-114.0d424df2.png","images/touch-icon-144.png":"https://open.scdn.co/cdn/images/touch-icon-144.36faaf96.png","images/touch-icon-57.png":"https://open.scdn.co/cdn/images/touch-icon-57.5460f415.png","images/touch-icon-72.png":"https://open.scdn.co/cdn/images/touch-icon-72.cffecbdb.png","images/tracklist-placeholder.png":"https://open.scdn.co/cdn/images/tracklist-placeholder.59aa68d8.png","images/tracklist-row-episode-fallback.svg":"https://open.scdn.co/cdn/images/tracklist-row-episode-fallback.e8ae3577.svg","images/tracklist-row-song-fallback.svg":"https://open.scdn.co/cdn/images/tracklist-row-song-fallback.4db3ccfe.svg","images/tracklist-row-video-fallback.svg":"https://open.scdn.co/cdn/images/tracklist-row-video-fallback.954459da.svg","images/universal.png":"https://open.scdn.co/cdn/images/universal.3ceb95fd.png","images/vinyl-bottom-layer.svg":"https://open.scdn.co/cdn/images/vinyl-bottom-layer.82d9f6ef.svg","images/vinyl-top-layer.svg":"https://open.scdn.co/cdn/images/vinyl-top-layer.b56c3ccf.svg","images/warner.png":"https://open.scdn.co/cdn/images/warner.a5039776.png","images/zara-larsson-singles.png":"https://open.scdn.co/cdn/images/zara-larsson-singles.59dbba9e.png","js/fb.js":"https://open.scdn.co/cdn/js/fb.83cf1e53.js","js/gtag.js":"https://open.scdn.co/cdn/js/gtag.343176db.js","js/gtm.js":"https://open.scdn.co/cdn/js/gtm.6d498f08.js","js/retargeting-pixels.js":"https://open.scdn.co/cdn/js/retargeting-pixels.1fa1ceda.js","js/urlRedirect.js":"https://open.scdn.co/cdn/js/urlRedirect.156df566.js","js/urlScheme.js":"https://open.scdn.co/cdn/js/urlScheme.f1e6e8b6.js"}'}.SERVER_UA,"Content-Type":$l(this.responseType)},this._headers)}).then(function(){var e=vl()(Sl().mark((function e(t){return Sl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.ok){e.next=2;break}throw xl.fromResponse(t,i.method||"GET");case 2:if("text"!==i.responseType){e.next=8;break}return e.next=5,t.text();case 5:e.t0=e.sent,e.next=11;break;case 8:return e.next=10,t.json();case 10:e.t0=e.sent;case 11:return e.t1=e.t0,e.t2=t.status,e.abrupt("return",{body:e.t1,status:e.t2});case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){throw e})));case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}();function $l(e){return"text"===e?"text/plain":"application/json"}var Ql=null,Xl=function(){function e(){h()(this,e)}return f()(e,null,[{key:"setSession",value:function(e){if(e){var t=e.accessToken,n=this.getInstance();n.accessToken=t,t||n.resetPendingRequests()}}},{key:"setLocale",value:function(e){this.getInstance().locale=e}},{key:"setGlobalRequestHeaders",value:function(e){this.getInstance().globalRequestHeaders=e}},{key:"setMarket",value:function(e){this.getInstance().market=e}},{key:"resetInstance",value:function(){Ql=null}},{key:"getInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Ql||(Ql=this.createNew(e)),Ql}},{key:"createNew",value:function(e){var t=e.Constructor,n=void 0===t?Ll:t,r=e.fromServer;return new n(void 0!==r&&r?zl:Pl)}}]),e}(),Jl=function(e){var t=e.getState();Li(t).onTrackChange((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.uri,r=n;r!==e.getState().playback.trackUri&&e.dispatch(Zi(r))})),Li(t).onProgress((function(t){var n,r=t.position;e.dispatch((n=r,function(e){n>29500&&e(Yi()),e({type:qi.PROGRESS_UPDATE,progress:n})}))})),Li(t).onReset((function(){e.dispatch({type:qi.RESET})})),Li(t).onPause((function(){e.dispatch(Qi())})),Li(t).onPlay((function(){e.dispatch($i())})),Li(t).onUnavailableTrack((function(){e.dispatch(es()),e.dispatch({type:qi.UNAVAILABLE_TRACK})}))},Zl=function(e){var t=e.getState();Xl.setSession(t.session),Li(t).onInitializationFailure((function(t){t.error.code!==oi.EME_NO_SUPPORTED_KEYSYSTEM&&t.error.code!==oi.LIST_PLAYER_NO_TRACK_PLAYER&&t.error.code!==oi.EME_API_NOT_SUPPORTED||(e.dispatch({type:Gc.SET_PLAYBACK_TO_PREVIEW}),Jl(e))})),Jl(e);window.addEventListener("resize",Us((function(){var t,n;e.dispatch((t=window.innerWidth,n=window.innerHeight,{type:Fc.RESIZE_VIEWPORT,width:t,height:n}))}),100))};var eu=n(2060),tu=n(647),nu=n(9433);function ru(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function iu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ru(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ru(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var su=[/open\.scdn\.co/,/xpui\.app\.spotify\.com/],ou=JSON.parse('{"Ls":"https://api.spotify.com","XA":"https://spclient.wg.spotify.com","xM":"https://accounts.spotify.com","l3":"https://api-partner.spotify.com"}'),au=ou.Ls,cu=ou.XA,lu=ou.l3;ou.xM,"".concat(au,"/v1"),"".concat(cu,"/melody/v1"),"".concat(cu,"/radio-apollo/v3"),"".concat(cu,"/playlistextender"),"".concat(cu,"/recently-played/v3"),"".concat(cu,"/collection-view/v1"),"".concat(cu,"/sponsoredplaylist/v1"),"".concat(cu,"/social-connect/v2"),"".concat(cu,"/playlist/v2"),"".concat(cu,"/inspiredby-mix/v2"),"".concat(cu,"/ads"),"".concat(lu,"/pathfinder/v1"),"".concat(cu,"/autoplay-enabled"),"".concat(cu,"/age-verification/v1"),"".concat(cu,"/concerts"),"".concat(cu,"/presence-view"),"".concat(cu,"/presence2"),"".concat(cu,"/find-friends"),"".concat(cu,"/track-credits-view"),"".concat(cu,"/color-lyrics/v1"),"".concat(cu,"/metadata/4"),"".concat(cu,"/user-profile-view/v3"),"".concat(cu,"/consumer-wrapped/v1"),"".concat(cu,"/consumer-only-you/v1"),"".concat(cu,"/stories-view/v1"),"".concat(cu,"/soundfinder/v1"),"".concat(cu,"/"),"".concat(cu,"/socialgraph/v2"),"".concat(cu,"/vanilla/v1/views/hub2"),"".concat(cu,"/ondemand-selector/v2"),"".concat(cu,"/allboarding");function uu(e,t,n){return e.build().withHost("").withPath("/get_access_token").withQueryParameters({reason:t,productType:n}).withoutMarket().withoutAuthorization().withEndpointIdentifier("/get_access_token").send()}var du,pu=n(3617),hu=n(7519);function _u(e){var t="".concat("https://apresolve.spotify.com/","?type=").concat(du.DEALER,"&type=").concat(du.WEBGATE);return vl()(Sl().mark((function n(){var r,i,s,o,a,c,l,u;return Sl().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=new AbortController,i=setTimeout((function(){return r.abort()}),e),n.prev=2,n.next=5,fetch(t,{signal:r.signal});case 5:return o=n.sent,clearTimeout(i),n.next=9,o.json();case 9:s=n.sent,n.next=17;break;case 12:if(n.prev=12,n.t0=n.catch(2),!r.signal.aborted){n.next=16;break}throw new Error("x-resolve request timed out after ".concat(e," ms"));case 16:throw n.t0;case 17:if(Array.isArray(s[du.DEALER])&&Array.isArray(s[du.WEBGATE])&&0!==s[du.DEALER].length&&0!==s[du.WEBGATE].length){n.next=19;break}throw new Error("x-resolve responded with incomplete results");case 19:return a=s[du.DEALER][0],c=s[du.WEBGATE][0],l="wss://".concat(a.replace(/:443$/,"")),u="https://".concat(c.replace(/:443$/,"")),n.abrupt("return",{dealer:l,webgate:u,webapi:"https://api.spotify.com/"});case 24:case"end":return n.stop()}}),n,null,[[2,12]])})))}!function(e){e.DEALER="dealer",e.WEBGATE="spclient"}(du||(du={}));function fu(e){return vl()(Sl().mark((function t(){var n,r,i,s;return Sl().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e();case 2:if(null!==(n=t.sent)){t.next=5;break}return t.abrupt("return",["token_unavailable",0]);case 5:return r=n.accessToken,i=n.accessTokenExpirationTimestampMs,s=Math.floor(((i||0)-Date.now())/1e3),t.abrupt("return",[r,s]);case 8:case"end":return t.stop()}}),t)})))}function gu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gu(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var yu={disconnectBeforeUnload:!0,reconnectionRetries:3,requestMode:"fetch"};function vu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Eu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vu(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Su=function(){function e(){h()(this,e),i()(this,"name","allow-offline-requests"),this.onBeforeProcessRequest=this.onBeforeProcessRequest.bind(this)}return f()(e,[{key:"onBeforeProcessRequest",value:function(e){var t,n,r=e.data;null!==(t=r.options)&&void 0!==t&&null!==(n=t.metadata)&&void 0!==n&&n.noRequestTransform||navigator.onLine||(r.options=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return void 0===e?t:Eu(Eu({},e),t)}(r.options,{allowOffline:!0,authorize:!1}))}},{key:"attach",value:function(e,t){t.on(J.PluginEvent.TRANSPORT_BEFORE_PROCESS_REQUEST,this.onBeforeProcessRequest)}},{key:"detach",value:function(e,t){t.removeListener(J.PluginEvent.TRANSPORT_BEFORE_PROCESS_REQUEST,this.onBeforeProcessRequest)}}]),e}();function bu(){return new Su}var Tu,Cu,Iu=n(1516),Ru=n.n(Iu),Pu=n(1796),Au=function(){function e(t){var n=this;h()(this,e),i()(this,"transport",void 0),i()(this,"enabled",void 0),i()(this,"name","content-access"),i()(this,"cat",null),i()(this,"catPromise",null),i()(this,"api",void 0),this.transport=t,this.enabled="1"===Ru().getCookie("sp_has_cart"),this.api={enable:function(){return n.enable()},isEnabled:function(){return n.isEnabled()}},this.enable=this.enable.bind(this),this._handleOnAuthenticated=this._handleOnAuthenticated.bind(this),this._ensureCat=this._ensureCat.bind(this),this._processRequest=this._processRequest.bind(this),this._getCat=this._getCat.bind(this)}return f()(e,[{key:"enable",value:function(){this.enabled||(this.enabled=!0,this._ensureCat())}},{key:"isEnabled",value:function(){return this.enabled}},{key:"_handleOnAuthenticated",value:function(){this.enabled&&this._ensureCat()}},{key:"_ensureCat",value:function(){this.cat||this._getCat()}},{key:"_processRequest",value:function(t){var n=t.data,r=n.uri;this.enabled&&((!this.cat||this.cat&&this.cat.expiresAtMs-6e4<Date.now())&&this._getCat(),this.cat&&e._include(r)&&(n.options||(n.options={}),n.options.headers||(n.options.headers={}),n.options.headers["content-access-token"]=this.cat.contentAccessToken))}},{key:"_getCat",value:function(){var e=this;!this.catPromise&&this.transport.isAuthenticated()&&(this.catPromise=Xl.getInstance().build().withHost("https://shelter.spotify.com").withPath("/v1/token").withoutMarket().withoutAuthorization().withEndpointIdentifier("shelter.spotify.com/v1/token").withCredentials().send().then((function(t){200===t.status&&(e.cat=t.body,e.catPromise=null)})).catch((function(){})))}},{key:"attach",value:function(e,t){t.on(J.PluginEvent.TRANSPORT_BEFORE_PROCESS_REQUEST,this._processRequest),e.on(Pu.j.AUTHENTICATED,this._handleOnAuthenticated)}},{key:"detach",value:function(e,t){t.removeListener(J.PluginEvent.TRANSPORT_BEFORE_PROCESS_REQUEST,this._processRequest),e.removeListener(Pu.j.AUTHENTICATED,this._handleOnAuthenticated)}}],[{key:"_include",value:function(e){return e.indexOf("@webgate")>-1&&!e.startsWith("@webgate/gabo")||e.indexOf("@webapi")>-1||e.startsWith("https://api.spotify.com/")||e.startsWith("https://api-partner.spotify.com/")||e.indexOf("spclient.wg.spotify.com")>-1}}]),e}();function Ou(e){return new Au(e)}function ku(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Lu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ku(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ku(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;(0,eu.S1)(iu(iu({dsn:e,whitelistUrls:su,sampleRate:.1},t),{},{integrations:[new nu.x],ignoreErrors:[/\/[\dA-F]{8}-[\dA-F]{4}-[\dA-F]{4}-[\dA-F]{4}-[\dA-F]{12}\/main\.js/,/^NotFoundError: Failed to execute '(removeChild|insertBefore)' on 'Node': The node.*child.*this node.$/,/ResizeObserver loop limit exceeded/,"PresentationRequest",/DA97E0680A7030159BC0C0EE3A1D098E947A08E3/]})),(0,tu.e)((function(e){var t=Ci("config",{}).correlationId;t&&e.setUser({id:t}),Object.keys(n).forEach((function(t){e.setExtra(t,n[t])})),""!==document.referrer&&e.setExtra("referrer",document.referrer),r&&e.setTag("container",r)}))})("https://db1eaaeafb9044828c39cd41f9805164@sentry.io/265628",{release:"embed_2021-07-07_1625633456714_68a6f6b"});var wu,Du,Nu,Uu,Mu,Bu=function(e,t){var n=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return e(mu(mu({providers:{endpoints:t,token:fu(n)}},yu),r))}(J.createBaseTransport,function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).timeout,t=_u(void 0===e?3e3:e),n=(0,hu.Q)({});return function(){var e=vl()(Sl().mark((function e(r){return Sl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t(r);case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.next=11,n(r);case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}()}(),e,t.transportOptions);return t.useDealer&&n.addPlugin(pu.dv,{WebSocket}),n.addPlugin(Ou),n.addPlugin(bu),n.on(J.TransportEvent.CONNECTED,(function(){n.isAuthenticated()||n.authenticate()})),n.on(J.TransportEvent.DISCONNECTED,(function(){n.connect()})),n.connect(),n}((wu="embed",Mu=function(){try{var e=document.getElementById("config"),t=e?JSON.parse(e.innerHTML):{};return n=t,["accessToken","accessTokenExpirationTimestampMs","isAnonymous"].every((function(e){return e in n}))?t:null}catch(r){return null}var n}(),Du=vl()(Sl().mark((function e(){var t;return Sl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Mu||(n=Mu,Date.now()>=n.accessTokenExpirationTimestampMs)){e.next=2;break}return e.abrupt("return",Mu);case 2:return e.next=4,uu(Xl.getInstance(),"transport",wu);case 4:return t=e.sent,e.abrupt("return",t.body);case 6:case"end":return e.stop()}var n}),e)}))),Nu=null,Uu=null,vl()(Sl().mark((function e(){var t,n,r=arguments;return Sl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.length>0&&void 0!==r[0]?r[0]:{},void 0===(n=t.preferCached)||!n||!Nu){e.next=3;break}return e.abrupt("return",Nu);case 3:if(!Uu){e.next=5;break}return e.abrupt("return",Uu);case 5:return Uu=Du(),e.prev=6,e.next=9,Uu;case 9:Nu=e.sent;case 10:return e.prev=10,Uu=null,e.finish(10);case 13:return e.abrupt("return",Nu);case 14:case"end":return e.stop()}}),e,null,[[6,,10,13]])})))),{useDealer:!Ii("isAnonymous"),transportOptions:{disconnectBeforeUnload:!0}});!function(e){ci=e}(Bu),function(e){var t=Ii("clientId"),n=Ii("isAnonymous"),r=function(e,t){return(0,ll.createEventSender)({transport:e,suppressPersist:!1,context:[(0,ul.jx)(t),(0,ul.UR)({version:"embed_2021-07-07_1625633456714_68a6f6b"}),(0,ul.Mb)(),(0,ul.sr)(Ci("config",{}).correlationId)]})}(e,t);cl(n),function(e){tl=e}(r)}(Bu);var xu=document.getElementById("resource"),Fu=xu&&xu.innerText;if(!Fu)throw new Error("Element #resource was not found or has invalid content.");var ju,Yu=JSON.parse(decodeURIComponent(Fu)),Ku=i()({},Yu.uri,Yu),Hu=(ju={entities:Ku,resource:Yu.uri},Y(ju).reduce((function(e,t){return x(x({},e),{},i()({},t.uri,t))}),{})),Vu=JSON.parse((null===(Tu=document.getElementById("translations"))||void 0===Tu?void 0:Tu.innerHTML)||"{}"),Gu=null===(Cu=document.getElementById("translations"))||void 0===Cu?void 0:Cu.getAttribute("data-locale");ls.setDictionary(Vu),ls.setLocale(Gu||"en");var Wu=function(e){var t=(0,Pc.MT)((0,Pc.UY)({entities:kc,playback:Nc,progress:Uc,resource:Mc,session:xc,viewport:Vc,platform:Qc,share:Xo,modal:xi,features:function(){return Ii("features")}}),e,(0,Pc.qC)((0,Pc.md)(Ac.Z,_l),(function(e){return e})));return Zl(t),t}({entities:Lu(Lu({},Ku),Hu),resource:Yu.uri}),qu=document.createElement("div");qu.id="main",document.body.appendChild(qu),document.body.style.margin="0",document.body.style.overflow="hidden",c().render(o().createElement(l.zt,{store:Wu},o().createElement(d.zt,{value:new u.K},o().createElement(Rc,null))),qu)},1516:function(e,t,n){n(2077),n(911),n(2759),n(895),n(3938),n(5613),n(2410),n(2482),n(2081),e.exports={getCookie:function(e){return e&&this.hasCookie(e)?decodeURIComponent(document.cookie.replace(new RegExp("(?:^|.*;\\s*)".concat(decodeURIComponent(e).replace(/[-.+*]/g,"\\$&"),"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*")),"$1")):null},hasCookie:function(e){return new RegExp("(?:^|;\\s*)".concat(decodeURIComponent(e).replace(/[-.+*]/g,"\\$&"),"\\s*\\=")).test(document.cookie)},setCookie:function(e,t,n,r){var i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"none";document.cookie="".concat(e,"=").concat(encodeURIComponent(t)).concat(s?";expires=".concat(s):";expires=Fri, 01 Jan 2038 17:14:16 GMT").concat(n?";path=".concat(n):"").concat(r?";domain=".concat(r):"").concat(i?";secure":"",";samesite=").concat(o)},deleteCookie:function(e,t,n){document.cookie="".concat(e,"=;expires=Fri, 01 Jan 1970 17:14:16 GMT").concat(t?";path=".concat(t):"").concat(n?";domain=".concat(n):"")},getTopDomain:function(){var e=".".concat(document.domain.split(".").slice(-2).join("."));return e=".localhost"===e?"localhost":e},getExpireTime:function(e){var t=new Date,n=t.getTime();return n+=parseInt(e,10),t.setTime(n),t.toUTCString()}}}},n={};function r(e){var i=n[e];if(void 0!==i)return i.exports;var s=n[e]={id:e,loaded:!1,exports:{}};return t[e].call(s.exports,s,s.exports,r),s.loaded=!0,s.exports}r.m=t,e=[],r.O=function(t,n,i,s){if(!n){var o=1/0;for(l=0;l<e.length;l++){n=e[l][0],i=e[l][1],s=e[l][2];for(var a=!0,c=0;c<n.length;c++)(!1&s||o>=s)&&Object.keys(r.O).every((function(e){return r.O[e](n[c])}))?n.splice(c--,1):(a=!1,s<o&&(o=s));a&&(e.splice(l--,1),t=i())}return t}s=s||0;for(var l=e.length;l>0&&e[l-1][2]>s;l--)e[l]=e[l-1];e[l]=[n,i,s]},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.hmd=function(e){return(e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},function(){var e={991:0};r.O.j=function(t){return 0===e[t]};var t=function(t,n){var i,s,o=n[0],a=n[1],c=n[2],l=0;for(i in a)r.o(a,i)&&(r.m[i]=a[i]);if(c)var u=c(r);for(t&&t(n);l<o.length;l++)s=o[l],r.o(e,s)&&e[s]&&e[s][0](),e[o[l]]=0;return r.O(u)},n=("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var i=r.O(void 0,[925],(function(){return r(8419)}));i=r.O(i)}();
//# sourceMappingURL=embed.600f8335.js.map